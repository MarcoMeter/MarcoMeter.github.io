<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;500&display=swap" rel="stylesheet"/>
    <script src="template/cdn.plot.ly_plotly-2.6.3.min.js"></script>
    <style>
     /* Style the body */
      html, body {
        height: 100%;
        margin: 0;
        background-color: #000;
        color: white;
        font-family: "Montserrat", sans-serif;
      }

      /* Set the width and hight of the video*/
      video {
        width: 600px;
        height: 400px;
      }

      /* Style the timeline text*/
      #selector_header {
        font-weight: 200;
      }

      /* Buttons should be displayed in a row */
      buttonrow {
        display: inline;
      }

      /* Style the figures */
      #figures {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        flex-flow: row wrap;
      }

      /* Style the tab */
      .tab {
        overflow: hidden;
        background-color: #54595f;
      }

      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
        color: white;
      }

      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #909090;
      }

      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #838383;
      }

      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border-top: none;
        background-color: #000;
      }

      .mediatabcontent {
        display: none;
        padding: 0 px 0 px;
        border-top: none;
        background-color: #000;
        width: 100%;
        height: 100%;
      }

      /* Style the close button */
      .topright {
        float: right;
        cursor: pointer;
        font-size: 28px;
      }

      .topright:hover {
        color: red;
      }

      /* Style of the dropdown button */
      .dropbtn {
        background-color: #17202A;
        color: white;
        padding: 16px;
        font-size: 16px;
        border: none;
      }
      
      .dropdown {
        position: relative;
        display: inline-block;
      }
      
      /* Style of the dropdown content */
      .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        background-color: #A6ACAF;
        z-index: 1;
      }
      
      .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
      }

      .gotostepcontainer {
          margin-bottom: 10px;
      }
      
      #score-container label, #score-container input {
        display: inline-block;
      }

      /* Style of the dropdown at hover */
      .dropdown-content a:hover {background-color: #ddd;}
      
      .dropdown:hover .dropdown-content {display: block;}
      
      .dropdown:hover .dropbtn {background-color: #161515;}
    </style>
  </head>
  <body>
    <!--- Define tabs -->
    <div class="tab">
      <button class="tablinks" onclick="openTab(event, 'Environment')">Environment</button>
      <button class="tablinks" onclick="openTab(event, 'Sampler')">Sampler</button>
      <button class="tablinks" onclick="openTab(event, 'Hyperparameters')">Hyperparameters</button>
      <button class="tablinks" onclick="openTab(event, 'Model')">Model</button>
      <button class="tablinks" onclick="openTab(event, 'Media')" id="defaultOpen">Media</button>
    </div>

    <!--- Define tab content -->
    <div id="Environment" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>type</b>: MemoryGym<br><b>name</b>: SearingSpotlights-v0<br><b>frame_skip</b>: 1<br><b>last_action_to_obs</b>: False<br><b>last_reward_to_obs</b>: False<br><b>obs_stacks</b>: 1<br><b>grayscale</b>: False<br><b>resize_vis_obs</b>: [84, 84]<br><b>positional_encoding</b>: False<br><b>reset_params</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>start-seed</b>: 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num-seeds</b>: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_steps</b>: 256<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial_spawns</b>: 4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_spawns</b>: 30<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial_spawn_interval</b>: 30<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spawn_interval_threshold</b>: 10<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spawn_interval_decay</b>: 0.95<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_min_radius</b>: 7.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_max_radius</b>: 13.75<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_min_speed</b>: 0.0025<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_max_speed</b>: 0.0075<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_damage</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>visual_feedback</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>black_background</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hide_chessboard</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>light_dim_off_duration</b>: 6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>light_threshold</b>: 255<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_coins</b>: [1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>coin_scale</b>: 0.375<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>coins_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>use_exit</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>exit_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>exit_scale</b>: 0.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_speed</b>: 3.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_health</b>: 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_scale</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>sample_agent_position</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>show_last_action</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>show_last_positive_reward</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_inside_spotlight</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_outside_spotlight</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_death</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_exit</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_max_steps</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_coin</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>seed</b>: 0<br><b>reward_normalization</b>: 0<br>
    </div>

    <div id="Model" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>load_model</b>: False<br><b>model_path</b>: <br><b>checkpoint_interval</b>: 500<br><b>activation</b>: relu<br><b>vis_encoder</b>: cnn<br><b>vec_encoder</b>: linear<br><b>num_vec_encoder_units</b>: 128<br><b>hidden_layer</b>: default<br><b>num_hidden_layers</b>: 1<br><b>num_hidden_units</b>: 384<br><b>transformer</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_blocks</b>: 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>embed_dim</b>: 384<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_heads</b>: 4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>memory_length</b>: 256<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>positional_encoding</b>: relative<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>layer_norm</b>: pre<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>init_weights</b>: xavier<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl_bias</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl_swap</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>share_heads</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_episode_steps</b>: 256<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>add_positional_encoding_to_query</b>: False<br><b>obs_decoder</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>attach_to</b>: memory<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>detach_gradient</b>: False<br>
    </div>

    <div id="Sampler" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>n_workers</b>: 32<br><b>worker_steps</b>: 512<br>
    </div>

    <div id="Hyperparameters" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>algorithm</b>: PPO<br><b>resume_at</b>: 0<br><b>gamma</b>: 0.995<br><b>lamda</b>: 0.95<br><b>updates</b>: 30000<br><b>epochs</b>: 3<br><b>refresh_buffer_epoch</b>: -1<br><b>n_mini_batches</b>: 8<br><b>advantage_normalization</b>: no<br><b>value_coefficient</b>: 0.5<br><b>max_grad_norm</b>: 0.25<br><b>share_parameters</b>: True<br><b>learning_rate_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.000275<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-05<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 20000<br><b>beta_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.0001<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-06<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 20000<br><b>clip_range_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>obs_reconstruction_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 1000<br><b>ground_truth_estimator_schedule</b>: {'initial': 0.0}<br>
    </div>

    <div id="Media" class="mediatabcontent">
      <br>
      <center>
        <div id="figures" style="display: flex; flex-direction: column;">
          <div style="display: flex; flex-direction: row;">
            <div style="display: flex; flex-direction: column;">
              <div style="display: flex; flex-direction: row;">
                <label for="video_speed">Frame Rate: </label>
                <input type="text" id="video_speed" size="3" value="6" onkeydown="set_video_speed(event)">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_ground_truth">Show Ground Truth Estimation</label>
                <input type="checkbox" id="show_ground_truth" onclick="show_ground_truth()">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_decoder_video">Show Decoder Video</label>
                <input type="checkbox" id="show_decoder_video" onclick="show_decoder_video()">
              </div>

            <div style="display: flex; flex-direction: row;">
              <label for="show_agent_video">Show Agent Video</label>
              <input type="checkbox" id="show_agent_video" onclick="show_agent_video()">
            </div>
          </div>
          
            <div>
              <video id="video_player">
                <source src="" type="video/webm" />
              </video>
            </div>
            <div id="action_distr"></div>
          </div>
        </div>

        <br>
        <!-- Set buttons to control the figures -->
        <div class="gotostepcontainer">
          <label for="gotostep_text">Step:</label>
          <input type="text" id="gotostep_text" size="3" value="0" onkeydown="go_to_step(event)">
          <button id="return_button" type="return_button" onclick="return_to_step()">Return to step 0</button>
        </div>
        <buttonrow>
          <button id="play_pause_button" onclick="play_pause()" style="width:53px">Play</button>
          <button id="reset_button" onclick="reset()">Reset</button>
          <button id="back_button" onclick="back()">Back</button>
          <button id="next_button" onclick="next()">Next</button>
          <button id="stats_button" onclick="statistic()">Transformer</button>
        </buttonrow>
        <br>
        <!-- Set slider to control the figures -->
        <input id="time_selector" type="range" min="0" max="100" step="1" value="0" style="width: 300px;"/>

        <!-- Set transformer plot -->
        <div id="score-container">
          <label for="top_n_scores">Top Scores:</label>
          <input type="text" id="top_n_scores" size="3" value="-1" onkeydown="top_scores()">
        </div>
        <div id="transformer"></div>

        <!-- Set value plot and entropy plot -->
        <div id="figures">
          <div id="value_func"></div>
          <div id="entropy_func"></div>
          <!-- Dropdown button with some options-->
          <div class="dropdown" id="options">
            <button class="dropbtn">Options</button>
            <div class="dropdown-content" id="dropdown_content">
              <a href ="#" onclick="marker('value')">value_marker_toggle</a>
              <a href ="#" onclick="marker('entropy')">entropy_marker_toggle</a>
              <a href="#" id="all" onclick="set_action_space('all')">All</a>
            </div>
          </div>
        </div>
      </center>
    </div>

    <script>
        // Set active tab
        document.getElementById("defaultOpen").click();

        // Set video player
        const video_player = document.getElementById("video_player");
        const video_speed = document.getElementById("video_speed");
        const video_path = ['videos/video_seed_0_70.webm', '', '', '', '', ''];
        var render_id = 0; var render_gt_id = 1; var render_decoder_id = 2; var render_decoder_gt_id = 3; var  render_agent_id = 4; var render_agent_gt_id = 5;
        var video_id = 0;
        // Hide video player if there is no ground truth video
        if (video_path[render_gt_id].length == 0 && video_path[render_decoder_gt_id].length == 0 && video_path[render_agent_gt_id].length == 0){
          document.querySelector('label[for="show_ground_truth"]').style.display = 'none';
          document.getElementById("show_ground_truth").style.display = 'none';
        } 
        if (video_path[render_decoder_id].length == 0){
          document.querySelector('label[for="show_decoder_video"]').style.display = 'none';
          document.getElementById("show_decoder_video").style.display = 'none';
        }
        if (video_path[render_agent_id].length == 0){
          document.querySelector('label[for="show_agent_video"]').style.display = 'none';
          document.getElementById("show_agent_video").style.display = 'none';
        }

        video_player.querySelector("source").src = video_path[0];
        video_player.load();
        var video_length = 0;

        // Play and pause button
        const play_pause_button = document.getElementById("play_pause_button");

        // Set step input
        const gotostep_text = document.getElementById('gotostep_text');
        var past_steps = [0];
        var step = 0;

        // Set number of scores input
        const top_n_scores = document.getElementById('top_n_scores');

        // Const stats button
        const stats_button = document.getElementById("stats_button");

        // Set time selector
        const time_selector = document.getElementById('time_selector');
        var tS_step_size = 1.0;

        // Set values for the plots
        var y_values = [[1.1276698112487793], [1.1295545101165771], [1.1562398672103882], [1.1526563167572021], [1.1563637256622314], [1.1599218845367432], [1.1488441228866577], [1.1602733135223389], [1.1562854051589966], [1.1323473453521729], [1.087774395942688], [1.0622262954711914], [1.0804252624511719], [0.9396201372146606], [0.9513870477676392], [0.9490365982055664], [0.9533443450927734], [0.954121470451355], [0.9598901271820068], [0.9612071514129639], [0.9648889303207397], [0.9676328897476196], [0.9778530597686768], [0.9817948341369629], [0.9856741428375244], [0.9925466775894165], [0.9983483552932739], [0.9944686889648438], [0.9969600439071655]];
        var y_entropy = [[0.17164941132068634, 0.005408591590821743], [0.00035704064066521823, 0.3369999825954437], [6.61407902953215e-05, 0.18590481579303741], [6.461445445893332e-05, 0.19840240478515625], [0.00015274500765372068, 0.3481229245662689], [0.00021065663895569742, 0.2978280782699585], [0.0001699945132713765, 0.1579352766275406], [0.00016750529175624251, 0.16483032703399658], [0.000712044769898057, 0.43562817573547363], [0.005192191805690527, 0.908840537071228], [0.0392213836312294, 0.7194882035255432], [0.2368735820055008, 0.6146656274795532], [0.4914120137691498, 0.053188297897577286], [0.2599620223045349, 0.0009750510798767209], [0.19877979159355164, 0.0008144018356688321], [0.19773605465888977, 0.0010752406669780612], [0.16545136272907257, 0.0011509055038914084], [0.19314450025558472, 0.0008833534084260464], [0.2135213315486908, 0.0008965820306912065], [0.14812049269676208, 0.00090757105499506], [0.15059861540794373, 0.000802772119641304], [0.163924902677536, 0.0006964585627429187], [0.1523776352405548, 0.0005216042045503855], [0.14960381388664246, 0.00046905482304282486], [0.14596480131149292, 0.0004896946484223008], [0.15565742552280426, 0.0005177963175810874], [0.17431975901126862, 0.000772756349761039], [0.2668837904930115, 0.0011247360380366445], [0.3482518792152405, 0.0015909638023003936]];
        var y_attention_weights = [[[], [], []], [[1.0], [1.0], [1.0]], [[0.34848886728286743, 0.6515111327171326], [0.2561103403568268, 0.743889570236206], [0.5889880657196045, 0.4110119044780731]], [[0.18042995035648346, 0.26407620310783386, 0.5554938316345215], [0.1596895158290863, 0.4992006719112396, 0.3411098122596741], [0.4703488349914551, 0.3233743906021118, 0.2062767744064331]], [[0.12271347641944885, 0.1707776039838791, 0.309826135635376, 0.3966827988624573], [0.12211403250694275, 0.41875162720680237, 0.2640692889690399, 0.19506503641605377], [0.4152527451515198, 0.2866080701351166, 0.17689885199069977, 0.12124031782150269]], [[0.09165924042463303, 0.12725265324115753, 0.23171178996562958, 0.29421716928482056, 0.2551591396331787], [0.10494630038738251, 0.3855594992637634, 0.23332998156547546, 0.16805633902549744, 0.10810787975788116], [0.3833635449409485, 0.26661261916160583, 0.15950752794742584, 0.10532929748296738, 0.08518701791763306]], [[0.07859908789396286, 0.10940508544445038, 0.20743504166603088, 0.26462244987487793, 0.21863436698913574, 0.12130400538444519], [0.09450367093086243, 0.3605163097381592, 0.22170491516590118, 0.15929880738258362, 0.10063482820987701, 0.06334151327610016], [0.3560245931148529, 0.2523607015609741, 0.1480475217103958, 0.09672891348600388, 0.07740941643714905, 0.06942885369062424]], [[0.06944016367197037, 0.09762712568044662, 0.19532568752765656, 0.26539507508277893, 0.20448270440101624, 0.10228052735328674, 0.06544867157936096], [0.09034310281276703, 0.34740087389945984, 0.2180432379245758, 0.15546026825904846, 0.09637588262557983, 0.058347418904304504, 0.034029241651296616], [0.3543890714645386, 0.23889601230621338, 0.13641086220741272, 0.08579134941101074, 0.06688618659973145, 0.05880957096815109, 0.058816950768232346]], [[0.061765607446432114, 0.08948421478271484, 0.1835373342037201, 0.25904151797294617, 0.19806189835071564, 0.09264396876096725, 0.054225120693445206, 0.061240386217832565], [0.0910288393497467, 0.3425479233264923, 0.2135336846113205, 0.14914891123771667, 0.09060408920049667, 0.05475477874279022, 0.03267005831003189, 0.025711674243211746], [0.36012840270996094, 0.2285601645708084, 0.12838143110275269, 0.07743141055107117, 0.058439284563064575, 0.05013562738895416, 0.04993341118097305, 0.046990275382995605]], [[0.0576956607401371, 0.08523818105459213, 0.17936544120311737, 0.2539920508861542, 0.19182030856609344, 0.08526087552309036, 0.045019183307886124, 0.04934295639395714, 0.05226532742381096], [0.09086286276578903, 0.3383799195289612, 0.2082102745771408, 0.14429117739200592, 0.08689200133085251, 0.05241985246539116, 0.03135434910655022, 0.024777531623840332, 0.022812096402049065], [0.3515307903289795, 0.2230662703514099, 0.12340250611305237, 0.07288894802331924, 0.05408599227666855, 0.04597765952348709, 0.045686788856983185, 0.043032146990299225, 0.04032885655760765]], [[0.054956622421741486, 0.08234182000160217, 0.1764376014471054, 0.2504667341709137, 0.18751607835292816, 0.0802672952413559, 0.03888082876801491, 0.04142707586288452, 0.04383877292275429, 0.04386715963482857], [0.09069111943244934, 0.33300864696502686, 0.20255030691623688, 0.1395191252231598, 0.08350296318531036, 0.05038583278656006, 0.030178144574165344, 0.02383722923696041, 0.0218807440251112, 0.024445882067084312], [0.3414275050163269, 0.21839287877082825, 0.11921356618404388, 0.06921139359474182, 0.050698332488536835, 0.04284520447254181, 0.042513567954301834, 0.04009859636425972, 0.03767305612564087, 0.037925899028778076]], [[0.05403156206011772, 0.08058498799800873, 0.17504353821277618, 0.24666711688041687, 0.18244150280952454, 0.07375932484865189, 0.03138868510723114, 0.03488536924123764, 0.03893144801259041, 0.040417421609163284, 0.0418490506708622], [0.09112702310085297, 0.3276981711387634, 0.1962038278579712, 0.13423942029476166, 0.08007460087537766, 0.04828812554478645, 0.02868654951453209, 0.02245798520743847, 0.020558195188641548, 0.022758683189749718, 0.027907462790608406], [0.336039274930954, 0.21184265613555908, 0.11429277062416077, 0.06576922535896301, 0.04787851870059967, 0.04031750559806824, 0.039823614060878754, 0.03744746744632721, 0.03521350771188736, 0.03533393517136574, 0.03604152798652649]], [[0.051355406641960144, 0.07806903123855591, 0.17391034960746765, 0.2459249049425125, 0.17856161296367645, 0.07025748491287231, 0.028449051082134247, 0.02977801114320755, 0.03272087499499321, 0.03442158177495003, 0.03642404079437256, 0.04012765735387802], [0.09100412577390671, 0.31857210397720337, 0.19011136889457703, 0.13019362092018127, 0.0771288126707077, 0.046310827136039734, 0.02727583795785904, 0.02096756175160408, 0.018961580470204353, 0.02078760229051113, 0.025394385680556297, 0.033292170614004135], [0.32974058389663696, 0.2119372934103012, 0.11197447031736374, 0.062917061150074, 0.044769272208213806, 0.037330832332372665, 0.03658381849527359, 0.03416036069393158, 0.0321163609623909, 0.032178767025470734, 0.03279542177915573, 0.03349577262997627]], [[0.06007171422243118, 0.08283346891403198, 0.12440808117389679, 0.11907191574573517, 0.109855517745018, 0.06107890233397484, 0.03677934408187866, 0.07691442221403122, 0.0749826580286026, 0.06905883550643921, 0.062648706138134, 0.05771837383508682, 0.06457807123661041], [0.12064488232135773, 0.32650405168533325, 0.1946515440940857, 0.1336304098367691, 0.07694446295499802, 0.04053158313035965, 0.020067034289240837, 0.014849291183054447, 0.013755042105913162, 0.014067853800952435, 0.014419951476156712, 0.014794823713600636, 0.01513907965272665], [0.3338962495326996, 0.22838592529296875, 0.10453132539987564, 0.05505618453025818, 0.038084596395492554, 0.03147000074386597, 0.028987709432840347, 0.02840418741106987, 0.028884850442409515, 0.029402490705251694, 0.030108321458101273, 0.030503854155540466, 0.03228430449962616]], [[0.048367492854595184, 0.06887760013341904, 0.11908815056085587, 0.11902464181184769, 0.11894221603870392, 0.06114800274372101, 0.022578662261366844, 0.022123415023088455, 0.024738501757383347, 0.0253223218023777, 0.026009971275925636, 0.02826281078159809, 0.030927743762731552, 0.28458842635154724], [0.11672942340373993, 0.3149351179599762, 0.20192372798919678, 0.14248265326023102, 0.08185835927724838, 0.04165245592594147, 0.019248679280281067, 0.013159701600670815, 0.01170373521745205, 0.01165789645165205, 0.011751636862754822, 0.011762034147977829, 0.012219362892210484, 0.008915254846215248], [0.3068298101425171, 0.2251851111650467, 0.10353302955627441, 0.05533652752637863, 0.03823661804199219, 0.031623803079128265, 0.02882198989391327, 0.027235662564635277, 0.02759159356355667, 0.028045296669006348, 0.02866508811712265, 0.028792135417461395, 0.029515422880649567, 0.04058797284960747]], [[0.047442227602005005, 0.06953755766153336, 0.1199512779712677, 0.11629833281040192, 0.11051323264837265, 0.055711738765239716, 0.020253390073776245, 0.018692374229431152, 0.02049613744020462, 0.02168213576078415, 0.02331612817943096, 0.02647436410188675, 0.028928836807608604, 0.28363269567489624, 0.03706955164670944], [0.11948435008525848, 0.30611807107925415, 0.19296124577522278, 0.13739551603794098, 0.08074868470430374, 0.0424974150955677, 0.02038518898189068, 0.014122579246759415, 0.012629639357328415, 0.012471925467252731, 0.012474692426621914, 0.012407820671796799, 0.013061515055596828, 0.009395139291882515, 0.013846193440258503], [0.3079260587692261, 0.22742007672786713, 0.10085076093673706, 0.05200853943824768, 0.0353345051407814, 0.028846437111496925, 0.026028411462903023, 0.024595318362116814, 0.024571439251303673, 0.02488194778561592, 0.0253945030272007, 0.02555791661143303, 0.026090070605278015, 0.03469790145754814, 0.03579609468579292]], [[0.04640953615307808, 0.06846442818641663, 0.11891213059425354, 0.11513486504554749, 0.10919579118490219, 0.054272644221782684, 0.0184791162610054, 0.016293497756123543, 0.017813650891184807, 0.018831908702850342, 0.020234569907188416, 0.023021839559078217, 0.024899711832404137, 0.2788323760032654, 0.032193176448345184, 0.03701078146696091], [0.12059718370437622, 0.30422598123550415, 0.18979088962078094, 0.13480132818222046, 0.07894323021173477, 0.04146721586585045, 0.019669916480779648, 0.013537607155740261, 0.012148559093475342, 0.012007933109998703, 0.011994509026408195, 0.011882747523486614, 0.012536033987998962, 0.008892317302525043, 0.01324538141489029, 0.014259164221584797], [0.300094336271286, 0.22534587979316711, 0.09719764441251755, 0.04928162693977356, 0.03336426243185997, 0.02729485183954239, 0.024711357429623604, 0.023366816341876984, 0.023356247693300247, 0.02365606278181076, 0.02413828857243061, 0.02423398569226265, 0.024680858477950096, 0.03294851630926132, 0.034105461090803146, 0.0322238989174366]], [[0.047707073390483856, 0.071243055164814, 0.11972919851541519, 0.11356392502784729, 0.10570889711380005, 0.05315070599317551, 0.018734054639935493, 0.015148784965276718, 0.015543339774012566, 0.01579168066382408, 0.01687772199511528, 0.019736504182219505, 0.020822761580348015, 0.2754904627799988, 0.027636034414172173, 0.03059053048491478, 0.03252531215548515], [0.12317530810832977, 0.3008575141429901, 0.1862575113773346, 0.13293059170246124, 0.07749367505311966, 0.040512099862098694, 0.018875032663345337, 0.012909907847642899, 0.011595549061894417, 0.011393651366233826, 0.011299270205199718, 0.011116623878479004, 0.01176290400326252, 0.008476448245346546, 0.01289721205830574, 0.013581301085650921, 0.014865429140627384], [0.29110631346702576, 0.22483748197555542, 0.09342554956674576, 0.0463896170258522, 0.03147030621767044, 0.026009829714894295, 0.023746507242321968, 0.022222202271223068, 0.022132230922579765, 0.02237710915505886, 0.022793171927332878, 0.022684939205646515, 0.022970251739025116, 0.03188033029437065, 0.03313813731074333, 0.031342342495918274, 0.03147370368242264]], [[0.04743686690926552, 0.07141511142253876, 0.120368093252182, 0.11347708851099014, 0.10565310716629028, 0.05140490457415581, 0.01657032035291195, 0.013790788128972054, 0.014748151414096355, 0.014881874434649944, 0.015443822368979454, 0.017468180507421494, 0.01820949837565422, 0.27153366804122925, 0.023888349533081055, 0.026512591168284416, 0.028084425255656242, 0.029113173484802246], [0.12481202930212021, 0.29797330498695374, 0.18209147453308105, 0.1276404857635498, 0.07320383936166763, 0.038178909569978714, 0.018083859235048294, 0.012641684152185917, 0.011487909592688084, 0.011456673964858055, 0.011580022051930428, 0.01161862351000309, 0.012298827059566975, 0.00869134720414877, 0.013465357944369316, 0.014042616821825504, 0.015254381112754345, 0.015478619374334812], [0.29182374477386475, 0.2212470918893814, 0.08917603641748428, 0.04335766285657883, 0.02950214222073555, 0.024546584114432335, 0.022719930857419968, 0.021332135424017906, 0.021257270127534866, 0.02154148742556572, 0.021997397765517235, 0.02195877954363823, 0.022073516622185707, 0.029364299029111862, 0.030271947383880615, 0.028255553916096687, 0.02839580923318863, 0.0311785489320755]], [[0.04727431386709213, 0.07071848958730698, 0.11807313561439514, 0.1117287129163742, 0.10428820550441742, 0.05163343623280525, 0.01653624139726162, 0.012491326779127121, 0.012747595086693764, 0.012857221998274326, 0.01366399135440588, 0.015986962243914604, 0.01648533344268799, 0.27012139558792114, 0.021970253437757492, 0.0237128846347332, 0.025201214477419853, 0.026842916384339333, 0.02766643650829792], [0.12529835104942322, 0.2919144630432129, 0.1767205446958542, 0.12585926055908203, 0.0738096535205841, 0.039178188890218735, 0.01849987544119358, 0.012739676050841808, 0.011540106497704983, 0.011343489401042461, 0.0112759442999959, 0.011166267096996307, 0.01191207580268383, 0.008582954294979572, 0.012900364585220814, 0.013492027297616005, 0.014545178040862083, 0.014801722951233387, 0.014419890008866787], [0.2777874767780304, 0.2204597443342209, 0.08798863738775253, 0.04220620170235634, 0.028385385870933533, 0.02354769967496395, 0.021688319742679596, 0.02028203383088112, 0.02017541043460369, 0.020397156476974487, 0.020769190043210983, 0.020606011152267456, 0.020614739507436752, 0.02827676758170128, 0.029444191604852676, 0.027828142046928406, 0.02790774218738079, 0.030384302139282227, 0.031250812113285065]], [[0.0476510189473629, 0.07090333104133606, 0.11683481931686401, 0.11054110527038574, 0.10352115333080292, 0.05131329223513603, 0.0159338116645813, 0.011709311045706272, 0.01196212787181139, 0.012003936804831028, 0.012660193257033825, 0.01474310364574194, 0.014983263798058033, 0.26820051670074463, 0.020075110718607903, 0.021327028051018715, 0.022634437307715416, 0.023989373818039894, 0.02475266344845295, 0.024260388687253], [0.12644246220588684, 0.28698039054870605, 0.17257890105247498, 0.123111791908741, 0.07246216386556625, 0.03869691863656044, 0.01828174851834774, 0.012597581371665001, 0.011473475955426693, 0.011308489367365837, 0.011260559782385826, 0.011180018074810505, 0.011962356977164745, 0.008622879162430763, 0.012966807000339031, 0.0135260671377182, 0.01449207030236721, 0.0146559439599514, 0.01428414136171341, 0.013115152716636658], [0.2710884213447571, 0.21780219674110413, 0.0856333002448082, 0.04045195132493973, 0.027093593031167984, 0.02253449708223343, 0.020845582708716393, 0.019454728811979294, 0.01933705434203148, 0.019535500556230545, 0.019878776744008064, 0.019692085683345795, 0.01962314359843731, 0.02688680589199066, 0.02809000574052334, 0.02660846710205078, 0.02666754648089409, 0.028916630893945694, 0.02968425862491131, 0.030175449326634407]], [[0.04864480346441269, 0.0718865841627121, 0.1154850646853447, 0.10905931144952774, 0.10272771865129471, 0.05099107325077057, 0.015534713864326477, 0.01106206327676773, 0.011205361224710941, 0.011156783439218998, 0.011730285361409187, 0.013691888190805912, 0.013768899254500866, 0.26677432656288147, 0.01843278482556343, 0.01936214603483677, 0.020517420023679733, 0.021811766549944878, 0.022528324276208878, 0.02213222347199917, 0.02149648778140545], [0.127748042345047, 0.28391122817993164, 0.1683645397424698, 0.11995310336351395, 0.0704924538731575, 0.03776414692401886, 0.017812103033065796, 0.012300509959459305, 0.011286107823252678, 0.011171350255608559, 0.011156427673995495, 0.011127810925245285, 0.01195166353136301, 0.008680068887770176, 0.01311688032001257, 0.013679521158337593, 0.014587299898266792, 0.014658598229289055, 0.014305748045444489, 0.013115566223859787, 0.012816847302019596], [0.2642577886581421, 0.21740815043449402, 0.08364468067884445, 0.03889762610197067, 0.025934115052223206, 0.021596547216176987, 0.020075220614671707, 0.018656358122825623, 0.018457623198628426, 0.01861526444554329, 0.01891617476940155, 0.018665321171283722, 0.018441032618284225, 0.025507112964987755, 0.026622021570801735, 0.025277651846408844, 0.025339972227811813, 0.027395224198698997, 0.028097767382860184, 0.028589773923158646, 0.029604552313685417]], [[0.04971595108509064, 0.07413594424724579, 0.11555696278810501, 0.10849592089653015, 0.10097925364971161, 0.050938066095113754, 0.015235929749906063, 0.010654611513018608, 0.010770420543849468, 0.01071676705032587, 0.011183934286236763, 0.012847114354372025, 0.012742512859404087, 0.2653069794178009, 0.016861774027347565, 0.017378292977809906, 0.01816512644290924, 0.019313478842377663, 0.019849570468068123, 0.01983398199081421, 0.019800838083028793, 0.019516577944159508], [0.1308893859386444, 0.2812180519104004, 0.16363747417926788, 0.11589972674846649, 0.0679619088768959, 0.036733806133270264, 0.017309455201029778, 0.01197328232228756, 0.01111019216477871, 0.010990768671035767, 0.010975345969200134, 0.010996139608323574, 0.011965314857661724, 0.009045171551406384, 0.013527292758226395, 0.013989499770104885, 0.014674918726086617, 0.014516494236886501, 0.014045297168195248, 0.012896007858216763, 0.012673990800976753, 0.01297056581825018], [0.25967586040496826, 0.21550527215003967, 0.07994523644447327, 0.03621193766593933, 0.023918241262435913, 0.019867349416017532, 0.0186617448925972, 0.017267100512981415, 0.01698981411755085, 0.0171506330370903, 0.017445988953113556, 0.017128996551036835, 0.016720950603485107, 0.024532999843358994, 0.025887664407491684, 0.02478005737066269, 0.024900440126657486, 0.026999209076166153, 0.027621351182460785, 0.0283939428627491, 0.02949797362089157, 0.030897311866283417]], [[0.05123057961463928, 0.07613271474838257, 0.11586505174636841, 0.10776297748088837, 0.09902272373437881, 0.05015203356742859, 0.01503773219883442, 0.010396754369139671, 0.010393579490482807, 0.010226844809949398, 0.010593070648610592, 0.012093041092157364, 0.011816308833658695, 0.2642155885696411, 0.015410654246807098, 0.015555179677903652, 0.0161616038531065, 0.017253832891583443, 0.01783101074397564, 0.017971621826291084, 0.018235258758068085, 0.018296698108315468, 0.0183451808989048], [0.1316637545824051, 0.27575621008872986, 0.16005456447601318, 0.11356975883245468, 0.06654185056686401, 0.036017511039972305, 0.0169658325612545, 0.011760057881474495, 0.010932045988738537, 0.01082546915858984, 0.010837649926543236, 0.010897671803832054, 0.011920428834855556, 0.009091916494071484, 0.013643840327858925, 0.01405284646898508, 0.014648878946900368, 0.01437617838382721, 0.0138878608122468, 0.012770957313477993, 0.01261970866471529, 0.012957582250237465, 0.01420745812356472], [0.2558996379375458, 0.21380075812339783, 0.07819326221942902, 0.03477346897125244, 0.022720061242580414, 0.01879485510289669, 0.017758794128894806, 0.016463804990053177, 0.016155906021595, 0.01629560813307762, 0.016568031162023544, 0.016253679990768433, 0.015824763104319572, 0.023176606744527817, 0.024480752646923065, 0.023655856028199196, 0.023796062916517258, 0.025774270296096802, 0.026280047371983528, 0.02717989683151245, 0.028264489024877548, 0.029629115015268326, 0.028260283172130585]], [[0.052102357149124146, 0.07739704847335815, 0.1155981793999672, 0.10700641572475433, 0.09786604344844818, 0.04932675510644913, 0.01446656882762909, 0.009884458966553211, 0.009883243590593338, 0.009701427072286606, 0.01000667642802, 0.01137262862175703, 0.011048680171370506, 0.2633039057254791, 0.014420568011701107, 0.014422763139009476, 0.014940927736461163, 0.01590951904654503, 0.016429025679826736, 0.016530422493815422, 0.016835108399391174, 0.016993438825011253, 0.01709785684943199, 0.017456013709306717], [0.13111840188503265, 0.27134764194488525, 0.15549784898757935, 0.11013369262218475, 0.06452799588441849, 0.03508596867322922, 0.016564443707466125, 0.011529918760061264, 0.010775463655591011, 0.010700641199946404, 0.010750429704785347, 0.01086791604757309, 0.01193183846771717, 0.009126466698944569, 0.013666070997714996, 0.014063619077205658, 0.01466716080904007, 0.014402033761143684, 0.013991748914122581, 0.012843267992138863, 0.012708825059235096, 0.013070089742541313, 0.014399382285773754, 0.016229158267378807], [0.25053319334983826, 0.21333348751068115, 0.0769319161772728, 0.033473603427410126, 0.021596502512693405, 0.01786804012954235, 0.016939543187618256, 0.01564236544072628, 0.015364659950137138, 0.015486935153603554, 0.01574689708650112, 0.015506944619119167, 0.015028954483568668, 0.02227267436683178, 0.023402199149131775, 0.022651154547929764, 0.02279762364923954, 0.024647172540426254, 0.025100454688072205, 0.025987785309553146, 0.027016855776309967, 0.02831980213522911, 0.027073010802268982, 0.027278248220682144]], [[0.05321766436100006, 0.07848343998193741, 0.11489610373973846, 0.10612151026725769, 0.09670323133468628, 0.0488160103559494, 0.013974664732813835, 0.009386138059198856, 0.009452193975448608, 0.009297016076743603, 0.009542716667056084, 0.010724702849984169, 0.01031957846134901, 0.26224300265312195, 0.013422216288745403, 0.013226757757365704, 0.013600444421172142, 0.01443873904645443, 0.014900406822562218, 0.015071507543325424, 0.015583817847073078, 0.015997854992747307, 0.01625659316778183, 0.01665213145315647, 0.01767151802778244], [0.13101693987846375, 0.2663732171058655, 0.15117383003234863, 0.10678452998399734, 0.06252679228782654, 0.034095704555511475, 0.0161035917699337, 0.011230065487325191, 0.010542003437876701, 0.010493818670511246, 0.01058007963001728, 0.010752563364803791, 0.011841405183076859, 0.00919458270072937, 0.013759653083980083, 0.014091888442635536, 0.014649285934865475, 0.014293557032942772, 0.013903026469051838, 0.01271086372435093, 0.012605112046003342, 0.013005305081605911, 0.01441133301705122, 0.016201887279748917, 0.01765897125005722], [0.24518343806266785, 0.21241873502731323, 0.07558382302522659, 0.032206013798713684, 0.020480448380112648, 0.016927124932408333, 0.01616811752319336, 0.014886947348713875, 0.014640048146247864, 0.01475547719746828, 0.015009193681180477, 0.014814047142863274, 0.014246839098632336, 0.021430809050798416, 0.022479891777038574, 0.02180320769548416, 0.021962061524391174, 0.02373034507036209, 0.02413075789809227, 0.025053083896636963, 0.026053104549646378, 0.02733021043241024, 0.026086080819368362, 0.026250090450048447, 0.026370136067271233]], [[0.054211705923080444, 0.0798090398311615, 0.11552289128303528, 0.10602416098117828, 0.09498224407434464, 0.0478256456553936, 0.013418360613286495, 0.008994569070637226, 0.009141364134848118, 0.008948947302997112, 0.009078244678676128, 0.010074079968035221, 0.0096093425527215, 0.26129454374313354, 0.012516439892351627, 0.012219984084367752, 0.012460622005164623, 0.013135307468473911, 0.013490388169884682, 0.013613754883408546, 0.01422895397990942, 0.01484405156224966, 0.01528048887848854, 0.015798667445778847, 0.016726579517126083, 0.016749681904911995], [0.13153693079948425, 0.26011109352111816, 0.14645488560199738, 0.10348320752382278, 0.060972098261117935, 0.03354361280798912, 0.015964772552251816, 0.011201901361346245, 0.010574466548860073, 0.010531901381909847, 0.010608715936541557, 0.01075521670281887, 0.011822554282844067, 0.009213273413479328, 0.013591684401035309, 0.013884247280657291, 0.014464843086898327, 0.014103543944656849, 0.013722245581448078, 0.012534825131297112, 0.012434875592589378, 0.012836791574954987, 0.014186374843120575, 0.015877369791269302, 0.01720426045358181, 0.018384339287877083], [0.24347199499607086, 0.21069513261318207, 0.07374288886785507, 0.030643774196505547, 0.01919218897819519, 0.015838555991649628, 0.015236886218190193, 0.01401931419968605, 0.013834555633366108, 0.013960991986095905, 0.014224095270037651, 0.014085986651480198, 0.01355443149805069, 0.020609211176633835, 0.021596841514110565, 0.021024536341428757, 0.02117764949798584, 0.022878937423229218, 0.023248495534062386, 0.024172458797693253, 0.025148563086986542, 0.026399463415145874, 0.025183333083987236, 0.02534675784409046, 0.025480158627033234, 0.0252328310161829]], [[0.05520777776837349, 0.0809401422739029, 0.11583495140075684, 0.10569311678409576, 0.09382908046245575, 0.04645571857690811, 0.012766816653311253, 0.008319547399878502, 0.00842253863811493, 0.008235014043748379, 0.008348725736141205, 0.009273350238800049, 0.0088293282315135, 0.2604610323905945, 0.011844002641737461, 0.011398950591683388, 0.01145639456808567, 0.012163824401795864, 0.012285235337913036, 0.012700066901743412, 0.013540761545300484, 0.014360707253217697, 0.014873143285512924, 0.015166065655648708, 0.015853755176067352, 0.015864862129092216, 0.015875091776251793], [0.13155460357666016, 0.25526630878448486, 0.1416073590517044, 0.09985313564538956, 0.058919575065374374, 0.03270631656050682, 0.015649452805519104, 0.011072412133216858, 0.010534721426665783, 0.010486315935850143, 0.01055684220045805, 0.010710915550589561, 0.01180708035826683, 0.009323731064796448, 0.01356167159974575, 0.013780350796878338, 0.014314905740320683, 0.01391396950930357, 0.013538138009607792, 0.012375891208648682, 0.012291462160646915, 0.01268676109611988, 0.014018774963915348, 0.015636304393410683, 0.016870655119419098, 0.017970755696296692, 0.018991513177752495], [0.2392740398645401, 0.2107178270816803, 0.0725201666355133, 0.02957361564040184, 0.01832488551735878, 0.015171567909419537, 0.014668084681034088, 0.013416778296232224, 0.013256092555820942, 0.013364549726247787, 0.013614708557724953, 0.013531597331166267, 0.01298186369240284, 0.019998224452137947, 0.020870881155133247, 0.020345892757177353, 0.020454933866858482, 0.02195114642381668, 0.022275559604167938, 0.023085199296474457, 0.023948263376951218, 0.025083355605602264, 0.024028200656175613, 0.024178512394428253, 0.024307798594236374, 0.02413449063897133, 0.024921748787164688]], [[0.05527385324239731, 0.08127163350582123, 0.11617115139961243, 0.10560718178749084, 0.09283015131950378, 0.04571238532662392, 0.01223553903400898, 0.00784257985651493, 0.007945290766656399, 0.007787408772855997, 0.007901308126747608, 0.008767249993979931, 0.008309888653457165, 0.25979968905448914, 0.011202573776245117, 0.010685089975595474, 0.01072333287447691, 0.011396406218409538, 0.01153545081615448, 0.01196876261383295, 0.012841428630053997, 0.013693754561245441, 0.014214512892067432, 0.014469550922513008, 0.015049127861857414, 0.015003395266830921, 0.015014040283858776, 0.014747191220521927], [0.1305227279663086, 0.2490164339542389, 0.13729754090309143, 0.09718035161495209, 0.05773347243666649, 0.032235413789749146, 0.015462466515600681, 0.010968181304633617, 0.010471992194652557, 0.010449104011058807, 0.010532327927649021, 0.010682561434805393, 0.011752770282328129, 0.009256675839424133, 0.013397032395005226, 0.0135989710688591, 0.014147735200822353, 0.01377694122493267, 0.013441145420074463, 0.012267423793673515, 0.012195102870464325, 0.012604555115103722, 0.013902087695896626, 0.015424927696585655, 0.016538219526410103, 0.017478635534644127, 0.018343564122915268, 0.01932167075574398], [0.2369481772184372, 0.2098187655210495, 0.07157859206199646, 0.028766781091690063, 0.01759294420480728, 0.014495758339762688, 0.014043597504496574, 0.012848293408751488, 0.012700024992227554, 0.012805024161934853, 0.013051029294729233, 0.012996327131986618, 0.012440834194421768, 0.019188066944479942, 0.02000385709106922, 0.01951165311038494, 0.019590452313423157, 0.020969003438949585, 0.021275635808706284, 0.022007346153259277, 0.022806130349636078, 0.023858562111854553, 0.022898800671100616, 0.023037906736135483, 0.02316286973655224, 0.023022010922431946, 0.02378513664007187, 0.02479647472500801]]];
        var y_action = [[[0.041164297610521317, 0.9588340520858765, 1.5523016827501124e-06], [0.00024563903571106493, 0.0003482741885818541, 0.999406099319458]], [[3.1399158615386114e-05, 0.9999686479568481, 4.166322148391188e-11], [0.8954831957817078, 0.00030836460064165294, 0.10420845448970795]], [[5.030527518101735e-06, 0.9999949932098389, 2.9472594070129032e-12], [0.9547967314720154, 0.0002919335092883557, 0.044911403208971024]], [[4.894408448308241e-06, 0.9999951124191284, 5.067970782618447e-12], [0.9505450129508972, 0.00023563351714983582, 0.04921944439411163]], [[1.2424678061506711e-05, 0.9999876022338867, 1.6469943464603176e-11], [0.8900579810142517, 0.00024305959232151508, 0.10969886183738708]], [[1.768166657711845e-05, 0.9999823570251465, 2.6752039819499807e-11], [0.9129976630210876, 0.0003502541803754866, 0.08665209263563156]], [[1.3923266124038491e-05, 0.9999860525131226, 1.4117970681404302e-11], [0.9644569158554077, 0.0009627002873457968, 0.03458043560385704]], [[1.3772558304481208e-05, 0.9999861717224121, 4.328423470340015e-12], [0.9646081924438477, 0.003683252027258277, 0.03170854225754738]], [[6.715875497320667e-05, 0.9999328851699829, 1.862769487270821e-11], [0.8657155632972717, 0.012324932962656021, 0.12195954471826553]], [[0.0006190546555444598, 0.9993809461593628, 4.97687613343345e-10], [0.447527140378952, 0.07596532255411148, 0.4765075743198395]], [[0.0065016415901482105, 0.9934983253479004, 1.940476046513595e-08], [0.07969408482313156, 0.17075642943382263, 0.7495495080947876]], [[0.06363844871520996, 0.9363608956336975, 6.468987407970417e-07], [0.011999393813312054, 0.24168042838573456, 0.7463201880455017]], [[0.1935233324766159, 0.8064668774604797, 9.76650153461378e-06], [0.0005699640023522079, 0.008369231596589088, 0.9910607933998108]], [[0.9320712685585022, 0.002813957864418626, 0.06511474400758743], [9.46158470469527e-05, 0.9999051094055176, 2.2812750444245466e-07]], [[0.9540838003158569, 0.003538976889103651, 0.04237725958228111], [7.752278906991705e-05, 0.9999222755432129, 1.8961701186981372e-07]], [[0.9545659422874451, 0.003727582050487399, 0.04170643910765648], [0.00010544672841206193, 0.9998942613601685, 2.489913697445445e-07]], [[0.964984655380249, 0.0046348245814442635, 0.030380483716726303], [0.00011373082816135138, 0.9998860359191895, 2.702990684610995e-07]], [[0.9560860395431519, 0.0038106131833046675, 0.040103357285261154], [8.493315544910729e-05, 0.9999148845672607, 1.4955277549688617e-07]], [[0.947901725769043, 0.0021231058053672314, 0.049975089728832245], [8.641884051030502e-05, 0.9999134540557861, 1.0724009769091936e-07]], [[0.9705770611763, 0.006383898667991161, 0.02303917519748211], [8.751984569244087e-05, 0.9999123811721802, 1.3168910584226978e-07]], [[0.9696968793869019, 0.005806108005344868, 0.024497080594301224], [7.645110599696636e-05, 0.9999234676361084, 1.1347901107683356e-07]], [[0.9658366441726685, 0.0054511562921106815, 0.028712226077914238], [6.532911356771365e-05, 0.9999345541000366, 1.0054868226916369e-07]], [[0.9681093096733093, 0.0035428854171186686, 0.02834782749414444], [4.7497662308160216e-05, 0.9999524354934692, 6.602139990263822e-08]], [[0.9689781069755554, 0.003694756655022502, 0.0273271631449461], [4.223166251904331e-05, 0.9999576807022095, 7.604058538390746e-08]], [[0.9705614447593689, 0.004854193422943354, 0.024584421887993813], [4.429250839166343e-05, 0.9999555349349976, 8.159984332678505e-08]], [[0.9687129855155945, 0.00687058549374342, 0.024416450411081314], [4.7075671318452805e-05, 0.9999527931213379, 9.533887634916027e-08]], [[0.9648122191429138, 0.011161436326801777, 0.024026280269026756], [7.321879820665345e-05, 0.9999266862869263, 1.349791460825145e-07]], [[0.9400863647460938, 0.023564061149954796, 0.036349453032016754], [0.00011086013546446338, 0.9998888969421387, 2.651602528658259e-07]], [[0.9150446653366089, 0.03494510427117348, 0.05001017451286316], [0.0001628851896384731, 0.9998365640640259, 4.5725798258899886e-07]]]; // action probs
        var action =  [[1, 2], [1, 0], [1, 0], [1, 0], [1, 2], [1, 2], [1, 0], [1, 0], [1, 0], [1, 0], [1, 1], [1, 2], [1, 2], [0, 1], [0, 1], [0, 1], [2, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1]];
        var action_names = [['no-op', 'left', 'right'], ['no-op', 'up', 'down']];
        var x_values = [...Array(y_values.length).keys()];

        var y_entropy_plot = [];
        var y_values_plot = [];

        // Set marker for plots
        var entropy_marker = false;
        var value_marker = false;

        // Set the to be shown statistic
        var statistic_type = 'general'
        // Only used for the transformer plot to show the correct statistic with tab switching
        var statistic_plot_id = 0;
        // Hide statistic type button if there is no attention weights
        if(y_attention_weights.length == 0) stats_button.style.display = 'none';

        // Set the to be shown action_space(s) for the entropy plot
        var entr_selected_action_space = null;

        var is_multi_discrete = action[0].length != 1;
        var is_discrete = action[0].length == 1;

        // Reformat the data for the plots
        // Each function y - value should be stored in a separate array
        for(var j = 0; j < y_values[0].length; j++)
            for(var i = 0; i < y_values.length; i++)
                y_values_plot.push(y_values[i][j]);

        if(is_discrete) { // If action_space is discrete
          for(var j = 0; j < y_entropy[0].length; j++)
              for(var i = 0; i < y_values.length; i++)
                  y_entropy_plot.push(y_entropy[i][j]);
        }
        else { // If action_space is multi discrete
          for(var j = 0; j < y_entropy[0].length; j++) {
            var y_entropy_vals = [];
            for(var i = 0; i < y_entropy.length; i++) {
                y_entropy_vals.push(y_entropy[i][j]);
            }
            y_entropy_plot.push(y_entropy_vals);
          }
        }

        // Set action_names for distr. plot if it does not exist
        if(action_names == null){
          action_names = [];
          for(var i = 0; i < y_action[0].length; i++){
            for(var j = 0; j < y_action[0][0].length; j++)
              if(is_discrete){ // if action space is discrete
                action_names.push("action_" + String(j));
            }
            else { // if action space is multi_discrete
              var action_branch_names = []; // Names of the branches of the action space
              for(var j = 0; j < y_action[0][i].length; j++){
                action_branch_names.push("action_" + String(j));
              }
              action_names.push(action_branch_names);
            }     
          }
        }
        else{
          if(action[0].length == 1 && Array.isArray(action_names[0])){ // If action space is discrete and action_names is multi_discrete
            action_names = action_names[0]; // Set action_names to the first branch of the action space
          }
        }

        // Modify dropdown menu
        if(is_discrete){ // if action space is discrete
          document.getElementById("all").outerHTML=""; // remove dropdown option 'all'
        }
        else { // If action space is multi_discrete
          // Create dropdown menu for the entropy function
          var dropdown_content = document.getElementById("dropdown_content"); 
          for(var i = 0; i < action[0].length; i++){
            var entropy_dropdown_option = document.createElement("a");
            entropy_dropdown_option.innerHTML = "action_space_" + String(i);
            entropy_dropdown_option.setAttribute("href", "#");
            entropy_dropdown_option.setAttribute("onclick", "set_action_space(" + String(i) + ")");
            dropdown_content.appendChild(entropy_dropdown_option);
          }
        }

        window.addEventListener('load', () => {
          // Set video length to length - 0.9999 because the last frame is two seconds long
          video_length = video_player.duration - 0.9999;
          time_selector.setAttribute('max', video_length); // Set max value of time selector to video length

          video_player.addEventListener('timeupdate', timeListener); // Update time selector and plots when video is playing
          video_player.addEventListener('dblclick', function(e) {open_fullscreen(video_player);}); // Open video in fullscreen when video is double clicked
          video_player.playbackRate = 6; // Set video playback rate to frame rate
          reset(); // Reset video to start
        }, false);
      
      // Update video time if time selector is changed
      time_selector.addEventListener('input', () => {
          video_player.currentTime = time_selector.value
          pause();
          update();
      })

      // Add event manager for tab
      window.addEventListener('keydown', function(event) {
          if (event.key === 'Tab') {
              if (statistic_type == "transformer") {
                statistic_plot_id = (statistic_plot_id + 1) % 3;
                // Set action plot if statistic_plot_id is 0
                if(statistic_plot_id == 0){
                  // Update action plot
                  if(is_discrete) { // If action_space is discrete
                    set_bar_action_plot(y_action[step][0], action[step][0], action_names);
                  }
                  else { // If action_space is multi discrete
                      set_stacked_bar_action_plot(y_action[step], action[step], action_names);
                  }
                }
                // Set value plot if statistic_plot_id is 1
                if (statistic_plot_id == 1) {
                  set_scatter_line_plot('action_distr', "Value Function", y_values_plot, step, value_marker);
                }

              // Set entropy plot if statistic_plot_id is 2
              if (statistic_plot_id == 2) {
                  if(is_discrete) { // If action_space is discrete
                      set_scatter_line_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
                  else { // If action_space is multi discrete
                      set_scatter_lines_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
              }
          }
      }
    });

    // Show ground truth if checkbox is checked
    function show_ground_truth() {
        // Get the checkbox element by its ID
        var checkbox = document.getElementById("show_ground_truth");
        
        // Check if the checkbox is checked
        if (checkbox.checked) { // Show the ground truth
          if (video_id == render_id) video_id = render_gt_id;
          if (video_id == render_decoder_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else {
          if (video_id == render_gt_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_agent_id;
          set_video(video_path[video_id]);
        }
      }

    // Show decoder video if checkbox is checked
    function show_decoder_video() {
      var checkbox = document.getElementById("show_decoder_video");
      document.getElementById("show_agent_video").checked = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_decoder_id;
          if (video_id == render_gt_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_decoder_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide decoder video
          if (video_id == render_decoder_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Show agent video if checkbox is checked
    function show_agent_video() {
      var checkbox = document.getElementById("show_agent_video");
      document.getElementById("show_decoder_video").checked  = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_agent_id;
          if (video_id == render_gt_id) video_id = render_agent_gt_id;
          if (video_id == render_decoder_id) video_id = render_agent_id;
          if (video_id == render_decoder_gt_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide agent video
          if (video_id == render_agent_id) video_id = render_id;
          if (video_id == render_agent_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Set the video to the given path
    function set_video(path) {
        // Get video data to make the switch seamless
        var current_time = video_player.currentTime;
        var play_back_rate = video_player.playbackRate;
        var is_paused = video_player.paused;
        video_player.querySelector("source").src = path;
        // Reload video
        video_player.load();
        video_player.currentTime = current_time;
        video_player.playbackRate = play_back_rate;
        if(is_paused) pause();
        else play();
    }


      /**
      * Update time selector and plots when video is playing
      */
      function timeListener() {
        if(!video_player.paused) {
          update();
        } 
      }

      /**
      * Toggles button and video between playing and paused
      */
      function play_pause() {
        if(video_player.paused)
          play();
        else 
          pause();
      }

      /**
       * Returns to the previous frame step
       */
       function return_to_step() {
        video_player.currentTime = past_steps.pop();
        pause();
        update();
        gotostep_text.value = step;
        return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Updates the plots and time selector
       */
       function go_to_step(event) {
        if (event.keyCode === 13) {
          past_steps.push(step);
          video_player.currentTime = Number(gotostep_text.value);
          pause();
          update();
          gotostep_text.value = step;
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
        }
      }

      function set_video_speed(event) {
        if (event.keyCode === 13) {
          video_player.playbackRate = Number(video_speed.value);
        }
      }

      /**
       * Updates the plots and time selector
       */
       function top_scores() {
        if (event.keyCode === 13) update()
      }

      /**
      * Pauses video
      */
      function pause() {
          play_pause_button.innerHTML = "Play";
          video_player.pause();
      }

      /**
      * Plays the video
      */
      function play() {
          play_pause_button.innerHTML = "Pause";
          video_player.play();
      }

      /**
      * Resets the video and plots to the start
      */
      function reset() {
          video_player.currentTime = 0;
          past_steps.push(step);
          pause();
          update();
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the previous frame
      */
      function back() {
          video_player.currentTime = video_player.currentTime - tS_step_size
          pause();
          update();
          past_steps.push(step + 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the next frame
      */
      function next() {
          video_player.currentTime = video_player.currentTime + tS_step_size;
          pause();
          update();
          past_steps.push(step - 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Switches between general and transformer statistics
       */
       function statistic() {
        if (stats_button.innerHTML == "General") {
          statistic_type = "general";
          stats_button.innerHTML = "Transformer";
        }
        else if (stats_button.innerHTML == "Transformer") {
          statistic_type = "transformer";
          stats_button.innerHTML = "General";
        }
        update();
      }
      /**
      * Opens the video in fullscreen
      */
      function open_fullscreen(vid_elem) {
          if (vid_elem.requestFullscreen) {
              vid_elem.requestFullscreen();
          } else if (vid_elem.webkitRequestFullscreen) { /* Safari */
              vid_elem.webkitRequestFullscreen();
          } else if (vid_elem.msRequestFullscreen) { /* IE11 */
              vid_elem.msRequestFullscreen();
          }
          vid_elem.pause();
      }

      // Selects the action space for the entropy plot
      function set_action_space(spaces){
        if (spaces == 'all')
          entr_selected_action_space = null;
        else
          entr_selected_action_space = Number(spaces);
        update();
      }

      function marker(marker_id){
        if(marker_id == "entropy")
          entropy_marker = !entropy_marker;
        else if(marker_id == "value")
          value_marker = !value_marker;
        update();
      }

      /**
      * Updates the plots and time selector
      */
      function update()  {
        if(video_player.currentTime == Math.round(video_player.currentTime)) // If time t of video is a natural number then step is t - 1
              video_player.currentTime += 0.0001 // Add a small number to make sure that the step and the current time are the same
        if(video_player.currentTime > video_length) {
           video_player.currentTime = video_length;
           pause();
        } // Video can't go past the end
        time_selector.value = video_player.currentTime; // Update time selector
        step = Math.floor(video_player.currentTime); // Get step of video for plots

        // Update plots
        if (statistic_type == "general")
          render_general_statistics();
        else if (statistic_type == "transformer")
          render_transformer_statistics();

        if(statistic_type == "general") {
          // Reset plot id
          statistic_plot_id = 0;
          // Update action plot
          if(is_discrete) { // If action_space is discrete
            set_bar_action_plot(y_action[step][0], action[step][0], action_names);
          }
          else { // If action_space is multi discrete
              set_stacked_bar_action_plot(y_action[step], action[step], action_names);
          }
        }
      }

      /**
      * Renders the general statistics
      */
      function render_general_statistics() {
        // Disables the transformer statistics and enables the general statistics
          document.getElementById('transformer').style.display = 'none';
          document.getElementById('top_n_scores').style.display = 'none';
          document.querySelector('label[for="top_n_scores"]').style.display = 'none';
          document.getElementById('value_func').style.display = 'block';
          document.getElementById('entropy_func').style.display = 'block';
          document.getElementById('options').style.display = 'block';
        // Updates the plots
          set_scatter_line_plot('value_func', "Value Function", y_values_plot, step, value_marker);
          if(is_discrete) { // If action_space is discrete
              set_scatter_line_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
          else { // If action_space is multi discrete
              set_scatter_lines_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
        }
      
      /*
      * Renders the transformer statistics
      */
      function render_transformer_statistics() {
        // Disables the general statistics and enables the transformer statistics
        document.getElementById('transformer').style.display = 'block';
        document.getElementById('top_n_scores').style.display = 'block';
        document.querySelector('label[for="top_n_scores"]').style.display = 'block';
        document.getElementById('value_func').style.display = 'none';
        document.getElementById('entropy_func').style.display = 'none';
        document.getElementById('options').style.display = 'none';
        // Updates the plots
        var top_n = Number(top_n_scores.value);
        if (top_n == -1) top_n = step;
        visualizeAttentionScores(y_attention_weights[step], top_n);
        }


      /**
       * Renders attention scores
      */
      async function visualizeAttentionScores(attentionScores, n_values) {
        const numHeads = attentionScores.length;
        
        let data = [];
        let layout = {
          grid: {
              rows: numHeads, 
              columns: 1, 
              pattern: 'independent',
              subplots: [...Array(numHeads).keys()].map(i => `xy${i + 1}`),
              ygap: 0.4 // adjust this value according to your preference
          },
          plot_bgcolor: '#000',
          paper_bgcolor: '#000',
          font: {
              family: 'Montserrat',
              size: 12,
              color: '#fff'
          },
          margin: {
              t: 0,  // reduce top margin
          },
      }

        // Flatten the array to find the max value across all arrays
        let flatScores = attentionScores.flat();
        let maxScore = Math.max(...flatScores);

        // Iterate through each attention head
        for (let headIdx = 0; headIdx < numHeads; headIdx++) {
            // Get attention scores for the current head
            let headScores = attentionScores[headIdx];
            
            // This array will keep up to the 10 highest scores
            let topScores = [];

            for (let i = 0; i < headScores.length; i++) {
                // Insert current score into the top scores array
                topScores.push({score: headScores[i], index: i});
                
                // Sort the top scores array
                topScores.sort((a, b) => b.score - a.score);

                // If there are more than 10 scores, remove the smallest
                if (topScores.length > n_values) {
                    topScores.pop();
                }
            }

            // Sort the topScores array by index
            topScores.sort((a, b) => a.index - b.index);

            // Now topScores contains the top 10 scores sorted by their indices.
            // You can extract the scores and their indices into separate arrays:
            let filteredHeadScores = topScores.map(x => x.score);
            let filteredTicks = topScores.map(x => x.index);


            const sequenceLength = filteredHeadScores.length;

            layout.height = 400;
            layout.width = window.innerWidth;

            const headScoresPlot = {
                z: [filteredHeadScores],
                type: 'heatmap',
                showscale: true,  
                colorscale: 'Hot',
                zmin: 0,
                zmax: maxScore,
                xaxis: `x${headIdx + 1}`,
                yaxis: `y${headIdx + 1}`,
            };

            data.push(headScoresPlot);

            layout[`xaxis${headIdx + 1}`] = {
                tickmode: 'array',
                tickvals: Array.from({length: sequenceLength}, (_, i) => i),
                ticktext: filteredTicks
            };

            layout[`yaxis${headIdx + 1}`] = {
                title: `Block ${headIdx + 1}`,
                ticks: 'outside',
                tick0: 0,
                dtick: 1,
                ticklen: 8,
                tickwidth: 4,
                tickcolor: '#000'
            };
        }

        const config = {responsive: true};

        Plotly.newPlot('transformer', data, layout, config).then(function() {
          var myPlot = document.getElementById('transformer');
          myPlot.on('plotly_click', function(data){
            // Jump to the step that was clicked
              past_steps.push(step);
              video_player.currentTime = Number(data.points[0].xaxis.ticktext[data.points[0].x]);
              pause();
              update();
              return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      });
    }

      /** 
      * Sets a stacked bar plot for the multi discrete action distribution
      * @param {array} y_values - The action distribution
      * @param {array} action - The action
      * @param {array} action_names - The names of the actions
      */
      function set_stacked_bar_action_plot(y_values, action, action_names) {
        var bar_plot_data_action = [];
        // Set data for each action
        for(var j = 0; j < action_names[0].length; j++) {
            var color = ""
            for(var i = 0; i < action_names.length; i++) {
                if(action[i] == j) // If action sampled in the current frame
                    color = '#FF0000'; // Color it red
                else
                    color = '#FAEBD7'; // Color it white
                var trace = {
                    x: [["action_space_", String(i)].join("")],
                    y: [y_values[i][j]],
                    text: [y_values[i][j], action_names[i][j]].map(String).join("<br>"), // Add action name and prob to the bar
                    marker: {
                        color: color,
                        line: {
                            color: '#000000',
                            width: 1
                          }
                    },
                    type: 'bar'
                };
                bar_plot_data_action.push(trace);
            }
        }

        // Set layout for the plot
        var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            barmode: 'stack',
            showlegend: false
      };

      // Plot the data
      Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }

      /**
      * Sets a bar plot for the discrete action distribution
      */
      function set_bar_action_plot(y_values, action, action_names) {

          var color_value = new Array(y_values.length).fill('#FAEBD7'); // Set color for all actions to white
          color_value[action] = '#FF0000'; // Except the selected action should be red
          // Set data for the plot
          var bar_plot_data_action = [
              {
                  x: action_names,
                  y: y_values,
                  type: 'bar',
                  marker: {
                      color: color_value
                  },
                  textposition: 'auto',
                  text: y_values.map(String), // Add prob to the bar plot
                  textfont: {
                      family: 'Montserrat',
                      size: 12,
                  },
                  textangle: 0,
                  textposition: 'bottom center',
              }
          ];

          // Set layout for the plot
          var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            yaxis: {
              automargin: true,
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            }
      };
          
          // Plot the action distribution
          Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }


      /**
      * Sets a scatter plot for the emtropy function if multi discrete actions are used
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The entropy function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_lines_plot(id, title, y_values, step, marker) {
        line_scatter_plot_data_value = [];

        // Set colors and data for the plot
        var colors = ['#FAEBD780', '#7CFC0080', '#FFBF0080', '#FF7F5080', '#DE316380', '#9FE2BF80', '#40E0D080', '#6495ED80', '#CCCCFF80']
        for(var i = 0; i < y_values.length; i++) {
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values[i].slice(0, step + 1);
            var trace = [
            {
                x: x_values_marker,
                y: y_values_marker,
                mode: 'line',
                line: {
                    color: colors[i]
                },
                name: 'action_space_' + String(i),
                showlegend: true,
            },
            {
                x: x_values,
                y: y_values[i],
                mode: 'markers',
                name: 'action_space_' + String(i) + "_marker",
                marker: {
                    color: colors[i]
                },
                showlegend: true,
            }
        ];
            // Add data to the plot
            line_scatter_plot_data_value.push(trace[0]);
            if(marker)
              line_scatter_plot_data_value.push(trace[1]); 
        }

        // Select the selected action_space for the entropy plot
        if(entr_selected_action_space != null && marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space * 2], line_scatter_plot_data_value[entr_selected_action_space * 2 + 1]];
        else if(entr_selected_action_space != null && !marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space]];

        // Set layout for the plot
        var line__scatter_plot_layout_value = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 50,
                r: 0,
                b: 30,
                t: 25,
                pad: 4
                },
            yaxis: {
                automargin: true
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: title,
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            showlegend: true,
        };

        // Plot the data
        Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);
      }


      /**
      * Sets a scatter plot for the value function
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The value function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_line_plot(id, title, y_values, step, marker) {
          // Set data for layout for the plot
          var line__scatter_plot_layout_value = {
              autosize: true,
              width: 600,
              height: 360,
              margin: {
                  l: 50,
                  r: 0,
                  b: 30,
                  t: 25,
                  pad: 4
                  },
              yaxis: {
                  automargin: true
              },
              plot_bgcolor: '#000',
              paper_bgcolor: '#000',
              font: {
                  family: 'Montserrat',
                  size: 12,
                  color: '#fff'
              },
              title: {
                  text: title,
                  font: {
                      family: 'Montserrat',
                      size: 15,
                      color: '#fff'
                  }
              },
              showlegend: false,
          };

          // Set data for the plot
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values.slice(0, step + 1);

          var line_scatter_plot_data_value = [
              {
                  x: x_values_marker,
                  y: y_values_marker,
                  mode: 'line',
                  line: {
                      color: '#FAEBD7'
                  },
                  name: 'function',
              },
              {
                  x: x_values,
                  y: y_values,
                  mode: 'markers',
                  marker: {
                      color: '#7CFC0080'
                  },
                  name: 'marker',
              }
          ];

          if(!marker)
            line_scatter_plot_data_value = [line_scatter_plot_data_value[0]];

          // Plot the value function
          Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);
      }
    
    /**
    * Opens the specific tab based on the probided id
    * @param {string} id - The id of the tab
    */
    function openTab(evt, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        mediatabcontent = document.getElementsByClassName("mediatabcontent");
        // Hide all elements with class="tabcontent" and "mediacontent" by default
        for (i = 0; i < mediatabcontent.length; i++) {
            mediatabcontent[i].style.display = "none";
        }
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        // Show the specific tab content
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(id).style.display = "block";
        evt.currentTarget.className += " active";
      }
    </script>
  </body>
</html>