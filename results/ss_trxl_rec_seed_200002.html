<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;500&display=swap" rel="stylesheet"/>
    <script src="template/cdn.plot.ly_plotly-2.6.3.min.js"></script>
    <style>
     /* Style the body */
      html, body {
        height: 100%;
        margin: 0;
        background-color: #000;
        color: white;
        font-family: "Montserrat", sans-serif;
        min-width: 1737px;
      }

      /* Set the width and hight of the video*/
      video {
        width: 600px;
        height: 400px;
      }

      /* Style the timeline text*/
      #selector_header {
        font-weight: 200;
      }

      /* Buttons should be displayed in a row */
      buttonrow {
        display: inline;
      }

      /* Style the figures */
      #figures {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        flex-flow: row nowrap;
      }

      /* Style the tab */
      .tab {
        overflow: hidden;
        background-color: #54595f;
      }

      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
        color: white;
      }

      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #909090;
      }

      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #838383;
      }

      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border-top: none;
        background-color: #000;
      }

      .mediatabcontent {
        display: none;
        padding: 0 px 0 px;
        border-top: none;
        background-color: #000;
        width: 100%;
        height: 100%;
      }

      /* Style the close button */
      .topright {
        float: right;
        cursor: pointer;
        font-size: 28px;
      }

      .topright:hover {
        color: red;
      }

      /* Style of the dropdown button */
      .dropbtn {
        background-color: #17202A;
        color: white;
        padding: 16px;
        font-size: 16px;
        border: none;
      }
      
      .dropdown {
        position: relative;
        display: inline-block;
      }
      
      /* Style of the dropdown content */
      .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        background-color: #A6ACAF;
        z-index: 1;
      }
      
      .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
      }

      .gotostepcontainer {
          margin-bottom: 10px;
      }
      
      #score-container label, #score-container input {
        display: inline-block;
      }

      /* Style of the dropdown at hover */
      .dropdown-content a:hover {background-color: #ddd;}
      
      .dropdown:hover .dropdown-content {display: block;}
      
      .dropdown:hover .dropbtn {background-color: #161515;}
    </style>
  </head>
  <body>
    <!--- Define tabs -->
    <div class="tab">
      <button class="tablinks" onclick="location.href='../index.html'">Back</button>
      <button class="tablinks" onclick="openTab(event, 'Environment')">Environment</button>
      <button class="tablinks" onclick="openTab(event, 'Sampler')">Sampler</button>
      <button class="tablinks" onclick="openTab(event, 'Hyperparameters')">Hyperparameters</button>
      <button class="tablinks" onclick="openTab(event, 'Model')">Model</button>
      <button class="tablinks" onclick="openTab(event, 'Media')" id="defaultOpen">Media</button>
    </div>

    <!--- Define tab content -->
    <div id="Environment" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>type</b>: MemoryGym<br><b>name</b>: SearingSpotlights-v0<br><b>frame_skip</b>: 1<br><b>last_action_to_obs</b>: False<br><b>last_reward_to_obs</b>: False<br><b>obs_stacks</b>: 1<br><b>grayscale</b>: False<br><b>resize_vis_obs</b>: [84, 84]<br><b>positional_encoding</b>: False<br><b>reset_params</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>start-seed</b>: 200002<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num-seeds</b>: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_steps</b>: 256<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial_spawns</b>: 4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_spawns</b>: 30<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial_spawn_interval</b>: 30<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spawn_interval_threshold</b>: 10<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spawn_interval_decay</b>: 0.95<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_min_radius</b>: 7.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_max_radius</b>: 13.75<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_min_speed</b>: 0.0025<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_max_speed</b>: 0.0075<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_damage</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>visual_feedback</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>black_background</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hide_chessboard</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>light_dim_off_duration</b>: 6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>light_threshold</b>: 255<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_coins</b>: [1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>coin_scale</b>: 0.375<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>coins_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>use_exit</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>exit_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>exit_scale</b>: 0.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_speed</b>: 3.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_health</b>: 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_scale</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>sample_agent_position</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>show_last_action</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>show_last_positive_reward</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_inside_spotlight</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_outside_spotlight</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_death</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_exit</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_max_steps</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_coin</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>seed</b>: 200002<br><b>reward_normalization</b>: 0<br>
    </div>

    <div id="Model" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>load_model</b>: False<br><b>model_path</b>: <br><b>checkpoint_interval</b>: 500<br><b>activation</b>: relu<br><b>vis_encoder</b>: cnn<br><b>vec_encoder</b>: linear<br><b>num_vec_encoder_units</b>: 128<br><b>hidden_layer</b>: default<br><b>num_hidden_layers</b>: 1<br><b>num_hidden_units</b>: 384<br><b>transformer</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_blocks</b>: 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>embed_dim</b>: 384<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_heads</b>: 4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>memory_length</b>: 256<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>positional_encoding</b>: absolute<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>layer_norm</b>: pre<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>init_weights</b>: xavier<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl_bias</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl_swap</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>share_heads</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_episode_steps</b>: 257<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>add_positional_encoding_to_query</b>: False<br><b>obs_decoder</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>attach_to</b>: memory<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>detach_gradient</b>: False<br>
    </div>

    <div id="Sampler" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>n_workers</b>: 32<br><b>worker_steps</b>: 512<br>
    </div>

    <div id="Hyperparameters" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>algorithm</b>: PPO<br><b>resume_at</b>: 0<br><b>gamma</b>: 0.995<br><b>lamda</b>: 0.95<br><b>updates</b>: 30000<br><b>epochs</b>: 3<br><b>refresh_buffer_epoch</b>: -1<br><b>n_mini_batches</b>: 8<br><b>advantage_normalization</b>: no<br><b>value_coefficient</b>: 0.5<br><b>max_grad_norm</b>: 0.25<br><b>share_parameters</b>: True<br><b>learning_rate_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.000275<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-05<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 20000<br><b>beta_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.0001<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-06<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 20000<br><b>clip_range_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>obs_reconstruction_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 1000<br><b>ground_truth_estimator_schedule</b>: {'initial': 0.0}<br>
    </div>

    <div id="Media" class="mediatabcontent">
      <br>
      <center>
        <div id="figures" style="display: flex; flex-direction: column;">
          <div style="display: flex; flex-direction: row;">
            <div style="display: flex; flex-direction: column;">
              <div style="display: flex; flex-direction: row;">
                <label for="video_speed">Frame Rate: </label>
                <input type="text" id="video_speed" size="3" value="6" onkeydown="set_video_speed(event)">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_ground_truth">Show Ground Truth Estimation</label>
                <input type="checkbox" id="show_ground_truth" onclick="show_ground_truth()">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_decoder_video">Show Decoder Video</label>
                <input type="checkbox" id="show_decoder_video" onclick="show_decoder_video()">
              </div>

            <div style="display: flex; flex-direction: row;">
              <label for="show_agent_video">Show Agent Video</label>
              <input type="checkbox" id="show_agent_video" onclick="show_agent_video()">
            </div>
          </div>
          
            <div>
              <video id="video_player">
                <source src="" type="video/webm" />
              </video>
            </div>
            <div id="action_distr"></div>
          </div>
        </div>

        <br>
        <!-- Set buttons to control the figures -->
        <div class="gotostepcontainer">
          <label for="gotostep_text">Step:</label>
          <input type="text" id="gotostep_text" size="3" value="0" onkeydown="go_to_step(event)">
          <button id="return_button" type="return_button" onclick="return_to_step()">Return to step 0</button>
        </div>
        <buttonrow>
          <button id="play_pause_button" onclick="play_pause()" style="width:53px">Play</button>
          <button id="reset_button" onclick="reset()">Reset</button>
          <button id="back_button" onclick="back()">Back</button>
          <button id="next_button" onclick="next()">Next</button>
          <button id="stats_button" onclick="statistic()">Attention Scores</button>
        </buttonrow>
        <br>
        <!-- Set slider to control the figures -->
        <input id="time_selector" type="range" min="0" max="100" step="1" value="0" style="width: 300px;"/>

        <!-- Set transformer plot -->
        <div id="score-container">
          <label for="top_n_scores">Number of Top Attention Scores:</label>
          <input type="text" id="top_n_scores" size="3" value="-1" onkeydown="top_scores()">
        </div>
        <div id="transformer"></div>

        <!-- Set value plot and entropy plot -->
        <div id="figures">
          <div id="value_func"></div>
          <div id="entropy_func"></div>
          <!-- Dropdown button with some options-->
          <div class="dropdown" id="options">
            <button class="dropbtn">Options</button>
            <div class="dropdown-content" id="dropdown_content">
              <a href ="#" onclick="marker('value')">value_marker_toggle</a>
              <a href ="#" onclick="marker('entropy')">entropy_marker_toggle</a>
              <a href="#" id="all" onclick="set_action_space('all')">All</a>
            </div>
          </div>
        </div>
      </center>
    </div>

    <script>
        // Set active tab
        document.getElementById("defaultOpen").click();

        // Set video player
        const video_player = document.getElementById("video_player");
        const video_speed = document.getElementById("video_speed");
        const video_path = ['videos/video_seed_200002_163.webm', '', 'videos/video_seed_200002_164.webm', '', 'videos/video_seed_200002_165.webm', ''];
        var render_id = 0; var render_gt_id = 1; var render_decoder_id = 2; var render_decoder_gt_id = 3; var  render_agent_id = 4; var render_agent_gt_id = 5;
        var video_id = 0;
        // Hide video player if there is no ground truth video
        if (video_path[render_gt_id].length == 0 && video_path[render_decoder_gt_id].length == 0 && video_path[render_agent_gt_id].length == 0){
          document.querySelector('label[for="show_ground_truth"]').style.display = 'none';
          document.getElementById("show_ground_truth").style.display = 'none';
        } 
        if (video_path[render_decoder_id].length == 0){
          document.querySelector('label[for="show_decoder_video"]').style.display = 'none';
          document.getElementById("show_decoder_video").style.display = 'none';
        }
        if (video_path[render_agent_id].length == 0){
          document.querySelector('label[for="show_agent_video"]').style.display = 'none';
          document.getElementById("show_agent_video").style.display = 'none';
        }

        video_player.querySelector("source").src = video_path[0];
        video_player.load();
        var video_length = 0;

        // Play and pause button
        const play_pause_button = document.getElementById("play_pause_button");

        // Set step input
        const gotostep_text = document.getElementById('gotostep_text');
        var past_steps = [0];
        var step = 0;

        // Set number of scores input
        const top_n_scores = document.getElementById('top_n_scores');

        // Const stats button
        const stats_button = document.getElementById("stats_button");

        // Set time selector
        const time_selector = document.getElementById('time_selector');
        var tS_step_size = 1.0;

        // Set values for the plots
        var y_values = [[1.1217840909957886], [1.117339015007019], [1.1173218488693237], [1.13059663772583], [1.136479377746582], [1.1356855630874634], [1.1406891345977783], [1.149251103401184], [1.1568869352340698], [1.15940523147583], [1.1635724306106567], [1.1664972305297852], [1.1713751554489136], [1.168233871459961], [1.1356922388076782], [1.0821365118026733], [0.9398964643478394], [0.9437758922576904], [0.9469181299209595], [0.9534186124801636], [0.9589917659759521], [0.9597258567810059], [0.9635015726089478], [0.9709351062774658], [0.9769923686981201], [0.9776113033294678], [0.9839235544204712], [0.9850097894668579], [0.9802960157394409]];
        var y_entropy = [[0.6414140462875366, 0.006329177878797054], [2.4996792490128428e-05, 0.17617161571979523], [3.511113845888758e-06, 0.15625080466270447], [1.3584050293502514e-06, 0.15322673320770264], [1.5849984720262e-06, 0.1722850501537323], [1.7910646192831337e-06, 0.16476097702980042], [5.420540219347458e-06, 0.3237622380256653], [1.2357932064333e-05, 0.3647446036338806], [2.2711989004164934e-05, 0.42203956842422485], [4.141082536079921e-05, 0.5120367407798767], [0.00012924725888296962, 0.6804561614990234], [0.0003487235226202756, 0.6514915227890015], [0.0001874257723102346, 0.5894252061843872], [0.00240874825976789, 0.46969860792160034], [0.02125590853393078, 0.11793109029531479], [0.019389500841498375, 0.3182499408721924], [0.3449881374835968, 0.00920875370502472], [0.5858686566352844, 0.0050377389416098595], [0.5583613514900208, 0.003973419312387705], [0.5962553024291992, 0.00381701928563416], [0.6250373125076294, 0.0035559069365262985], [0.591822624206543, 0.0054501742124557495], [0.585186779499054, 0.005695492960512638], [0.6675678491592407, 0.002552899532020092], [0.6913131475448608, 0.002631228417158127], [0.6855109333992004, 0.004192984662950039], [0.6961891651153564, 0.005090535152703524], [0.6968121528625488, 0.004755071830004454], [0.7002526521682739, 0.005130571313202381]];
        var y_attention_weights = [[[], [], []], [[1.0], [1.0], [1.0]], [[0.40288007259368896, 0.5971199870109558], [0.24412287771701813, 0.7558771371841431], [0.6180641651153564, 0.38193580508232117]], [[0.20004954934120178, 0.2414063960313797, 0.5585440397262573], [0.14877864718437195, 0.4751739501953125, 0.37604737281799316], [0.4758647680282593, 0.2904910445213318, 0.23364418745040894]], [[0.14982685446739197, 0.17567852139472961, 0.3000746965408325, 0.3744199275970459], [0.11383844912052155, 0.37841036915779114, 0.2812960743904114, 0.22645513713359833], [0.4111263155937195, 0.24735985696315765, 0.19613060355186462, 0.14538323879241943]], [[0.11636209487915039, 0.13713088631629944, 0.22089308500289917, 0.23147818446159363, 0.2941357493400574], [0.09565700590610504, 0.33330973982810974, 0.23940259218215942, 0.187958225607872, 0.14367243647575378], [0.37189891934394836, 0.22580301761627197, 0.1756574958562851, 0.12680310010910034, 0.09983749687671661]], [[0.09693282842636108, 0.11621418595314026, 0.19367697834968567, 0.19513925909996033, 0.24173738062381744, 0.15629936754703522], [0.08448393642902374, 0.30628493428230286, 0.22234895825386047, 0.17230480909347534, 0.1303425282239914, 0.08423486351966858], [0.33734264969825745, 0.21557679772377014, 0.16374288499355316, 0.11696108430624008, 0.09036508202552795, 0.07601147890090942]], [[0.08629954606294632, 0.10643221437931061, 0.18678703904151917, 0.18345995247364044, 0.23713941872119904, 0.1321280151605606, 0.06775379925966263], [0.08174729347229004, 0.29043832421302795, 0.21796926856040955, 0.1672784835100174, 0.12449565529823303, 0.07698982208967209, 0.04108111932873726], [0.32879969477653503, 0.20188063383102417, 0.15229687094688416, 0.10711772739887238, 0.080895334482193, 0.06660811603069305, 0.062401626259088516]], [[0.07776868343353271, 0.0986529216170311, 0.17944014072418213, 0.1766895353794098, 0.23182892799377441, 0.1216638833284378, 0.052684053778648376, 0.06127180531620979], [0.07960900664329529, 0.2904207706451416, 0.2151818424463272, 0.16377374529838562, 0.11933920532464981, 0.07097964733839035, 0.0360243134200573, 0.02467152290046215], [0.3217545747756958, 0.19249576330184937, 0.14329473674297333, 0.09936512261629105, 0.07367099076509476, 0.05996754765510559, 0.05604024976491928, 0.053411029279232025]], [[0.07247744500637054, 0.09329405426979065, 0.17383083701133728, 0.1718289703130722, 0.22764700651168823, 0.1162542849779129, 0.04500041902065277, 0.048757486045360565, 0.05090947076678276], [0.07963867485523224, 0.2884956896305084, 0.21175646781921387, 0.15982618927955627, 0.11552398651838303, 0.06816518306732178, 0.03439343348145485, 0.023305175825953484, 0.018895134329795837], [0.3114018738269806, 0.18485909700393677, 0.13742052018642426, 0.09458579123020172, 0.06903651356697083, 0.05531914532184601, 0.05133088678121567, 0.04876997321844101, 0.047276224941015244]], [[0.0691063404083252, 0.08996407687664032, 0.1695878505706787, 0.16789361834526062, 0.2255096733570099, 0.11243738234043121, 0.040279339998960495, 0.04015347361564636, 0.04144128039479256, 0.04362691193819046], [0.07933217287063599, 0.2856425642967224, 0.20720672607421875, 0.1555829644203186, 0.11254555732011795, 0.06668215245008469, 0.03385790064930916, 0.022825948894023895, 0.018400130793452263, 0.017923830077052116], [0.3017685115337372, 0.1783922165632248, 0.1326885223388672, 0.09068181365728378, 0.06534430384635925, 0.05169389396905899, 0.04766836762428284, 0.0452299565076828, 0.04380250349640846, 0.04272990673780441]], [[0.06620791554450989, 0.0869266539812088, 0.16641497611999512, 0.16487780213356018, 0.22248506546020508, 0.10907334089279175, 0.03642120212316513, 0.03493231534957886, 0.03598819300532341, 0.03785109519958496, 0.03882144019007683], [0.07858803868293762, 0.2821540832519531, 0.20213262736797333, 0.15105143189430237, 0.10912532359361649, 0.06494724750518799, 0.033358797430992126, 0.02246636338531971, 0.01807418093085289, 0.017490597441792488, 0.020611299201846123], [0.2917932868003845, 0.1731833964586258, 0.12906447052955627, 0.08780369907617569, 0.06252169609069824, 0.04871148243546486, 0.04447076842188835, 0.042096301913261414, 0.04073406383395195, 0.03972455859184265, 0.03989633172750473]], [[0.06566737592220306, 0.08539773523807526, 0.16509714722633362, 0.16248241066932678, 0.2182738482952118, 0.10645376145839691, 0.033084895461797714, 0.03109976090490818, 0.03175608068704605, 0.03282110393047333, 0.03314488008618355, 0.03472098335623741], [0.0761190801858902, 0.28183409571647644, 0.19690194725990295, 0.14668801426887512, 0.10598458349704742, 0.06303200870752335, 0.03189073130488396, 0.021156053990125656, 0.016829699277877808, 0.016082845628261566, 0.0188299510627985, 0.024650951847434044], [0.2734646201133728, 0.17014183104038239, 0.12625636160373688, 0.08536631613969803, 0.060095205903053284, 0.0462024062871933, 0.04202818125486374, 0.040273215621709824, 0.039287399500608444, 0.0385296605527401, 0.03879125788807869, 0.039563558995723724]], [[0.06322597712278366, 0.08364822715520859, 0.1618724763393402, 0.15920399129390717, 0.21754463016986847, 0.10373181849718094, 0.031312406063079834, 0.028181226924061775, 0.028606615960597992, 0.029521211981773376, 0.02984599769115448, 0.031421612948179245, 0.03188382461667061], [0.07707931101322174, 0.270432710647583, 0.19035604596138, 0.14084771275520325, 0.10177142918109894, 0.061127670109272, 0.03195631876587868, 0.021349390968680382, 0.017000935971736908, 0.01607009954750538, 0.018586033955216408, 0.024333229288458824, 0.029089074581861496], [0.2701367437839508, 0.164936363697052, 0.12351415306329727, 0.08301855623722076, 0.05787297710776329, 0.04396149516105652, 0.039599061012268066, 0.03742676600813866, 0.03622852638363838, 0.03535395860671997, 0.035498641431331635, 0.03612066060304642, 0.03633211553096771]], [[0.061746954917907715, 0.08189486712217331, 0.15932482481002808, 0.1568712592124939, 0.21599522233009338, 0.10188610106706619, 0.029302794486284256, 0.025195911526679993, 0.025421343743801117, 0.026133252307772636, 0.0264313705265522, 0.02785325050354004, 0.02844916842877865, 0.03349369391798973], [0.07635170221328735, 0.26282399892807007, 0.18374419212341309, 0.13517846167087555, 0.0977640226483345, 0.05932715907692909, 0.03150327131152153, 0.021012436598539352, 0.016668876633048058, 0.015571252442896366, 0.01782548613846302, 0.02331763133406639, 0.028023580089211464, 0.030887939035892487], [0.25890886783599854, 0.16104736924171448, 0.12140768766403198, 0.08124983310699463, 0.056111451238393784, 0.042078785598278046, 0.03762748837471008, 0.03542909026145935, 0.034229204058647156, 0.0333838015794754, 0.03350071981549263, 0.034061647951602936, 0.03432317078113556, 0.036640919744968414]], [[0.06109482795000076, 0.08062222599983215, 0.15800803899765015, 0.15557032823562622, 0.21271279454231262, 0.10069728642702103, 0.027304520830512047, 0.02252289466559887, 0.022682461887598038, 0.02318897284567356, 0.023327279835939407, 0.024373291060328484, 0.024499796330928802, 0.02950998581945896, 0.033885277807712555], [0.07574667036533356, 0.2602168023586273, 0.1796053946018219, 0.13187354803085327, 0.09552518278360367, 0.057974595576524734, 0.030385732650756836, 0.02002899721264839, 0.01573643647134304, 0.014500114135444164, 0.01635306514799595, 0.021098831668496132, 0.02515624649822712, 0.027578458189964294, 0.028219958767294884], [0.24679343402385712, 0.1583450734615326, 0.11905346810817719, 0.0788998156785965, 0.05373726412653923, 0.03958919644355774, 0.03519318997859955, 0.033523350954055786, 0.0326257050037384, 0.031959958374500275, 0.03213769942522049, 0.03270018845796585, 0.033005937933921814, 0.03511293977499008, 0.03732277452945709]], [[0.06951293349266052, 0.08843094110488892, 0.12988460063934326, 0.09388431906700134, 0.08926044404506683, 0.06446106731891632, 0.02878938615322113, 0.03590411692857742, 0.043616101145744324, 0.04775136336684227, 0.04917958378791809, 0.04636169224977493, 0.04975152760744095, 0.05026203393936157, 0.05502353236079216, 0.057926326990127563], [0.11339198052883148, 0.27195897698402405, 0.17986756563186646, 0.1268116533756256, 0.08925444632768631, 0.05404502525925636, 0.028451766818761826, 0.018682627007365227, 0.015434910543262959, 0.014429588802158833, 0.014546770602464676, 0.014780201949179173, 0.014384372159838676, 0.013886632397770882, 0.014427205547690392, 0.01564629003405571], [0.26612502336502075, 0.18944166600704193, 0.12517686188220978, 0.07169391214847565, 0.04378305375576019, 0.030174553394317627, 0.025775032117962837, 0.025358080863952637, 0.026149915531277657, 0.026448598131537437, 0.026476062834262848, 0.027156323194503784, 0.02650444395840168, 0.029108401387929916, 0.030874408781528473, 0.02975364774465561]], [[0.060647688806056976, 0.07910768687725067, 0.13027924299240112, 0.0894678384065628, 0.0869915634393692, 0.06090082973241806, 0.022621342912316322, 0.019339799880981445, 0.019414527341723442, 0.01939895749092102, 0.018803821876645088, 0.019051624462008476, 0.018700508400797844, 0.02292526513338089, 0.02671562135219574, 0.02765066735446453, 0.27798303961753845], [0.10719996690750122, 0.26013487577438354, 0.18376436829566956, 0.13518089056015015, 0.09710270166397095, 0.05835719779133797, 0.02917378395795822, 0.017625898122787476, 0.013835238292813301, 0.012422092258930206, 0.012283295392990112, 0.012333222664892673, 0.012130689807236195, 0.011745957657694817, 0.012323081493377686, 0.013604319654405117, 0.010782409459352493], [0.25016340613365173, 0.1861090362071991, 0.12192320078611374, 0.0716606006026268, 0.04393457993865013, 0.030069150030612946, 0.025485306978225708, 0.02449471317231655, 0.02513384446501732, 0.025341706350445747, 0.02529328688979149, 0.02589409425854683, 0.025174252688884735, 0.027841217815876007, 0.029472094029188156, 0.028197720646858215, 0.0338117890059948]], [[0.06315220892429352, 0.08305515348911285, 0.13234543800354004, 0.08774365484714508, 0.08252319693565369, 0.05576084926724434, 0.019704533740878105, 0.017175838351249695, 0.017405880615115166, 0.01765095256268978, 0.017299184575676918, 0.017655212432146072, 0.017151348292827606, 0.02080589532852173, 0.02393116056919098, 0.02443098835647106, 0.27548155188560486, 0.026726894080638885], [0.1141662523150444, 0.25118470191955566, 0.17205849289894104, 0.1243748739361763, 0.0898008719086647, 0.05551145225763321, 0.0295465849339962, 0.018537521362304688, 0.01512431725859642, 0.01387086696922779, 0.013813729397952557, 0.013918745331466198, 0.013841400854289532, 0.013644677586853504, 0.014395041391253471, 0.015837378799915314, 0.012086153030395508, 0.018286926671862602], [0.258333295583725, 0.18869590759277344, 0.11992179602384567, 0.06891040503978729, 0.04122108221054077, 0.028024407103657722, 0.023627063259482384, 0.022596009075641632, 0.022867150604724884, 0.022875111550092697, 0.02285422757267952, 0.02340289205312729, 0.022736215963959694, 0.02522478625178337, 0.026841793209314346, 0.025713607668876648, 0.02886442467570305, 0.02728988789021969]], [[0.06375312805175781, 0.08339659124612808, 0.13211990892887115, 0.08655288070440292, 0.08071921765804291, 0.05459682643413544, 0.018630029633641243, 0.0157046876847744, 0.015897249802947044, 0.016052531078457832, 0.01564442738890648, 0.015846263617277145, 0.015314359217882156, 0.018625570461153984, 0.02145080827176571, 0.021900247782468796, 0.2732195258140564, 0.02380494214594364, 0.026770833879709244], [0.11715885996818542, 0.24750277400016785, 0.1653994768857956, 0.11937682330608368, 0.08647885173559189, 0.054102275520563126, 0.028980731964111328, 0.018126891925930977, 0.014829680323600769, 0.013659200631082058, 0.013625390827655792, 0.01373495813459158, 0.013650784268975258, 0.013556611724197865, 0.014344308525323868, 0.015788894146680832, 0.012252097018063068, 0.018388057127594948, 0.01904335804283619], [0.2533445358276367, 0.18840186297893524, 0.11780687421560287, 0.0661589652299881, 0.038989175111055374, 0.026635756716132164, 0.022686004638671875, 0.02178896591067314, 0.021974563598632812, 0.021962009370326996, 0.02198166772723198, 0.022527137771248817, 0.02184358611702919, 0.02425404265522957, 0.025775015354156494, 0.02461007609963417, 0.028021104633808136, 0.02634403109550476, 0.024894680827856064]], [[0.06425079703330994, 0.08373990654945374, 0.1318969875574112, 0.0859185978770256, 0.0795459896326065, 0.05350065231323242, 0.01773669198155403, 0.014580882154405117, 0.014723945409059525, 0.01481187716126442, 0.014381916262209415, 0.014490237459540367, 0.013968327082693577, 0.016950415447354317, 0.01948636956512928, 0.01987839862704277, 0.27076852321624756, 0.02146051451563835, 0.023709813132882118, 0.02419925108551979], [0.11819884181022644, 0.24331025779247284, 0.1602044552564621, 0.11538654565811157, 0.08377167582511902, 0.0528789684176445, 0.028539495542645454, 0.017795255407691002, 0.014569024555385113, 0.013452179729938507, 0.01344292052090168, 0.013594299554824829, 0.013532433658838272, 0.01351882889866829, 0.014315251260995865, 0.015714071691036224, 0.012252883985638618, 0.018266666680574417, 0.018794935196638107, 0.018460994586348534], [0.24902425706386566, 0.1872406303882599, 0.11602423340082169, 0.06419415026903152, 0.03735858201980591, 0.025470124557614326, 0.021739443764090538, 0.02089398354291916, 0.020996488630771637, 0.020960189402103424, 0.021004822105169296, 0.02153293415904045, 0.020866017788648605, 0.023177966475486755, 0.024624520912766457, 0.0234881192445755, 0.027162322774529457, 0.025468546897172928, 0.02401685155928135, 0.024755774065852165]], [[0.06432214379310608, 0.08323680609464645, 0.12920694053173065, 0.08292357623577118, 0.0776224210858345, 0.053361885249614716, 0.018063880503177643, 0.01372941117733717, 0.01335285697132349, 0.013117702677845955, 0.01287048403173685, 0.013230010867118835, 0.013352242298424244, 0.016104338690638542, 0.018370550125837326, 0.018913188949227333, 0.2694444954395294, 0.020407428964972496, 0.021948805078864098, 0.022827209904789925, 0.023593608289957047], [0.11997818946838379, 0.23901480436325073, 0.155430406332016, 0.11392617970705032, 0.08425701409578323, 0.05399789288640022, 0.029186470434069633, 0.01796933077275753, 0.01454863790422678, 0.013207893818616867, 0.012930306605994701, 0.012818713672459126, 0.012563902884721756, 0.012608019635081291, 0.013356359675526619, 0.01447952352464199, 0.01168589387089014, 0.017231471836566925, 0.017472803592681885, 0.01703408733010292, 0.01630213111639023], [0.2387748509645462, 0.18668244779109955, 0.11532563716173172, 0.06294453889131546, 0.03623499348759651, 0.02465885505080223, 0.020959950983524323, 0.020003791898489, 0.01996096968650818, 0.019827716052532196, 0.019848834723234177, 0.0202975794672966, 0.019611792638897896, 0.021695494651794434, 0.02296888455748558, 0.02181427553296089, 0.02747005596756935, 0.02568136714398861, 0.024411708116531372, 0.025101453065872192, 0.02572479285299778]], [[0.06425810605287552, 0.08307509124279022, 0.12922850251197815, 0.08260838687419891, 0.07691770792007446, 0.052506282925605774, 0.017125070095062256, 0.012626082636415958, 0.01234290562570095, 0.012186993844807148, 0.011967035941779613, 0.012281890958547592, 0.012425536289811134, 0.014944504015147686, 0.017087645828723907, 0.01768120378255844, 0.26787269115448, 0.018993863835930824, 0.02017056755721569, 0.02090066857635975, 0.021568654105067253, 0.02123059704899788], [0.12074436992406845, 0.23628756403923035, 0.15162724256515503, 0.11098989099264145, 0.08220118284225464, 0.05301639065146446, 0.02886880375444889, 0.017757654190063477, 0.014394463039934635, 0.013088421896100044, 0.01282082311809063, 0.012745924293994904, 0.012471752241253853, 0.012595107778906822, 0.013325979933142662, 0.014364592730998993, 0.011542932130396366, 0.016848936676979065, 0.01704513281583786, 0.016582630574703217, 0.01588401384651661, 0.014796227216720581], [0.2345544993877411, 0.18503887951374054, 0.11361153423786163, 0.061162929981946945, 0.034756775945425034, 0.023519054055213928, 0.019965918734669685, 0.019111592322587967, 0.019053181633353233, 0.018925866112113, 0.018972722813487053, 0.01940217614173889, 0.018748607486486435, 0.020711954683065414, 0.021902386099100113, 0.020800350233912468, 0.02644430100917816, 0.02479373663663864, 0.023542705923318863, 0.024197746068239212, 0.024781662970781326, 0.026001449674367905]], [[0.06556428968906403, 0.08408528566360474, 0.13152363896369934, 0.08345451205968857, 0.07635544240474701, 0.05138397216796875, 0.016046278178691864, 0.012065982446074486, 0.012074630707502365, 0.01204475574195385, 0.011650619097054005, 0.011635237373411655, 0.011255130171775818, 0.013589865528047085, 0.015591423027217388, 0.015999654307961464, 0.26614177227020264, 0.017021141946315765, 0.017960939556360245, 0.018194135278463364, 0.01870434172451496, 0.01852310076355934, 0.019133858382701874], [0.12164440751075745, 0.2327180802822113, 0.14629676938056946, 0.10515117645263672, 0.07702751457691193, 0.049883823841810226, 0.027318080887198448, 0.016938239336013794, 0.013931642286479473, 0.012947211042046547, 0.012958274222910404, 0.013137591071426868, 0.013042956590652466, 0.013194636441767216, 0.014003884047269821, 0.015285440720617771, 0.012305740267038345, 0.01812903583049774, 0.018154095858335495, 0.017608944326639175, 0.01678847335278988, 0.01540491171181202, 0.01612905040383339], [0.23597502708435059, 0.18382081389427185, 0.11086299270391464, 0.058247413486242294, 0.032521575689315796, 0.02203243598341942, 0.018992770463228226, 0.01844141073524952, 0.018357567489147186, 0.01827368140220642, 0.018418557941913605, 0.018897857517004013, 0.01832789182662964, 0.020264752209186554, 0.021463297307491302, 0.02046933025121689, 0.024711310863494873, 0.023042570799589157, 0.021577514708042145, 0.022395648062229156, 0.023060020059347153, 0.02453211508691311, 0.025313522666692734]], [[0.06542350351810455, 0.08380797505378723, 0.13084354996681213, 0.08271515369415283, 0.07578408718109131, 0.05099190026521683, 0.015598030760884285, 0.01130632683634758, 0.011242295615375042, 0.01120101660490036, 0.010895492509007454, 0.010928535833954811, 0.010663865134119987, 0.012805119156837463, 0.01462604384869337, 0.01503337174654007, 0.26494958996772766, 0.015911966562271118, 0.016546428203582764, 0.01677994802594185, 0.017323559150099754, 0.017348768189549446, 0.018086809664964676, 0.0191865935921669], [0.12211942672729492, 0.22902166843414307, 0.14228476583957672, 0.10182593017816544, 0.07461962848901749, 0.04865378141403198, 0.026903226971626282, 0.016726510599255562, 0.013819762505590916, 0.012884851545095444, 0.012886197306215763, 0.01304993312805891, 0.01294405572116375, 0.013134581968188286, 0.013946712017059326, 0.015197503380477428, 0.012315381318330765, 0.01799497939646244, 0.017884625121951103, 0.017282752320170403, 0.01647052727639675, 0.015139630995690823, 0.015855953097343445, 0.01703759841620922], [0.2313753068447113, 0.18268734216690063, 0.10958486050367355, 0.05672585964202881, 0.031225070357322693, 0.021007515490055084, 0.018112480640411377, 0.017627302557229996, 0.01751519739627838, 0.01742446795105934, 0.017591914162039757, 0.01805298775434494, 0.017506783828139305, 0.019327998161315918, 0.02045293338596821, 0.019494593143463135, 0.0238496046513319, 0.022212330251932144, 0.020767103880643845, 0.021591495722532272, 0.022245990112423897, 0.023768391460180283, 0.0245511531829834, 0.025301285088062286]], [[0.06633801758289337, 0.08421072363853455, 0.1283612847328186, 0.08075273036956787, 0.07447633892297745, 0.05104846507310867, 0.016007650643587112, 0.010944253765046597, 0.010531632229685783, 0.010204674676060677, 0.009910275228321552, 0.010013542138040066, 0.010036175139248371, 0.012103979475796223, 0.013779970817267895, 0.014199373312294483, 0.26394161581993103, 0.015053377486765385, 0.01510780118405819, 0.015534177422523499, 0.01624658703804016, 0.016689879819750786, 0.017545700073242188, 0.018037285655736923, 0.018924467265605927], [0.12348692864179611, 0.22295235097408295, 0.1358795464038849, 0.09877308458089828, 0.07389561086893082, 0.04920801520347595, 0.02759171836078167, 0.017149344086647034, 0.014108252711594105, 0.013000191189348698, 0.012824592180550098, 0.012860375456511974, 0.012595860287547112, 0.012888169847428799, 0.013621017336845398, 0.01457061804831028, 0.012105319648981094, 0.017418909817934036, 0.01726868748664856, 0.016677509993314743, 0.015962092205882072, 0.014859524555504322, 0.015613584779202938, 0.01668938621878624, 0.01799928955733776], [0.22319333255290985, 0.18145592510700226, 0.10876590013504028, 0.055758036673069, 0.0304243341088295, 0.020377539098262787, 0.017479540780186653, 0.016907375305891037, 0.016738075762987137, 0.01660880818963051, 0.01675991714000702, 0.017151588574051857, 0.016554374247789383, 0.018173303455114365, 0.019139498472213745, 0.018141161650419235, 0.02345774881541729, 0.021861452609300613, 0.020656783133745193, 0.021338580176234245, 0.021896298974752426, 0.023366183042526245, 0.024063840508461, 0.02458345890045166, 0.025146953761577606]], [[0.06648162007331848, 0.0844133049249649, 0.1287938952445984, 0.08043068647384644, 0.07387746125459671, 0.05009728670120239, 0.015244731679558754, 0.010151187889277935, 0.009744402952492237, 0.009450863115489483, 0.009221264161169529, 0.009340745396912098, 0.009401115588843822, 0.01132311299443245, 0.012881618924438953, 0.013298336416482925, 0.26288026571273804, 0.014104046858847141, 0.013986005447804928, 0.014341218397021294, 0.01501925103366375, 0.015582329593598843, 0.016550691798329353, 0.016991516575217247, 0.017761798575520515, 0.018631238490343094], [0.12267300486564636, 0.2216024398803711, 0.1331588327884674, 0.09621725231409073, 0.07184026390314102, 0.0479477234184742, 0.02697555162012577, 0.016749391332268715, 0.013777009211480618, 0.01271074078977108, 0.012532403692603111, 0.012581748887896538, 0.012279956601560116, 0.012609574943780899, 0.013316345401108265, 0.014174154959619045, 0.011895421892404556, 0.017023464664816856, 0.01676839217543602, 0.01614859513938427, 0.015458384528756142, 0.014421531930565834, 0.015149029903113842, 0.01617853343486786, 0.017428018152713776, 0.018382281064987183], [0.22008854150772095, 0.1794627606868744, 0.1074332520365715, 0.05447791516780853, 0.02927793376147747, 0.019357098266482353, 0.016509883105754852, 0.01596435159444809, 0.01577182114124298, 0.0156389307230711, 0.015809863805770874, 0.016180451959371567, 0.01566009595990181, 0.017144598066806793, 0.018054306507110596, 0.01715957373380661, 0.022561222314834595, 0.020993489772081375, 0.01979038491845131, 0.020506665110588074, 0.021071942523121834, 0.02261187508702278, 0.02333887293934822, 0.02385326474905014, 0.02444390580058098, 0.02683691680431366]], [[0.06694210320711136, 0.08468309044837952, 0.12856143712997437, 0.08028942346572876, 0.07345815002918243, 0.04998374357819557, 0.015109414234757423, 0.009879231452941895, 0.009488441050052643, 0.009138708934187889, 0.008813281543552876, 0.008810078725218773, 0.00877737533301115, 0.010588559322059155, 0.012048175558447838, 0.012417065910995007, 0.2619030177593231, 0.012998796999454498, 0.012666285037994385, 0.012943239882588387, 0.013580933213233948, 0.014184965752065182, 0.015220594592392445, 0.01566176302731037, 0.01638045534491539, 0.01716737262904644, 0.018304290249943733], [0.12238311022520065, 0.2151367962360382, 0.1275528222322464, 0.09206176549196243, 0.06923996657133102, 0.046899519860744476, 0.026785053312778473, 0.01667456328868866, 0.013765765354037285, 0.012750436551868916, 0.012618464417755604, 0.012744174338877201, 0.012445424683392048, 0.012827950529754162, 0.013495538383722305, 0.014266254380345345, 0.01192725170403719, 0.01697816699743271, 0.016719307750463486, 0.01612992025911808, 0.015461777336895466, 0.014408377930521965, 0.015142145566642284, 0.016261879354715347, 0.017486175522208214, 0.01831967569887638, 0.01951770670711994], [0.2155570238828659, 0.17825058102607727, 0.10663193464279175, 0.05338849127292633, 0.02827996388077736, 0.018507253378629684, 0.015749577432870865, 0.015265259891748428, 0.015087434090673923, 0.01496889814734459, 0.015162128955125809, 0.015512935817241669, 0.01500568725168705, 0.016408324241638184, 0.01725577935576439, 0.016389459371566772, 0.021534409373998642, 0.02006720006465912, 0.018887203186750412, 0.01957516372203827, 0.020110979676246643, 0.02163604646921158, 0.022335577756166458, 0.022813837975263596, 0.023384876549243927, 0.025743797421455383, 0.02649012580513954]], [[0.0677148848772049, 0.08626475930213928, 0.1312490850687027, 0.07975444942712784, 0.07202187925577164, 0.04831912741065025, 0.014156012795865536, 0.009045478887856007, 0.008713237941265106, 0.008439968340098858, 0.008215040899813175, 0.008230586536228657, 0.008234127424657345, 0.00994056835770607, 0.011322449892759323, 0.011723598465323448, 0.26105502247810364, 0.012285884469747543, 0.011666263453662395, 0.01184123381972313, 0.012447557412087917, 0.013201910071074963, 0.014351787976920605, 0.014622727409005165, 0.015101837925612926, 0.015655415132641792, 0.0166335329413414, 0.01779152639210224], [0.12288922071456909, 0.21421730518341064, 0.12392394244670868, 0.08885881304740906, 0.06684403866529465, 0.04548000171780586, 0.026217281818389893, 0.016451619565486908, 0.013592863455414772, 0.012618939392268658, 0.012483200058341026, 0.012609998695552349, 0.01226954534649849, 0.012667583301663399, 0.013301055878400803, 0.013918831013143063, 0.011865933425724506, 0.01671433262526989, 0.016181547194719315, 0.015513836406171322, 0.014921385794878006, 0.01396857388317585, 0.014692231081426144, 0.015711709856987, 0.016682326793670654, 0.017285015434026718, 0.018433943390846252, 0.019684938713908195], [0.21057114005088806, 0.1772000789642334, 0.10553044080734253, 0.0526120699942112, 0.027550779283046722, 0.0176763366907835, 0.014818577095866203, 0.01420489139854908, 0.013957539573311806, 0.013792049139738083, 0.013951675966382027, 0.014244775287806988, 0.013762989081442356, 0.015022234991192818, 0.015795353800058365, 0.014993363991379738, 0.020925112068653107, 0.019423957914114, 0.01830786094069481, 0.01902521774172783, 0.01958160102367401, 0.021181780844926834, 0.021897949278354645, 0.02229452319443226, 0.02288968488574028, 0.025357194244861603, 0.026113741099834442, 0.027317076921463013]]];
        var y_action = [[[0.34026750922203064, 0.6597150564193726, 1.7441307136323303e-05], [0.00010493435547687113, 0.0006286608404479921, 0.9992664456367493]], [[1.7411591670679627e-06, 0.9999982118606567, 1.8302721805588812e-13], [0.957456111907959, 2.6947447622660547e-05, 0.04251697286963463]], [[2.2968643520471232e-07, 0.9999997615814209, 1.4957392285462265e-14], [0.9636521935462952, 1.0091866897710133e-05, 0.03633766621351242]], [[8.333573475738376e-08, 0.9999998807907104, 5.587197879645869e-15], [0.964558482170105, 5.150095603312366e-06, 0.03543635457754135]], [[9.822757363053825e-08, 0.9999998807907104, 1.4640532506487482e-14], [0.9586408734321594, 4.475369223655434e-06, 0.04135466367006302]], [[1.1190203252908759e-07, 0.9999998807907104, 2.4360628599518104e-14], [0.9610118269920349, 4.551503025140846e-06, 0.038983628153800964]], [[3.657240483789792e-07, 0.9999996423721313, 9.326223739678299e-14], [0.9006185531616211, 3.6163662571198074e-06, 0.0993778258562088]], [[8.133020514833333e-07, 0.9999991655349731, 1.6524868767190531e-13], [0.8811488747596741, 1.1185074072272982e-05, 0.11883994936943054]], [[1.5556474863842595e-06, 0.9999984502792358, 2.4225955443102354e-13], [0.8505148887634277, 2.2975102183409035e-05, 0.14946205914020538]], [[3.034078645214322e-06, 0.9999970197677612, 4.3566544686082787e-13], [0.7917382717132568, 4.116624768357724e-05, 0.20822054147720337]], [[1.0345627742935903e-05, 0.9999896287918091, 1.6676638368851027e-12], [0.5815197825431824, 6.778862734790891e-05, 0.4184124767780304]], [[3.061433744733222e-05, 0.9999693632125854, 6.239688019743506e-12], [0.3551522493362427, 9.279877122025937e-05, 0.6447550058364868]], [[1.5550600437563844e-05, 0.9999845027923584, 4.8812668317077534e-12], [0.7289103865623474, 0.0007362670148722827, 0.27035337686538696]], [[0.00026030378649011254, 0.9997397065162659, 1.6426658644430603e-10], [0.17583344876766205, 0.0005651620449498296, 0.8236013650894165]], [[0.0031440225429832935, 0.9968559741973877, 6.613756653450764e-09], [0.024003900587558746, 0.0005539557314477861, 0.975442111492157]], [[0.002822925802320242, 0.9971771240234375, 1.4852622243211044e-08], [0.05628236010670662, 0.021254343912005424, 0.9224632978439331]], [[0.1090644896030426, 3.9266797102754936e-05, 0.8908962607383728], [0.0011736240703612566, 0.9988170862197876, 9.270115697290748e-06]], [[0.2715439796447754, 0.00011027896107407287, 0.7283456921577454], [0.0005849575391039252, 0.9994072914123535, 7.72897601564182e-06]], [[0.24600262939929962, 4.273225931683555e-05, 0.7539546489715576], [0.00045051026972942054, 0.9995456337928772, 3.846539584628772e-06]], [[0.28291329741477966, 5.4499418183695525e-05, 0.7170321345329285], [0.0004303563910070807, 0.9995657801628113, 3.7769541449961253e-06]], [[0.31666383147239685, 6.94682021276094e-05, 0.6832666993141174], [0.00039701213245280087, 0.999599277973175, 3.6611863833968528e-06]], [[0.2777135670185089, 0.0001060170543496497, 0.7221804261207581], [0.0006410821806639433, 0.999351441860199, 7.467822797480039e-06]], [[0.270779013633728, 0.00011875807831529528, 0.7291022539138794], [0.0006750033935531974, 0.9993177652359009, 7.2264374466612935e-06]], [[0.384918749332428, 0.00012023838644381613, 0.6149610280990601], [0.00027399102691560984, 0.9997237324714661, 2.269895276185707e-06]], [[0.45619380474090576, 0.00022899554460309446, 0.5435771942138672], [0.0002834486367646605, 0.999714195728302, 2.3401098587783054e-06]], [[0.4258204996585846, 0.0004140680830460042, 0.5737653374671936], [0.0004766666970681399, 0.9995180368423462, 5.378464265959337e-06]], [[0.46846073865890503, 0.0006535605643875897, 0.530885636806488], [0.0005916813970543444, 0.9994003772735596, 7.948593520268332e-06]], [[0.5408301949501038, 0.0009795508813112974, 0.45819035172462463], [0.0005460280226543546, 0.9994454979896545, 8.43959060148336e-06]], [[0.47150853276252747, 0.0012372295605018735, 0.5272542238235474], [0.0005913048516958952, 0.9993970394134521, 1.1661061762424652e-05]]]; // action probs
        var action =  [[0, 2], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 2], [1, 0], [1, 0], [1, 2], [1, 2], [1, 2], [2, 1], [2, 1], [2, 1], [0, 1], [0, 1], [2, 1], [2, 1], [0, 1], [0, 1], [0, 1], [0, 1], [2, 1], [2, 1]];
        var action_names = [['no-op', 'left', 'right'], ['no-op', 'up', 'down']];
        var x_values = [...Array(y_values.length).keys()];

        var y_entropy_plot = [];
        var y_values_plot = [];

        // Set marker for plots
        var entropy_marker = false;
        var value_marker = false;

        // Set the to be shown statistic
        var statistic_type = 'general'
        // Only used for the transformer plot to show the correct statistic with tab switching
        var statistic_plot_id = 0;
        // Hide statistic type button if there is no attention weights
        if(y_attention_weights.length == 0) stats_button.style.display = 'none';

        // Set the to be shown action_space(s) for the entropy plot
        var entr_selected_action_space = null;

        var is_multi_discrete = action[0].length != 1;
        var is_discrete = action[0].length == 1;

        // Reformat the data for the plots
        // Each function y - value should be stored in a separate array
        for(var j = 0; j < y_values[0].length; j++)
            for(var i = 0; i < y_values.length; i++)
                y_values_plot.push(y_values[i][j]);

        if(is_discrete) { // If action_space is discrete
          for(var j = 0; j < y_entropy[0].length; j++)
              for(var i = 0; i < y_values.length; i++)
                  y_entropy_plot.push(y_entropy[i][j]);
        }
        else { // If action_space is multi discrete
          for(var j = 0; j < y_entropy[0].length; j++) {
            var y_entropy_vals = [];
            for(var i = 0; i < y_entropy.length; i++) {
                y_entropy_vals.push(y_entropy[i][j]);
            }
            y_entropy_plot.push(y_entropy_vals);
          }
        }

        // Set action_names for distr. plot if it does not exist
        if(action_names == null){
          action_names = [];
          for(var i = 0; i < y_action[0].length; i++){
            for(var j = 0; j < y_action[0][0].length; j++)
              if(is_discrete){ // if action space is discrete
                action_names.push("action_" + String(j));
            }
            else { // if action space is multi_discrete
              var action_branch_names = []; // Names of the branches of the action space
              for(var j = 0; j < y_action[0][i].length; j++){
                action_branch_names.push("action_" + String(j));
              }
              action_names.push(action_branch_names);
            }     
          }
        }
        else{
          if(action[0].length == 1 && Array.isArray(action_names[0])){ // If action space is discrete and action_names is multi_discrete
            action_names = action_names[0]; // Set action_names to the first branch of the action space
          }
        }

        // Modify dropdown menu
        if(is_discrete){ // if action space is discrete
          document.getElementById("all").outerHTML=""; // remove dropdown option 'all'
        }
        else { // If action space is multi_discrete
          // Create dropdown menu for the entropy function
          var dropdown_content = document.getElementById("dropdown_content"); 
          for(var i = 0; i < action[0].length; i++){
            var entropy_dropdown_option = document.createElement("a");
            entropy_dropdown_option.innerHTML = "action_space_" + String(i);
            entropy_dropdown_option.setAttribute("href", "#");
            entropy_dropdown_option.setAttribute("onclick", "set_action_space(" + String(i) + ")");
            dropdown_content.appendChild(entropy_dropdown_option);
          }
        }

        window.addEventListener('load', () => {
          // Set video length to length - 0.9999 because the last frame is two seconds long
          video_length = video_player.duration - 0.9999;
          time_selector.setAttribute('max', video_length); // Set max value of time selector to video length

          video_player.addEventListener('timeupdate', timeListener); // Update time selector and plots when video is playing
          video_player.addEventListener('dblclick', function(e) {open_fullscreen(video_player);}); // Open video in fullscreen when video is double clicked
          video_player.playbackRate = 6; // Set video playback rate to frame rate
          reset(); // Reset video to start
        }, false);
      
      // Update video time if time selector is changed
      time_selector.addEventListener('input', () => {
          video_player.currentTime = time_selector.value
          pause();
          update();
      })

      // Add event manager for tab
      window.addEventListener('keydown', function(event) {
          if (event.key === 'Tab') {
              if (statistic_type == "transformer") {
                statistic_plot_id = (statistic_plot_id + 1) % 3;
                // Set action plot if statistic_plot_id is 0
                if(statistic_plot_id == 0){
                  // Update action plot
                  if(is_discrete) { // If action_space is discrete
                    set_bar_action_plot(y_action[step][0], action[step][0], action_names);
                  }
                  else { // If action_space is multi discrete
                      set_stacked_bar_action_plot(y_action[step], action[step], action_names);
                  }
                }
                // Set value plot if statistic_plot_id is 1
                if (statistic_plot_id == 1) {
                  set_scatter_line_plot('action_distr', "Value Function", y_values_plot, step, value_marker);
                }

              // Set entropy plot if statistic_plot_id is 2
              if (statistic_plot_id == 2) {
                  if(is_discrete) { // If action_space is discrete
                      set_scatter_line_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
                  else { // If action_space is multi discrete
                      set_scatter_lines_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
              }
          }
      }
    });

    // Show ground truth if checkbox is checked
    function show_ground_truth() {
        // Get the checkbox element by its ID
        var checkbox = document.getElementById("show_ground_truth");
        
        // Check if the checkbox is checked
        if (checkbox.checked) { // Show the ground truth
          if (video_id == render_id) video_id = render_gt_id;
          if (video_id == render_decoder_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else {
          if (video_id == render_gt_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_agent_id;
          set_video(video_path[video_id]);
        }
      }

    // Show decoder video if checkbox is checked
    function show_decoder_video() {
      var checkbox = document.getElementById("show_decoder_video");
      document.getElementById("show_agent_video").checked = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_decoder_id;
          if (video_id == render_gt_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_decoder_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide decoder video
          if (video_id == render_decoder_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Show agent video if checkbox is checked
    function show_agent_video() {
      var checkbox = document.getElementById("show_agent_video");
      document.getElementById("show_decoder_video").checked  = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_agent_id;
          if (video_id == render_gt_id) video_id = render_agent_gt_id;
          if (video_id == render_decoder_id) video_id = render_agent_id;
          if (video_id == render_decoder_gt_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide agent video
          if (video_id == render_agent_id) video_id = render_id;
          if (video_id == render_agent_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Set the video to the given path
    function set_video(path) {
        // Get video data to make the switch seamless
        var current_time = video_player.currentTime;
        var play_back_rate = video_player.playbackRate;
        var is_paused = video_player.paused;
        video_player.querySelector("source").src = path;
        // Reload video
        video_player.load();
        video_player.currentTime = current_time;
        video_player.playbackRate = play_back_rate;
        if(is_paused) pause();
        else play();
    }


      /**
      * Update time selector and plots when video is playing
      */
      function timeListener() {
        if(!video_player.paused) {
          update();
        } 
      }

      /**
      * Toggles button and video between playing and paused
      */
      function play_pause() {
        if(video_player.paused)
          play();
        else 
          pause();
      }

      /**
       * Returns to the previous frame step
       */
       function return_to_step() {
        video_player.currentTime = past_steps.pop();
        pause();
        update();
        gotostep_text.value = step;
        return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Updates the plots and time selector
       */
       function go_to_step(event) {
        if (event.keyCode === 13) {
          past_steps.push(step);
          video_player.currentTime = Number(gotostep_text.value);
          pause();
          update();
          gotostep_text.value = step;
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
        }
      }

      function set_video_speed(event) {
        if (event.keyCode === 13) {
          video_player.playbackRate = Number(video_speed.value);
        }
      }

      /**
       * Updates the plots and time selector
       */
       function top_scores() {
        if (event.keyCode === 13) update()
      }

      /**
      * Pauses video
      */
      function pause() {
          play_pause_button.innerHTML = "Play";
          video_player.pause();
      }

      /**
      * Plays the video
      */
      function play() {
          play_pause_button.innerHTML = "Pause";
          video_player.play();
      }

      /**
      * Resets the video and plots to the start
      */
      function reset() {
          video_player.currentTime = 0;
          past_steps.push(step);
          pause();
          update();
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the previous frame
      */
      function back() {
          video_player.currentTime = video_player.currentTime - tS_step_size
          pause();
          update();
          past_steps.push(step + 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the next frame
      */
      function next() {
          video_player.currentTime = video_player.currentTime + tS_step_size;
          pause();
          update();
          past_steps.push(step - 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Switches between general and transformer statistics
       */
       function statistic() {
        if (stats_button.innerHTML == "General") {
          statistic_type = "general";
          stats_button.innerHTML = "Transformer";
        }
        else if (stats_button.innerHTML == "Attention Scores") {
          statistic_type = "transformer";
          stats_button.innerHTML = "General";
        }
        update();
      }
      /**
      * Opens the video in fullscreen
      */
      function open_fullscreen(vid_elem) {
          if (vid_elem.requestFullscreen) {
              vid_elem.requestFullscreen();
          } else if (vid_elem.webkitRequestFullscreen) { /* Safari */
              vid_elem.webkitRequestFullscreen();
          } else if (vid_elem.msRequestFullscreen) { /* IE11 */
              vid_elem.msRequestFullscreen();
          }
          vid_elem.pause();
      }

      // Selects the action space for the entropy plot
      function set_action_space(spaces){
        if (spaces == 'all')
          entr_selected_action_space = null;
        else
          entr_selected_action_space = Number(spaces);
        update();
      }

      function marker(marker_id){
        if(marker_id == "entropy")
          entropy_marker = !entropy_marker;
        else if(marker_id == "value")
          value_marker = !value_marker;
        update();
      }

      /**
      * Updates the plots and time selector
      */
      function update()  {
        if(video_player.currentTime == Math.round(video_player.currentTime)) // If time t of video is a natural number then step is t - 1
              video_player.currentTime += 0.0001 // Add a small number to make sure that the step and the current time are the same
        if(video_player.currentTime > video_length) {
           video_player.currentTime = video_length;
           pause();
        } // Video can't go past the end
        time_selector.value = video_player.currentTime; // Update time selector
        step = Math.floor(video_player.currentTime); // Get step of video for plots

        // Update plots
        if (statistic_type == "general")
          render_general_statistics();
        else if (statistic_type == "transformer")
          render_transformer_statistics();

        if(statistic_type == "general") {
          // Reset plot id
          statistic_plot_id = 0;
          // Update action plot
          if(is_discrete) { // If action_space is discrete
            set_bar_action_plot(y_action[step][0], action[step][0], action_names);
          }
          else { // If action_space is multi discrete
              set_stacked_bar_action_plot(y_action[step], action[step], action_names);
          }
        }
      }

      /**
      * Renders the general statistics
      */
      function render_general_statistics() {
        // Disables the transformer statistics and enables the general statistics
          document.getElementById('transformer').style.display = 'none';
          document.getElementById('top_n_scores').style.display = 'none';
          document.querySelector('label[for="top_n_scores"]').style.display = 'none';
          document.getElementById('value_func').style.display = 'block';
          document.getElementById('entropy_func').style.display = 'block';
          document.getElementById('options').style.display = 'block';
        // Updates the plots
          set_scatter_line_plot('value_func', "Value Function", y_values_plot, step, value_marker);
          if(is_discrete) { // If action_space is discrete
              set_scatter_line_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
          else { // If action_space is multi discrete
              set_scatter_lines_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
        }
      
      /*
      * Renders the transformer statistics
      */
      function render_transformer_statistics() {
        // Disables the general statistics and enables the transformer statistics
        document.getElementById('transformer').style.display = 'block';
        document.getElementById('top_n_scores').style.display = 'block';
        document.querySelector('label[for="top_n_scores"]').style.display = 'block';
        document.getElementById('value_func').style.display = 'none';
        document.getElementById('entropy_func').style.display = 'none';
        document.getElementById('options').style.display = 'none';
        // Updates the plots
        var top_n = Number(top_n_scores.value);
        if (top_n == -1) top_n = step;
        visualizeAttentionScores(y_attention_weights[step], top_n);
        }


      /**
       * Renders attention scores
      */
      async function visualizeAttentionScores(attentionScores, n_values) {
        const numHeads = attentionScores.length;
        
        let data = [];
        let layout = {
          grid: {
              rows: numHeads, 
              columns: 1, 
              pattern: 'independent',
              subplots: [...Array(numHeads).keys()].map(i => `xy${i + 1}`),
              ygap: 0.4 // adjust this value according to your preference
          },
          plot_bgcolor: '#000',
          paper_bgcolor: '#000',
          font: {
              family: 'Montserrat',
              size: 12,
              color: '#fff'
          },
          margin: {
              t: 0,  // reduce top margin
          },
      }

        // Flatten the array to find the max value across all arrays
        let flatScores = attentionScores.flat();
        let maxScore = Math.max(...flatScores);

        // Iterate through each attention head
        for (let headIdx = 0; headIdx < numHeads; headIdx++) {
            // Get attention scores for the current head
            let headScores = attentionScores[headIdx];
            
            // This array will keep up to the 10 highest scores
            let topScores = [];

            for (let i = 0; i < headScores.length; i++) {
                // Insert current score into the top scores array
                topScores.push({score: headScores[i], index: i});
                
                // Sort the top scores array
                topScores.sort((a, b) => b.score - a.score);

                // If there are more than 10 scores, remove the smallest
                if (topScores.length > n_values) {
                    topScores.pop();
                }
            }

            // Sort the topScores array by index
            topScores.sort((a, b) => a.index - b.index);

            // Now topScores contains the top 10 scores sorted by their indices.
            // You can extract the scores and their indices into separate arrays:
            let filteredHeadScores = topScores.map(x => x.score);
            let filteredTicks = topScores.map(x => x.index);


            const sequenceLength = filteredHeadScores.length;

            layout.height = 400;
            layout.width = window.innerWidth;

            const headScoresPlot = {
                z: [filteredHeadScores],
                type: 'heatmap',
                showscale: true,  
                colorscale: 'Hot',
                zmin: 0,
                zmax: maxScore,
                xaxis: `x${headIdx + 1}`,
                yaxis: `y${headIdx + 1}`,
            };

            data.push(headScoresPlot);

            layout[`xaxis${headIdx + 1}`] = {
                tickmode: 'array',
                tickvals: Array.from({length: sequenceLength}, (_, i) => i),
                ticktext: filteredTicks
            };

            layout[`yaxis${headIdx + 1}`] = {
                title: `Block ${headIdx + 1}`,
                ticks: 'outside',
                tick0: 0,
                dtick: 1,
                ticklen: 8,
                tickwidth: 4,
                tickcolor: '#000'
            };
        }

        const config = {responsive: true};

        Plotly.newPlot('transformer', data, layout, config).then(function() {
          var myPlot = document.getElementById('transformer');
          myPlot.on('plotly_click', function(data){
            // Jump to the step that was clicked
              past_steps.push(step);
              video_player.currentTime = Number(data.points[0].xaxis.ticktext[data.points[0].x]);
              pause();
              update();
              return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      });
    }

      /** 
      * Sets a stacked bar plot for the multi discrete action distribution
      * @param {array} y_values - The action distribution
      * @param {array} action - The action
      * @param {array} action_names - The names of the actions
      */
      function set_stacked_bar_action_plot(y_values, action, action_names) {
        var bar_plot_data_action = [];
        // Set data for each action
        for(var j = 0; j < action_names[0].length; j++) {
            var color = ""
            for(var i = 0; i < action_names.length; i++) {
                if(action[i] == j) // If action sampled in the current frame
                    color = '#FF0000'; // Color it red
                else
                    color = '#FAEBD7'; // Color it white
                var trace = {
                    x: [["action_space_", String(i)].join("")],
                    y: [y_values[i][j]],
                    text: [y_values[i][j], action_names[i][j]].map(String).join("<br>"), // Add action name and prob to the bar
                    marker: {
                        color: color,
                        line: {
                            color: '#000000',
                            width: 1
                          }
                    },
                    type: 'bar'
                };
                bar_plot_data_action.push(trace);
            }
        }

        // Set layout for the plot
        var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            barmode: 'stack',
            showlegend: false
      };

      // Plot the data
      Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }

      /**
      * Sets a bar plot for the discrete action distribution
      */
      function set_bar_action_plot(y_values, action, action_names) {

          var color_value = new Array(y_values.length).fill('#FAEBD7'); // Set color for all actions to white
          color_value[action] = '#FF0000'; // Except the selected action should be red
          // Set data for the plot
          var bar_plot_data_action = [
              {
                  x: action_names,
                  y: y_values,
                  type: 'bar',
                  marker: {
                      color: color_value
                  },
                  textposition: 'auto',
                  text: y_values.map(String), // Add prob to the bar plot
                  textfont: {
                      family: 'Montserrat',
                      size: 12,
                  },
                  textangle: 0,
                  textposition: 'bottom center',
              }
          ];

          // Set layout for the plot
          var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            yaxis: {
              automargin: true,
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            }
      };
          
          // Plot the action distribution
          Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }


      /**
      * Sets a scatter plot for the emtropy function if multi discrete actions are used
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The entropy function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_lines_plot(id, title, y_values, step, marker) {
        line_scatter_plot_data_value = [];

        // Set colors and data for the plot
        var colors = ['#FAEBD780', '#7CFC0080', '#FFBF0080', '#FF7F5080', '#DE316380', '#9FE2BF80', '#40E0D080', '#6495ED80', '#CCCCFF80']
        for(var i = 0; i < y_values.length; i++) {
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values[i].slice(0, step + 1);
            var trace = [
            {
                x: x_values_marker,
                y: y_values_marker,
                mode: 'line',
                line: {
                    color: colors[i]
                },
                name: 'action_space_' + String(i),
                showlegend: true,
            },
            {
                x: x_values,
                y: y_values[i],
                mode: 'markers',
                name: 'action_space_' + String(i) + "_marker",
                marker: {
                    color: colors[i]
                },
                showlegend: true,
            }
        ];
            // Add data to the plot
            line_scatter_plot_data_value.push(trace[0]);
            if(marker)
              line_scatter_plot_data_value.push(trace[1]); 
        }

        // Select the selected action_space for the entropy plot
        if(entr_selected_action_space != null && marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space * 2], line_scatter_plot_data_value[entr_selected_action_space * 2 + 1]];
        else if(entr_selected_action_space != null && !marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space]];

        // Set layout for the plot
        var line__scatter_plot_layout_value = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 50,
                r: 0,
                b: 30,
                t: 25,
                pad: 4
                },
            yaxis: {
                automargin: true
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: title,
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            showlegend: true,
        };

        // Plot the data
        Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);
        // Add event handler for clicking on a marker
        document.getElementById(id).on('plotly_click', function(data){
            past_steps.push(step);
            video_player.currentTime = Number(data.points[0].x);
            pause();
            update();
            return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      }


      /**
      * Sets a scatter plot for the value function
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The value function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_line_plot(id, title, y_values, step, marker) {
          // Set data for layout for the plot
          var line__scatter_plot_layout_value = {
              autosize: true,
              width: 600,
              height: 360,
              margin: {
                  l: 50,
                  r: 0,
                  b: 30,
                  t: 25,
                  pad: 4
                  },
              yaxis: {
                  automargin: true
              },
              plot_bgcolor: '#000',
              paper_bgcolor: '#000',
              font: {
                  family: 'Montserrat',
                  size: 12,
                  color: '#fff'
              },
              title: {
                  text: title,
                  font: {
                      family: 'Montserrat',
                      size: 15,
                      color: '#fff'
                  }
              },
              showlegend: false,
          };

          // Set data for the plot
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values.slice(0, step + 1);

          var line_scatter_plot_data_value = [
              {
                  x: x_values_marker,
                  y: y_values_marker,
                  mode: 'line',
                  line: {
                      color: '#FAEBD7'
                  },
                  name: 'function',
              },
              {
                  x: x_values,
                  y: y_values,
                  mode: 'markers',
                  marker: {
                      color: '#7CFC0080'
                  },
                  name: 'marker',
              }
          ];

          if(!marker)
            line_scatter_plot_data_value = [line_scatter_plot_data_value[0]];

          // Plot the value function
          Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);

          // Add event handler for clicking on a marker
          document.getElementById(id).on('plotly_click', function(data){
            past_steps.push(step);
            video_player.currentTime = Number(data.points[0].x);
            pause();
            update();
            return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      }
    
    /**
    * Opens the specific tab based on the probided id
    * @param {string} id - The id of the tab
    */
    function openTab(evt, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        mediatabcontent = document.getElementsByClassName("mediatabcontent");
        // Hide all elements with class="tabcontent" and "mediacontent" by default
        for (i = 0; i < mediatabcontent.length; i++) {
            mediatabcontent[i].style.display = "none";
        }
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        // Show the specific tab content
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(id).style.display = "block";
        evt.currentTarget.className += " active";
      }
    </script>
  </body>
</html>