<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;500&display=swap" rel="stylesheet"/>
    <script src="template/cdn.plot.ly_plotly-2.6.3.min.js"></script>
    <style>
     /* Style the body */
      html, body {
        height: 100%;
        margin: 0;
        background-color: #000;
        color: white;
        font-family: "Montserrat", sans-serif;
        min-width: 1737px;
      }

      /* Set the width and hight of the video*/
      video {
        width: 600px;
        height: 400px;
      }

      /* Style the timeline text*/
      #selector_header {
        font-weight: 200;
      }

      /* Buttons should be displayed in a row */
      buttonrow {
        display: inline;
      }

      /* Style the figures */
      #figures {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        flex-flow: row nowrap;
      }

      /* Style the tab */
      .tab {
        overflow: hidden;
        background-color: #54595f;
      }

      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
        color: white;
      }

      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #909090;
      }

      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #838383;
      }

      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border-top: none;
        background-color: #000;
      }

      .mediatabcontent {
        display: none;
        padding: 0 px 0 px;
        border-top: none;
        background-color: #000;
        width: 100%;
        height: 100%;
      }

      /* Style the close button */
      .topright {
        float: right;
        cursor: pointer;
        font-size: 28px;
      }

      .topright:hover {
        color: red;
      }

      /* Style of the dropdown button */
      .dropbtn {
        background-color: #17202A;
        color: white;
        padding: 16px;
        font-size: 16px;
        border: none;
      }
      
      .dropdown {
        position: absolute;
        display: inline-block;
      }
      
      /* Style of the dropdown content */
      .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        background-color: #A6ACAF;
        z-index: 1;
      }
      
      .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
      }

      .gotostepcontainer {
          margin-bottom: 10px;
      }
      
      #score-container label, #score-container input {
        display: inline-block;
      }

      /* Style of the dropdown at hover */
      .dropdown-content a:hover {background-color: #ddd;}
      
      .dropdown:hover .dropdown-content {display: block;}
      
      .dropdown:hover .dropbtn {background-color: #161515;}
    </style>
  </head>
  <body>
    <!--- Define tabs -->
    <div class="tab">
      <button class="tablinks" onclick="location.href='../index.html'">Back</button>
      <button class="tablinks" onclick="openTab(event, 'Environment')">Environment</button>
      <button class="tablinks" onclick="openTab(event, 'Sampler')">Sampler</button>
      <button class="tablinks" onclick="openTab(event, 'Hyperparameters')">Hyperparameters</button>
      <button class="tablinks" onclick="openTab(event, 'Model')">Model</button>
      <button class="tablinks" onclick="openTab(event, 'Media')" id="defaultOpen">Media</button>
    </div>

    <!--- Define tab content -->
    <div id="Environment" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>type</b>: MemoryGym<br><b>name</b>: SearingSpotlights-v0<br><b>frame_skip</b>: 1<br><b>last_action_to_obs</b>: False<br><b>last_reward_to_obs</b>: False<br><b>obs_stacks</b>: 1<br><b>grayscale</b>: False<br><b>resize_vis_obs</b>: [84, 84]<br><b>positional_encoding</b>: False<br><b>reset_params</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>start-seed</b>: 200003<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num-seeds</b>: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_steps</b>: 256<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial_spawns</b>: 4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_spawns</b>: 30<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial_spawn_interval</b>: 30<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spawn_interval_threshold</b>: 10<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spawn_interval_decay</b>: 0.95<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_min_radius</b>: 7.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_max_radius</b>: 13.75<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_min_speed</b>: 0.0025<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_max_speed</b>: 0.0075<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>spot_damage</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>visual_feedback</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>black_background</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hide_chessboard</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>light_dim_off_duration</b>: 6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>light_threshold</b>: 255<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_coins</b>: [1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>coin_scale</b>: 0.375<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>coins_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>use_exit</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>exit_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>exit_scale</b>: 0.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_speed</b>: 3.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_health</b>: 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_scale</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_visible</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>sample_agent_position</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>show_last_action</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>show_last_positive_reward</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_inside_spotlight</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_outside_spotlight</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_death</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_exit</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_max_steps</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_coin</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>seed</b>: 200003<br><b>reward_normalization</b>: 0<br>
    </div>

    <div id="Model" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>load_model</b>: False<br><b>model_path</b>: <br><b>checkpoint_interval</b>: 500<br><b>activation</b>: relu<br><b>vis_encoder</b>: cnn<br><b>vec_encoder</b>: linear<br><b>num_vec_encoder_units</b>: 128<br><b>hidden_layer</b>: default<br><b>num_hidden_layers</b>: 1<br><b>num_hidden_units</b>: 384<br><b>transformer</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_blocks</b>: 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>embed_dim</b>: 384<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_heads</b>: 4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>memory_length</b>: 256<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>positional_encoding</b>: absolute<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>layer_norm</b>: pre<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>init_weights</b>: xavier<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl_bias</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>gtrxl_swap</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>share_heads</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_episode_steps</b>: 257<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>add_positional_encoding_to_query</b>: False<br><b>obs_decoder</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>attach_to</b>: memory<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>detach_gradient</b>: False<br>
    </div>

    <div id="Sampler" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>n_workers</b>: 32<br><b>worker_steps</b>: 512<br>
    </div>

    <div id="Hyperparameters" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>algorithm</b>: PPO<br><b>resume_at</b>: 0<br><b>gamma</b>: 0.995<br><b>lamda</b>: 0.95<br><b>updates</b>: 30000<br><b>epochs</b>: 3<br><b>refresh_buffer_epoch</b>: -1<br><b>n_mini_batches</b>: 8<br><b>advantage_normalization</b>: no<br><b>value_coefficient</b>: 0.5<br><b>max_grad_norm</b>: 0.25<br><b>share_parameters</b>: True<br><b>learning_rate_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.000275<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-05<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 20000<br><b>beta_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.0001<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-06<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 20000<br><b>clip_range_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>obs_reconstruction_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 1000<br><b>ground_truth_estimator_schedule</b>: {'initial': 0.0}<br>
    </div>

    <div id="Media" class="mediatabcontent">
      <br>
      <center>
        <div id="figures" style="display: flex; flex-direction: column;">
          <div style="display: flex; flex-direction: row;">
            <div style="display: flex; flex-direction: column;">
              <div style="display: flex; flex-direction: row;">
                <label for="video_speed">Frame Rate: </label>
                <input type="text" id="video_speed" size="3" value="6" onkeydown="set_video_speed(event)">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_ground_truth">Show Ground Truth Estimation</label>
                <input type="checkbox" id="show_ground_truth" onclick="show_ground_truth()">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_decoder_video">Show Decoder Video</label>
                <input type="checkbox" id="show_decoder_video" onclick="show_decoder_video()">
              </div>

            <div style="display: flex; flex-direction: row;">
              <label for="show_agent_video">Show Agent Video</label>
              <input type="checkbox" id="show_agent_video" onclick="show_agent_video()">
            </div>
          </div>
          
            <div>
              <video id="video_player">
                <source src="" type="video/webm" />
              </video>
            </div>
            <div id="action_distr"></div>
          </div>
        </div>

        <br>
        <!-- Set buttons to control the figures -->
        <div class="gotostepcontainer">
          <label for="gotostep_text">Step:</label>
          <input type="text" id="gotostep_text" size="3" value="0" onkeydown="go_to_step(event)">
          <button id="return_button" type="return_button" onclick="return_to_step()">Return to step 0</button>
        </div>
        <buttonrow>
          <button id="play_pause_button" onclick="play_pause()" style="width:53px">Play</button>
          <button id="reset_button" onclick="reset()">Reset</button>
          <button id="back_button" onclick="back()">Back</button>
          <button id="next_button" onclick="next()">Next</button>
          <button id="stats_button" onclick="statistic()">Attention Scores</button>
        </buttonrow>
        <br>
        <!-- Set slider to control the figures -->
        <input id="time_selector" type="range" min="0" max="100" step="1" value="0" style="width: 300px;"/>

        <!-- Set transformer plot -->
        <div id="score-container">
          <label for="top_n_scores">Number of Top Attention Scores:</label>
          <input type="text" id="top_n_scores" size="3" value="-1" onkeydown="top_scores()">
        </div>
        <div id="transformer"></div>

        <!-- Set value plot and entropy plot -->
        <div id="figures">
          <div id="value_func"></div>
          <div id="entropy_func"></div>
          <!-- Dropdown button with some options-->
          <div class="dropdown" id="options">
            <button class="dropbtn">Options</button>
            <div class="dropdown-content" id="dropdown_content">
              <a href ="#" onclick="marker('value')">value_marker_toggle</a>
              <a href ="#" onclick="marker('entropy')">entropy_marker_toggle</a>
              <a href="#" id="all" onclick="set_action_space('all')">All</a>
            </div>
          </div>
        </div>
      </center>
    </div>

    <script>
        // Set active tab
        document.getElementById("defaultOpen").click();

        // Set video player
        const video_player = document.getElementById("video_player");
        const video_speed = document.getElementById("video_speed");
        const video_path = ['videos/video_seed_200003_166.webm', '', 'videos/video_seed_200003_167.webm', '', 'videos/video_seed_200003_168.webm', ''];
        var render_id = 0; var render_gt_id = 1; var render_decoder_id = 2; var render_decoder_gt_id = 3; var  render_agent_id = 4; var render_agent_gt_id = 5;
        var video_id = 0;
        // Hide video player if there is no ground truth video
        if (video_path[render_gt_id].length == 0 && video_path[render_decoder_gt_id].length == 0 && video_path[render_agent_gt_id].length == 0){
          document.querySelector('label[for="show_ground_truth"]').style.display = 'none';
          document.getElementById("show_ground_truth").style.display = 'none';
        } 
        if (video_path[render_decoder_id].length == 0){
          document.querySelector('label[for="show_decoder_video"]').style.display = 'none';
          document.getElementById("show_decoder_video").style.display = 'none';
        }
        if (video_path[render_agent_id].length == 0){
          document.querySelector('label[for="show_agent_video"]').style.display = 'none';
          document.getElementById("show_agent_video").style.display = 'none';
        }

        video_player.querySelector("source").src = video_path[0];
        video_player.load();
        var video_length = 0;

        // Play and pause button
        const play_pause_button = document.getElementById("play_pause_button");

        // Set step input
        const gotostep_text = document.getElementById('gotostep_text');
        var past_steps = [0];
        var step = 0;

        // Set number of scores input
        const top_n_scores = document.getElementById('top_n_scores');

        // Const stats button
        const stats_button = document.getElementById("stats_button");

        // Set time selector
        const time_selector = document.getElementById('time_selector');
        var tS_step_size = 1.0;

        // Set values for the plots
        var y_values = [[1.1311209201812744], [1.0869240760803223], [1.0676466226577759], [1.0876033306121826], [1.0840100049972534], [1.0968828201293945], [1.112868070602417], [1.1248091459274292], [1.1344560384750366], [1.1441349983215332], [1.149449110031128], [1.1532177925109863], [1.158187985420227], [1.1609411239624023], [1.1609991788864136], [1.1482096910476685], [1.1086692810058594], [1.043619990348816], [0.9405142068862915], [0.9379314184188843], [0.9387671947479248], [0.9421833753585815], [0.9456278085708618], [0.9524507522583008], [0.9561189413070679], [0.9624118804931641], [0.9653431177139282], [0.9716099500656128], [0.9773765802383423], [0.983232855796814], [0.9878652095794678], [0.9895592927932739]];
        var y_entropy = [[0.02712184190750122, 0.0015589137328788638], [0.06628384441137314, 0.6677523255348206], [0.00038351406692527235, 0.6044015288352966], [2.2221687686396763e-05, 0.0612712986767292], [9.724802112032194e-06, 0.06774506717920303], [9.88004649116192e-06, 0.06562672555446625], [1.2320749192440417e-05, 0.05967188626527786], [9.002866136142984e-06, 0.08507951349020004], [9.983222298615146e-06, 0.08383432775735855], [1.547561441839207e-05, 0.10028412193059921], [2.5391958843101747e-05, 0.11743614822626114], [4.102961247554049e-05, 0.13739410042762756], [7.289867789950222e-05, 0.1699226200580597], [0.00014679871674161404, 0.21605949103832245], [0.0003537601151037961, 0.2963162660598755], [0.0013495967723429203, 0.4735774099826813], [0.00951432716101408, 0.7369980216026306], [0.0756991058588028, 0.6558557748794556], [0.4804694652557373, 0.007136990316212177], [0.4806734323501587, 0.0055073644034564495], [0.5868620276451111, 0.010356013663113117], [0.625357985496521, 0.010426906868815422], [0.6605281829833984, 0.011120839044451714], [0.6853883862495422, 0.01188365276902914], [0.6813637018203735, 0.00640127994120121], [0.6854966282844543, 0.006398218218237162], [0.6953653693199158, 0.007042114157229662], [0.654478132724762, 0.015363344922661781], [0.6299363374710083, 0.018357260152697563], [0.6963478922843933, 0.00911130290478468], [0.6987902522087097, 0.011558725498616695], [0.7029482126235962, 0.014850360341370106]];
        var y_attention_weights = [[[], [], []], [[1.0], [1.0], [1.0]], [[0.3878396451473236, 0.612160325050354], [0.27952268719673157, 0.720477283000946], [0.631678581237793, 0.3683214485645294]], [[0.207472026348114, 0.24973446130752563, 0.5427935123443604], [0.18180544674396515, 0.44898954033851624, 0.36920493841171265], [0.4696688652038574, 0.2933492064476013, 0.23698194324970245]], [[0.15123741328716278, 0.1712760627269745, 0.2611100673675537, 0.4163764715194702], [0.13358867168426514, 0.3527548611164093, 0.26955947279930115, 0.24409699440002441], [0.3648934066295624, 0.2594665586948395, 0.20826302468776703, 0.16737696528434753]], [[0.12068980932235718, 0.1367117464542389, 0.20221716165542603, 0.22589993476867676, 0.31448137760162354], [0.1087026447057724, 0.3227836787700653, 0.23753514885902405, 0.2082808017730713, 0.12269777804613113], [0.31913071870803833, 0.22980432212352753, 0.18272070586681366, 0.14586125314235687, 0.12248291075229645]], [[0.10324287414550781, 0.11935798078775406, 0.18586161732673645, 0.20304721593856812, 0.25916531682014465, 0.12932506203651428], [0.09593863040208817, 0.3005266785621643, 0.22351865470409393, 0.19902819395065308, 0.11994171887636185, 0.06104607880115509], [0.294231116771698, 0.20887650549411774, 0.16352741420269012, 0.13024598360061646, 0.10845652967691422, 0.09466246515512466]], [[0.0926041305065155, 0.11000147461891174, 0.1773327887058258, 0.18743273615837097, 0.25925135612487793, 0.1188378632068634, 0.05453971028327942], [0.09582200646400452, 0.2820184528827667, 0.2191212922334671, 0.19817666709423065, 0.11952172964811325, 0.06003783643245697, 0.025302015244960785], [0.2769944667816162, 0.19532619416713715, 0.1510552614927292, 0.11907629668712616, 0.09784546494483948, 0.08449407666921616, 0.07520826160907745]], [[0.0861811712384224, 0.10294234752655029, 0.17020617425441742, 0.17924347519874573, 0.25128743052482605, 0.1102711483836174, 0.043805964291095734, 0.056062258780002594], [0.09747455269098282, 0.2842087149620056, 0.2175600230693817, 0.19440987706184387, 0.11406458914279938, 0.054907940328121185, 0.022004609927535057, 0.015369627624750137], [0.26628705859184265, 0.18772821128368378, 0.1421465277671814, 0.10997200012207031, 0.08876015990972519, 0.07559286057949066, 0.06679772585630417, 0.06271542608737946]], [[0.08171176165342331, 0.09802667796611786, 0.16520540416240692, 0.17353838682174683, 0.2457505315542221, 0.10434843599796295, 0.036402951925992966, 0.04538917541503906, 0.0496266633272171], [0.0975540429353714, 0.28588032722473145, 0.2158464640378952, 0.1909492462873459, 0.11034964770078659, 0.05189383402466774, 0.02030373178422451, 0.014171205461025238, 0.013051480986177921], [0.2571139931678772, 0.18078672885894775, 0.13514213263988495, 0.103061243891716, 0.08186852931976318, 0.06878522783517838, 0.060316380113363266, 0.05654159188270569, 0.056384168565273285]], [[0.07852645218372345, 0.09451957046985626, 0.1615990847349167, 0.16945883631706238, 0.24179145693778992, 0.1001589223742485, 0.03119191899895668, 0.03787985071539879, 0.04139212518930435, 0.043481774628162384], [0.09716248512268066, 0.28667163848876953, 0.21392303705215454, 0.18797771632671356, 0.10727677494287491, 0.049508556723594666, 0.01906515285372734, 0.013293326832354069, 0.012325087562203407, 0.01279617939144373], [0.2500675320625305, 0.17522932589054108, 0.12952513992786407, 0.0974477156996727, 0.0762069895863533, 0.06323087215423584, 0.055055588483810425, 0.05154374986886978, 0.0512605682015419, 0.05043250322341919]], [[0.07620816677808762, 0.09196335822343826, 0.1589323878288269, 0.16647236049175262, 0.23888711631298065, 0.09713702648878098, 0.027462882921099663, 0.03250981494784355, 0.0355035625398159, 0.03729116916656494, 0.03763214871287346], [0.09645737707614899, 0.2867679297924042, 0.21172696352005005, 0.18518558144569397, 0.10445351898670197, 0.047361087054014206, 0.01796869933605194, 0.012502092868089676, 0.011658607050776482, 0.012158816680312157, 0.013759334571659565], [0.24404500424861908, 0.17040090262889862, 0.12481217086315155, 0.09292919188737869, 0.07173946499824524, 0.05889781191945076, 0.050937943160533905, 0.047542545944452286, 0.04716300219297409, 0.04632588103413582, 0.04520609229803085]], [[0.07443743944168091, 0.0900077149271965, 0.1568593680858612, 0.1641758680343628, 0.23664814233779907, 0.094852015376091, 0.024669382721185684, 0.028490260243415833, 0.031095946207642555, 0.03265749290585518, 0.03296055644750595, 0.033145833760499954], [0.09570194780826569, 0.2861475646495819, 0.20907407999038696, 0.1821962296962738, 0.10180985182523727, 0.045432258397340775, 0.01700441725552082, 0.011800248175859451, 0.011056946590542793, 0.011569414287805557, 0.013157734647393227, 0.01504930667579174], [0.2383459061384201, 0.16587257385253906, 0.12069430947303772, 0.08919034153223038, 0.06816305965185165, 0.05547317862510681, 0.04771240055561066, 0.0443606860935688, 0.043917253613471985, 0.04307495057582855, 0.041975438594818115, 0.04121990129351616]], [[0.0729861706495285, 0.08840286731719971, 0.1551356315612793, 0.16228653490543365, 0.2348080724477768, 0.09299884736537933, 0.022418323904275894, 0.02525341883301735, 0.027546660974621773, 0.028926193714141846, 0.02919870987534523, 0.02936563454568386, 0.030672883614897728], [0.09522981941699982, 0.2846219837665558, 0.20576849579811096, 0.17889061570167542, 0.0993833988904953, 0.043790966272354126, 0.01621163822710514, 0.011226845905184746, 0.01056587789207697, 0.01107794139534235, 0.01264125294983387, 0.014614798128604889, 0.015976278111338615], [0.2333713173866272, 0.1613902747631073, 0.11694128066301346, 0.08594503998756409, 0.06516357511281967, 0.05260644108057022, 0.04503367841243744, 0.04174979776144028, 0.041256263852119446, 0.04040912538766861, 0.039328303188085556, 0.03858662396669388, 0.03821824491024017]], [[0.07172075659036636, 0.08700250089168549, 0.1536186933517456, 0.16063618659973145, 0.23320399224758148, 0.09139548242092133, 0.02047778107225895, 0.022464344277977943, 0.024488389492034912, 0.025711096823215485, 0.025957291945815086, 0.0261083971709013, 0.02726294845342636, 0.02995208650827408], [0.095071941614151, 0.28182485699653625, 0.2016233205795288, 0.17520910501480103, 0.09733222424983978, 0.04258579760789871, 0.01564728654921055, 0.010809110477566719, 0.010210521519184113, 0.010706916451454163, 0.012228328734636307, 0.014265540987253189, 0.01584627665579319, 0.016638770699501038], [0.22865690290927887, 0.15689657628536224, 0.11349867284297943, 0.0831240862607956, 0.06265416741371155, 0.05019013583660126, 0.04277462512254715, 0.039597757160663605, 0.03904551640152931, 0.03818276524543762, 0.037120696157217026, 0.036398835480213165, 0.03602936118841171, 0.035829897969961166]], [[0.07058675587177277, 0.0857468694448471, 0.15224973857402802, 0.15915162861347198, 0.23175761103630066, 0.08996345102787018, 0.01875310204923153, 0.019986523315310478, 0.02177143655717373, 0.02285482920706272, 0.023077640682458878, 0.023214690387248993, 0.02423359453678131, 0.026606764644384384, 0.030045343562960625], [0.0948362722992897, 0.2774811387062073, 0.19648730754852295, 0.17117944359779358, 0.09534971415996552, 0.04164764657616615, 0.015303164720535278, 0.010571161285042763, 0.010026060044765472, 0.010492665693163872, 0.011958767659962177, 0.014051566831767559, 0.015870537608861923, 0.016934309154748917, 0.017810318619012833], [0.2226450890302658, 0.151363343000412, 0.11012929677963257, 0.08075426518917084, 0.06075461953878403, 0.04838671535253525, 0.041082724928855896, 0.03803572803735733, 0.037436991930007935, 0.036560945212841034, 0.03550947457551956, 0.034796230494976044, 0.03441118821501732, 0.03419577330350876, 0.03393763303756714]], [[0.06957762688398361, 0.08462845534086227, 0.1510196030139923, 0.1578150987625122, 0.2304374724626541, 0.0886860191822052, 0.017233848571777344, 0.01780529133975506, 0.01937972567975521, 0.020340487360954285, 0.020542705431580544, 0.02066737413406372, 0.021566884592175484, 0.023661941289901733, 0.0267009399831295, 0.02993655763566494], [0.09441883116960526, 0.272366464138031, 0.19112038612365723, 0.167058065533638, 0.09333653748035431, 0.040713123977184296, 0.014966750517487526, 0.010311289690434933, 0.009802361950278282, 0.010224498808383942, 0.011612936854362488, 0.013723019510507584, 0.015739958733320236, 0.017056388780474663, 0.018050629645586014, 0.019498761743307114], [0.21561363339424133, 0.14549468457698822, 0.1068292036652565, 0.07864899188280106, 0.05923844873905182, 0.047017574310302734, 0.03983797878026962, 0.03685269132256508, 0.03620234504342079, 0.03531024605035782, 0.03426440432667732, 0.03355100005865097, 0.033137112855911255, 0.03288876265287399, 0.032601311802864075, 0.0325116291642189]], [[0.0686986967921257, 0.08365261554718018, 0.14993014931678772, 0.1566171497106552, 0.22921036183834076, 0.08755745738744736, 0.015931129455566406, 0.015937434509396553, 0.017331689596176147, 0.018187450245022774, 0.01837201789021492, 0.01848607324063778, 0.019283369183540344, 0.021140320226550102, 0.02383721061050892, 0.026714002713561058, 0.029112838208675385], [0.0937594622373581, 0.26676830649375916, 0.1855047345161438, 0.1626499891281128, 0.09117116034030914, 0.03972117602825165, 0.01463919598609209, 0.010044379159808159, 0.009555388242006302, 0.00992572121322155, 0.011226186528801918, 0.013326159678399563, 0.015503855422139168, 0.01705191098153591, 0.018157251179218292, 0.019518937915563583, 0.021476181223988533], [0.20758330821990967, 0.13951876759529114, 0.10362173616886139, 0.07678887993097305, 0.058016158640384674, 0.04594506695866585, 0.038869597017765045, 0.03589692339301109, 0.03520715981721878, 0.034317679703235626, 0.03329898789525032, 0.03260079398751259, 0.03216509893536568, 0.031884606927633286, 0.031565576791763306, 0.0314372181892395, 0.03128243610262871]], [[0.07513699680566788, 0.08526359498500824, 0.13498865067958832, 0.10119548439979553, 0.09113423526287079, 0.04085567593574524, 0.01921733096241951, 0.034889332950115204, 0.046255502849817276, 0.049270473420619965, 0.0447186641395092, 0.04006043076515198, 0.0390007309615612, 0.04048111289739609, 0.041238006204366684, 0.039913129061460495, 0.03820334002375603, 0.03817728906869888], [0.13983844220638275, 0.2732653021812439, 0.17354518175125122, 0.13398997485637665, 0.08793292194604874, 0.04364616051316261, 0.01923556998372078, 0.01171690970659256, 0.010375220328569412, 0.010240630246698856, 0.010583186522126198, 0.010619673877954483, 0.010111158713698387, 0.009953288361430168, 0.010818968527019024, 0.012552354484796524, 0.014698585495352745, 0.016876429319381714], [0.23950600624084473, 0.16756322979927063, 0.1109866052865982, 0.0707092359662056, 0.050092536956071854, 0.037540826946496964, 0.03096344880759716, 0.02858227677643299, 0.02857847511768341, 0.028057729825377464, 0.027290984988212585, 0.026709867641329765, 0.026315154507756233, 0.02595774456858635, 0.025574717670679092, 0.025393087416887283, 0.02512311562895775, 0.025054924190044403]], [[0.06971786916255951, 0.08253246545791626, 0.14086145162582397, 0.09935861825942993, 0.09119199961423874, 0.03641104698181152, 0.013114772737026215, 0.013255304656922817, 0.013432158157229424, 0.013632415793836117, 0.014009935781359673, 0.01476303394883871, 0.01602315716445446, 0.017745373770594597, 0.019696949049830437, 0.021589750424027443, 0.023246360942721367, 0.024609217420220375, 0.2748081386089325], [0.1345861256122589, 0.26224440336227417, 0.17392563819885254, 0.14241494238376617, 0.09918735921382904, 0.049841705709695816, 0.020515013486146927, 0.011517084203660488, 0.009705948643386364, 0.009120606817305088, 0.009060349315404892, 0.008801966905593872, 0.008238466456532478, 0.008112827315926552, 0.008771071210503578, 0.00994882918894291, 0.011366014368832111, 0.012913450598716736, 0.00972823053598404], [0.2248326987028122, 0.17284108698368073, 0.11143972724676132, 0.06981480866670609, 0.05015406385064125, 0.03802467882633209, 0.031274229288101196, 0.027970824390649796, 0.027972746640443802, 0.02733071893453598, 0.026405591517686844, 0.025671496987342834, 0.02515905536711216, 0.024667346850037575, 0.024172130972146988, 0.02392209693789482, 0.023540806025266647, 0.023295927792787552, 0.021509919315576553]], [[0.07281780242919922, 0.08309957385063171, 0.1360844224691391, 0.09605910629034042, 0.08962266147136688, 0.03738216683268547, 0.014406862668693066, 0.013416568748652935, 0.012313390150666237, 0.011652207002043724, 0.011821486987173557, 0.012871630489826202, 0.01456363219767809, 0.01641334593296051, 0.017972690984606743, 0.019167207181453705, 0.02027161419391632, 0.02156672067940235, 0.27349796891212463, 0.024998923763632774], [0.13201360404491425, 0.26278287172317505, 0.16959406435489655, 0.14125290513038635, 0.10086168348789215, 0.051405102014541626, 0.021410835906863213, 0.011599823832511902, 0.009535608813166618, 0.00878797098994255, 0.008626355789601803, 0.008267217315733433, 0.0076439157128334045, 0.007479944732040167, 0.008018707856535912, 0.00895308330655098, 0.010074571706354618, 0.01133984886109829, 0.008993343450129032, 0.011358528397977352], [0.21859972178936005, 0.17316563427448273, 0.11033875495195389, 0.06896032392978668, 0.04903227835893631, 0.03686723858118057, 0.03007742203772068, 0.026825135573744774, 0.02692899852991104, 0.026376154273748398, 0.025522511452436447, 0.024823445826768875, 0.02433067560195923, 0.023877814412117004, 0.02343161031603813, 0.02318369597196579, 0.02280224673449993, 0.022534392774105072, 0.021676737815141678, 0.02064519003033638]], [[0.07318626344203949, 0.08278272300958633, 0.13477838039398193, 0.09531867504119873, 0.08928696811199188, 0.03722533956170082, 0.01389460451900959, 0.012583998031914234, 0.011537855491042137, 0.01088653039187193, 0.010988417081534863, 0.011883318424224854, 0.013347135856747627, 0.014944760128855705, 0.016287559643387794, 0.01732560805976391, 0.01830916851758957, 0.019472986459732056, 0.27091217041015625, 0.022290952503681183, 0.022756582126021385], [0.13021515309810638, 0.26310160756111145, 0.16758881509304047, 0.1391262710094452, 0.09885431081056595, 0.05028320103883743, 0.021200355142354965, 0.011418513022363186, 0.009412983432412148, 0.008675597608089447, 0.008529480546712875, 0.00823753047734499, 0.007694430649280548, 0.0075671314261853695, 0.00810262095183134, 0.009011120535433292, 0.010100085288286209, 0.011335822753608227, 0.008779729716479778, 0.01098847296088934, 0.009776809252798557], [0.2196512222290039, 0.17096301913261414, 0.10828463733196259, 0.06705070286989212, 0.04704717919230461, 0.035109784454107285, 0.028593532741069794, 0.02563554421067238, 0.025763001292943954, 0.025280620902776718, 0.024523954838514328, 0.02390863001346588, 0.023480860516428947, 0.02308664470911026, 0.022690240293741226, 0.022467661648988724, 0.02211879938840866, 0.02188955992460251, 0.021179374307394028, 0.020216137170791626, 0.021058883517980576]], [[0.0738769993185997, 0.08334751427173615, 0.13451242446899414, 0.09464562684297562, 0.08779856562614441, 0.03591373562812805, 0.012832117266952991, 0.011548038572072983, 0.010693744756281376, 0.01014249213039875, 0.010226043872535229, 0.011006872169673443, 0.012315609492361546, 0.013787390664219856, 0.015066088177263737, 0.016067715361714363, 0.01698540896177292, 0.01802954636514187, 0.2692471742630005, 0.02048295922577381, 0.020839348435401917, 0.020634593442082405], [0.12903398275375366, 0.2619166672229767, 0.1652604043483734, 0.13704103231430054, 0.09723019599914551, 0.0496014840900898, 0.02119464986026287, 0.011392395943403244, 0.009393556043505669, 0.008653281256556511, 0.008510896936058998, 0.008242073468863964, 0.007729494012892246, 0.007610628381371498, 0.008129175752401352, 0.009005467407405376, 0.010053187608718872, 0.01122988946735859, 0.008629804477095604, 0.01074044220149517, 0.009595477022230625, 0.009805840440094471], [0.21850015223026276, 0.1701219230890274, 0.10644016414880753, 0.06541354209184647, 0.04532960429787636, 0.033570028841495514, 0.02723074145615101, 0.02445354498922825, 0.02461397647857666, 0.024186454713344574, 0.023493487387895584, 0.02293585054576397, 0.022562965750694275, 0.022233514115214348, 0.021897751837968826, 0.021705612540245056, 0.02138967253267765, 0.021195271983742714, 0.020755987614393234, 0.019898442551493645, 0.020848240703344345, 0.021223073825240135]], [[0.07450179755687714, 0.08379606902599335, 0.13388711214065552, 0.09393414855003357, 0.08705945312976837, 0.03577354922890663, 0.012877793051302433, 0.011290565133094788, 0.010233616456389427, 0.00953291729092598, 0.009519202634692192, 0.010217444971203804, 0.011419916525483131, 0.012734634801745415, 0.013808750547468662, 0.014591523446142673, 0.015307378955185413, 0.016185101121664047, 0.2674940526485443, 0.0185115784406662, 0.019151050597429276, 0.01914076879620552, 0.019031574949622154], [0.12778884172439575, 0.2623029053211212, 0.16204479336738586, 0.13439738750457764, 0.09547403454780579, 0.04892722889780998, 0.021200645714998245, 0.011378640308976173, 0.009391671046614647, 0.008643093518912792, 0.008488459512591362, 0.008224934339523315, 0.0077340565621852875, 0.007624268066138029, 0.008130100555717945, 0.008978546597063541, 0.009991763159632683, 0.011129558086395264, 0.00858862604945898, 0.010606062598526478, 0.009485582821071148, 0.009689798578619957, 0.009779042564332485], [0.21667839586734772, 0.16983403265476227, 0.10482846200466156, 0.06368697434663773, 0.04345851391553879, 0.031886111944913864, 0.02583765983581543, 0.023254256695508957, 0.02348487824201584, 0.023127436637878418, 0.022513527423143387, 0.02202436700463295, 0.021708201617002487, 0.021430660039186478, 0.021141652017831802, 0.020973455160856247, 0.02069074660539627, 0.02053026482462883, 0.02030903846025467, 0.01952245458960533, 0.020575955510139465, 0.02099420875310898, 0.021508749574422836]], [[0.0746217891573906, 0.08426842838525772, 0.13475356996059418, 0.09485603123903275, 0.08674005419015884, 0.03511274978518486, 0.012876337394118309, 0.011421659961342812, 0.010482973419129848, 0.009694887325167656, 0.00941753014922142, 0.009745092131197453, 0.010576106607913971, 0.011649565771222115, 0.012650364078581333, 0.013400755822658539, 0.013953096233308315, 0.01448216661810875, 0.26500073075294495, 0.015908904373645782, 0.016409650444984436, 0.01696949452161789, 0.01732349582016468, 0.017684560269117355], [0.12582674622535706, 0.2648469805717468, 0.16235506534576416, 0.1325921267271042, 0.09282002598047256, 0.04703160375356674, 0.020344048738479614, 0.01070913951843977, 0.008743672631680965, 0.008047389797866344, 0.007989446632564068, 0.00787422526627779, 0.007487152237445116, 0.0073814005590975285, 0.007846720516681671, 0.00867983978241682, 0.009777814149856567, 0.011111465282738209, 0.008632474578917027, 0.010582485236227512, 0.009415706619620323, 0.00954418908804655, 0.00960557535290718, 0.010754702612757683], [0.21461276710033417, 0.1641303300857544, 0.10169635713100433, 0.06194669380784035, 0.04231879115104675, 0.03096866048872471, 0.025009479373693466, 0.022397099062800407, 0.022701572626829147, 0.02237720414996147, 0.02178504876792431, 0.021327916532754898, 0.021061576902866364, 0.020838920027017593, 0.020593147724866867, 0.020445045083761215, 0.020189158618450165, 0.020050371065735817, 0.02019934542477131, 0.019592514261603355, 0.02063898742198944, 0.02108861692249775, 0.02167360857129097, 0.02235678769648075]], [[0.07467000186443329, 0.08421251177787781, 0.1340370923280716, 0.09436548501253128, 0.08616416156291962, 0.03470156341791153, 0.0124305235221982, 0.010852246545255184, 0.00989123061299324, 0.00910500343888998, 0.008834248408675194, 0.009150069206953049, 0.009935867972671986, 0.010929101146757603, 0.011832722462713718, 0.012498937547206879, 0.012998861260712147, 0.013502716086804867, 0.26405373215675354, 0.014853144064545631, 0.015333574265241623, 0.015839532017707825, 0.01618308760225773, 0.01653769612312317, 0.017086856067180634], [0.1246715635061264, 0.262591153383255, 0.15876060724258423, 0.12986917793750763, 0.09109871089458466, 0.04641719534993172, 0.020294858142733574, 0.010661520063877106, 0.008695599623024464, 0.007992556318640709, 0.007926193997263908, 0.007817051373422146, 0.00745408795773983, 0.007364392280578613, 0.007825175300240517, 0.00863888394087553, 0.009700676426291466, 0.01097271777689457, 0.008605053648352623, 0.010484891943633556, 0.009369325824081898, 0.009512032382190228, 0.009588121436536312, 0.010713804513216019, 0.012974610552191734], [0.21196940541267395, 0.16328662633895874, 0.10021079331636429, 0.06057353317737579, 0.04085226729512215, 0.029620254412293434, 0.023791830986738205, 0.021301550790667534, 0.021623581647872925, 0.0213308185338974, 0.020781658589839935, 0.020364031195640564, 0.02013234794139862, 0.019946224987506866, 0.01973608136177063, 0.019604995846748352, 0.019377507269382477, 0.019263535737991333, 0.019685134291648865, 0.019134150817990303, 0.020192693918943405, 0.020653339102864265, 0.021259784698486328, 0.021956218406558037, 0.02335158921778202]], [[0.07693074643611908, 0.08556722104549408, 0.13309529423713684, 0.0933128148317337, 0.08409641683101654, 0.03365432471036911, 0.011811785399913788, 0.01020992174744606, 0.009365611709654331, 0.008680438622832298, 0.008464296348392963, 0.008774789981544018, 0.009489588439464569, 0.01035560853779316, 0.011108547449111938, 0.011639517731964588, 0.012037490494549274, 0.012467506341636181, 0.2630666494369507, 0.013737493194639683, 0.014233144000172615, 0.014739706180989742, 0.015117542818188667, 0.015448571182787418, 0.015852294862270355, 0.0167426485568285], [0.12423086166381836, 0.2587158679962158, 0.15516707301139832, 0.1261768937110901, 0.08876680582761765, 0.045589178800582886, 0.020320381969213486, 0.010729281231760979, 0.008746892213821411, 0.008022393099963665, 0.007945369929075241, 0.007860557176172733, 0.007544021122157574, 0.007483473047614098, 0.007945356890559196, 0.00873478688299656, 0.009754319675266743, 0.010967763140797615, 0.008613858371973038, 0.010386279784142971, 0.009328367188572884, 0.009483743458986282, 0.009574427269399166, 0.010660161264240742, 0.012858269736170769, 0.0143935801461339], [0.20857077836990356, 0.16108626127243042, 0.09872841835021973, 0.059611693024635315, 0.039774008095264435, 0.028562285006046295, 0.022763239219784737, 0.020356837660074234, 0.020662851631641388, 0.020393287762999535, 0.019880719482898712, 0.019493617117404938, 0.01928366720676422, 0.019118700176477432, 0.0189271941781044, 0.018795277923345566, 0.018572863191366196, 0.018458029255270958, 0.01926491968333721, 0.01873527094721794, 0.019774261862039566, 0.020214660093188286, 0.020819269120693207, 0.02150779217481613, 0.022824253886938095, 0.02381986752152443]], [[0.07860513031482697, 0.08707122504711151, 0.13285887241363525, 0.09155957400798798, 0.08231345564126968, 0.032747782766819, 0.010942529886960983, 0.009066242724657059, 0.008320005610585213, 0.007792565040290356, 0.007715099491178989, 0.008106924593448639, 0.008837555535137653, 0.009673621505498886, 0.010394277051091194, 0.010925134643912315, 0.011349759064614773, 0.011798442341387272, 0.26246243715286255, 0.013082056306302547, 0.013767031021416187, 0.0141838314011693, 0.014493701048195362, 0.0147614860907197, 0.014986454509198666, 0.01583893410861492, 0.01634581945836544], [0.12491336464881897, 0.2556072473526001, 0.1494922935962677, 0.12244410812854767, 0.086565300822258, 0.04499009996652603, 0.020457448437809944, 0.010952867567539215, 0.009056814946234226, 0.008343227207660675, 0.00822335947304964, 0.008071972988545895, 0.007726911921054125, 0.00768215861171484, 0.008174178190529346, 0.008970065042376518, 0.00990260299295187, 0.01091416273266077, 0.008339310064911842, 0.010034726932644844, 0.009006008505821228, 0.009211232885718346, 0.009312683716416359, 0.010375170037150383, 0.01234520599246025, 0.013720260001718998, 0.015167244710028172], [0.20535056293010712, 0.1642817258834839, 0.09878620505332947, 0.05859515815973282, 0.03797970339655876, 0.026871852576732635, 0.021316369995474815, 0.0191701278090477, 0.01941719651222229, 0.01916472613811493, 0.01870361715555191, 0.018351377919316292, 0.01815154403448105, 0.017992792651057243, 0.01781085506081581, 0.017663735896348953, 0.017434488981962204, 0.017311017960309982, 0.018684063106775284, 0.018045954406261444, 0.019143521785736084, 0.019590483978390694, 0.020192360505461693, 0.020906802266836166, 0.022177889943122864, 0.023191049695014954, 0.02371484413743019]], [[0.07847851514816284, 0.08666878938674927, 0.13246169686317444, 0.09122126549482346, 0.08201155066490173, 0.03243691474199295, 0.01056450605392456, 0.00861446000635624, 0.007879163138568401, 0.007365888450294733, 0.007294161710888147, 0.007673206273466349, 0.008366198278963566, 0.009140129201114178, 0.009786099195480347, 0.010248901322484016, 0.010624836198985577, 0.011043761856853962, 0.2617141306400299, 0.012258514761924744, 0.012914462015032768, 0.013298619538545609, 0.013592414557933807, 0.013840671628713608, 0.014040500856935978, 0.014846362173557281, 0.015320771373808384, 0.016293495893478394], [0.12341217696666718, 0.2521999478340149, 0.14633560180664062, 0.11973907798528671, 0.08473601937294006, 0.04421641305088997, 0.02030242793262005, 0.010906338691711426, 0.00903106015175581, 0.008315950632095337, 0.008190886117517948, 0.008048387244343758, 0.007726028095930815, 0.007694183383136988, 0.00817672535777092, 0.0089444974437356, 0.009835200384259224, 0.010793969966471195, 0.008186088874936104, 0.009802459739148617, 0.008832793682813644, 0.009042613208293915, 0.009143429808318615, 0.010163632221519947, 0.012025977484881878, 0.013335838913917542, 0.014729497954249382, 0.016132764518260956], [0.20344866812229156, 0.16358895599842072, 0.09768874943256378, 0.057459667325019836, 0.03675882890820503, 0.025760427117347717, 0.020285191014409065, 0.018243297934532166, 0.018489379435777664, 0.01824776828289032, 0.01780848763883114, 0.017479799687862396, 0.01730426773428917, 0.017172858119010925, 0.017017539590597153, 0.016882620751857758, 0.016672223806381226, 0.016563832759857178, 0.018011093139648438, 0.017413483932614326, 0.018494537100195885, 0.018929602578282356, 0.01952548697590828, 0.020222842693328857, 0.021399090066552162, 0.02239430695772171, 0.022912170737981796, 0.023824818432331085]], [[0.07803492993116379, 0.08715659379959106, 0.13226234912872314, 0.09224855899810791, 0.0816962867975235, 0.032096561044454575, 0.010514266788959503, 0.008737740106880665, 0.008174596354365349, 0.007676444016396999, 0.007472052704542875, 0.007629582658410072, 0.008095405995845795, 0.008724961429834366, 0.009338168427348137, 0.0098120691254735, 0.010141044855117798, 0.010407516732811928, 0.26065176725387573, 0.011051375418901443, 0.011352349072694778, 0.01184073742479086, 0.012290163896977901, 0.012703641317784786, 0.01324166264384985, 0.01387416198849678, 0.014165479689836502, 0.014573466032743454, 0.014036101289093494], [0.12199942767620087, 0.24970786273479462, 0.14416202902793884, 0.11630465090274811, 0.0815608948469162, 0.0424138680100441, 0.019569039344787598, 0.010414878837764263, 0.008542980998754501, 0.007868770509958267, 0.007810234557837248, 0.007770969066768885, 0.0075339460745453835, 0.007526735309511423, 0.008009033277630806, 0.008801680989563465, 0.00977424904704094, 0.01084858737885952, 0.008439864031970501, 0.009943734854459763, 0.008888323791325092, 0.009063615463674068, 0.009183568879961967, 0.010161343030631542, 0.01210411824285984, 0.013404027558863163, 0.014815160073339939, 0.016055703163146973, 0.017320718616247177], [0.19821198284626007, 0.15844060480594635, 0.0956416055560112, 0.05647655948996544, 0.03646669536828995, 0.02556683123111725, 0.01994086615741253, 0.017639581114053726, 0.017842255532741547, 0.01753227412700653, 0.017021048814058304, 0.016645407304167747, 0.01644798368215561, 0.016308214515447617, 0.016143925487995148, 0.01600450463593006, 0.015796685591340065, 0.01567891612648964, 0.018039925023913383, 0.017512958496809006, 0.018451767042279243, 0.018884938210248947, 0.019443310797214508, 0.020099341869354248, 0.02114531770348549, 0.022104213014245033, 0.022648055106401443, 0.023575816303491592, 0.024288438260555267]], [[0.07910682260990143, 0.0873805582523346, 0.13149797916412354, 0.09132234752178192, 0.08079256117343903, 0.031745485961437225, 0.01011615339666605, 0.008232278749346733, 0.007779252249747515, 0.00740311061963439, 0.007282513193786144, 0.0074644191190600395, 0.007895572111010551, 0.00845248717814684, 0.008989800699055195, 0.009409314952790737, 0.00970348808914423, 0.009937969967722893, 0.26010751724243164, 0.01053212396800518, 0.010833770968019962, 0.011378773488104343, 0.011867891997098923, 0.012268401682376862, 0.012697678990662098, 0.013156969100236893, 0.013344813138246536, 0.013731815852224827, 0.013329866342246532, 0.01223823893815279], [0.12087579071521759, 0.24652928113937378, 0.1407712996006012, 0.11285645514726639, 0.07907218486070633, 0.041256215423345566, 0.019233902916312218, 0.010305634699761868, 0.008488573133945465, 0.007819274440407753, 0.007746894843876362, 0.007717133034020662, 0.007516858167946339, 0.007540646940469742, 0.008033775724470615, 0.008813444525003433, 0.009741103276610374, 0.010747676715254784, 0.008237390778958797, 0.009643498808145523, 0.008631344884634018, 0.00882691890001297, 0.008958271704614162, 0.009920313023030758, 0.01180852111428976, 0.013081904500722885, 0.014467133209109306, 0.015688158571720123, 0.016920704394578934, 0.018749739974737167], [0.19527055323123932, 0.15780635178089142, 0.09485143423080444, 0.05528438836336136, 0.035115815699100494, 0.02430550754070282, 0.01882024295628071, 0.01666928082704544, 0.01686226949095726, 0.016558073461055756, 0.016067249700427055, 0.015714131295681, 0.015533783473074436, 0.015414157882332802, 0.015272690914571285, 0.015151822939515114, 0.014976277016103268, 0.01489156112074852, 0.017277447506785393, 0.01684187911450863, 0.017844459041953087, 0.018274981528520584, 0.018856190145015717, 0.01952216401696205, 0.020466100424528122, 0.02144625596702099, 0.022000864148139954, 0.023046378046274185, 0.023767055943608284, 0.026090677827596664]], [[0.07936696708202362, 0.0876476988196373, 0.1308467984199524, 0.09099745750427246, 0.08030956983566284, 0.0315503254532814, 0.009935527108609676, 0.008023129776120186, 0.007599758915603161, 0.007222198415547609, 0.007071200292557478, 0.0072065903805196285, 0.007591865491122007, 0.008117271587252617, 0.008638625964522362, 0.009045368991792202, 0.00931643694639206, 0.009514963254332542, 0.2596260905265808, 0.010004485957324505, 0.01027083769440651, 0.010802418924868107, 0.011294495314359665, 0.011707515455782413, 0.01219828613102436, 0.012648489326238632, 0.012835100293159485, 0.01314590871334076, 0.012759310193359852, 0.011788895353674889, 0.010916364379227161], [0.11895968019962311, 0.24223347008228302, 0.136837899684906, 0.10940916836261749, 0.07685204595327377, 0.04031505808234215, 0.019004087895154953, 0.010182458907365799, 0.008381413295865059, 0.007715354673564434, 0.007645600009709597, 0.007637261413037777, 0.007475845515727997, 0.007524026092141867, 0.008013320155441761, 0.00877231452614069, 0.009669441729784012, 0.01062808744609356, 0.008158713579177856, 0.00947281252592802, 0.008524572476744652, 0.00873959343880415, 0.008895164355635643, 0.009817025624215603, 0.011615787632763386, 0.012817907147109509, 0.014153709635138512, 0.015351025387644768, 0.016644489020109177, 0.018546462059020996, 0.020006146281957626], [0.19218558073043823, 0.1570395976305008, 0.0940573439002037, 0.05431090295314789, 0.03405870869755745, 0.02328452654182911, 0.017839252948760986, 0.015751471742987633, 0.01589009165763855, 0.01556384190917015, 0.015072803944349289, 0.014721861109137535, 0.014540333300828934, 0.014427600428462029, 0.014300774782896042, 0.014195079915225506, 0.014043167233467102, 0.01397491805255413, 0.01666639931499958, 0.016223689541220665, 0.01724577322602272, 0.01767871342599392, 0.018269725143909454, 0.018950756639242172, 0.019827375188469887, 0.020825110375881195, 0.02141101285815239, 0.02255118638277054, 0.023285381495952606, 0.02551940828561783, 0.026287563145160675]]];
        var y_action = [[[0.9962677359580994, 0.002191258128732443, 0.001541050965897739], [1.4143515727482736e-05, 0.00014052982442080975, 0.9998452663421631]], [[0.011214989237487316, 0.0005632680258713663, 0.9882217049598694], [0.30749785900115967, 0.6828877925872803, 0.009614321403205395]], [[3.353212377987802e-05, 2.7668735924635257e-07, 0.9999661445617676], [0.7119767069816589, 0.28746750950813293, 0.0005557964323088527]], [[1.5116841041162843e-06, 2.7559312609781728e-09, 0.9999984502792358], [0.9890190958976746, 0.010827044025063515, 0.00015386688755825162]], [[6.108851380304259e-07, 1.494291135273329e-09, 0.9999994039535522], [0.9874394536018372, 0.012518143281340599, 4.2401894461363554e-05]], [[6.224735216164845e-07, 1.552904360657692e-09, 0.9999994039535522], [0.9879337549209595, 0.012014663778245449, 5.158667772775516e-05]], [[8.076696644820913e-07, 1.7970211985129936e-09, 0.9999991655349731], [0.9893302321434021, 0.010559282265603542, 0.00011047726729884744]], [[5.576826538344903e-07, 9.055143301850421e-10, 0.9999994039535522], [0.9833688139915466, 0.01656009629368782, 7.101755909388885e-05]], [[6.312692448773305e-07, 8.545418817007544e-10, 0.9999994039535522], [0.9836876392364502, 0.016230149194598198, 8.220106246881187e-05]], [[1.0531032330618473e-06, 1.3346024285709746e-09, 0.999998927116394], [0.9795971512794495, 0.02029339410364628, 0.00010943932284135371]], [[1.7699957197692129e-06, 2.093931694702178e-09, 0.9999982118606567], [0.9751229286193848, 0.024714479222893715, 0.00016258472169283777]], [[2.995852128151455e-06, 3.411193771896137e-09, 0.9999970197677612], [0.9696335196495056, 0.030130693688988686, 0.00023578399850521237]], [[5.540172423934564e-06, 6.428908960742774e-09, 0.9999943971633911], [0.9599790573120117, 0.03969084843993187, 0.0003300326061435044]], [[1.186805729957996e-05, 1.5248982521143262e-08, 0.9999880790710449], [0.9449102282524109, 0.0545954667031765, 0.0004943214007653296]], [[3.101199399679899e-05, 4.913669826578371e-08, 0.9999688863754272], [0.9148141741752625, 0.08427038043737411, 0.0009154655854217708]], [[0.0001357501751044765, 3.2841299457686546e-07, 0.999863862991333], [0.8272174000740051, 0.1702267825603485, 0.0025558588095009327]], [[0.0012266264529898763, 4.999287739337888e-06, 0.9987683892250061], [0.5785629749298096, 0.4089486598968506, 0.012488357722759247]], [[0.014205890707671642, 0.00011552919750101864, 0.9856786131858826], [0.18106240034103394, 0.7708931565284729, 0.048044465482234955]], [[0.8266318440437317, 0.16930051147937775, 0.004067605827003717], [0.0008880298701114953, 0.9991113543510437, 6.461737029894721e-07]], [[0.8228186964988708, 0.17457561194896698, 0.002605702728033066], [0.0006611298304051161, 0.9993384480476379, 3.678636062431906e-07]], [[0.7347651124000549, 0.263899028301239, 0.0013358370633795857], [0.0013604158302769065, 0.9986383318901062, 1.20091249300458e-06]], [[0.6904399394989014, 0.30858156085014343, 0.0009784525027498603], [0.0013707652688026428, 0.998627781867981, 1.401146391799557e-06]], [[0.6360711455345154, 0.36325976252555847, 0.0006690739537589252], [0.0014760704943910241, 0.9985222220420837, 1.7155471141450107e-06]], [[0.5760346055030823, 0.4234687089920044, 0.0004966746200807393], [0.0015927063068374991, 0.9984050393104553, 2.2302413071884075e-06]], [[0.5892142057418823, 0.41023093461990356, 0.0005548452027142048], [0.0007837853045202792, 0.9992153644561768, 8.498348051944049e-07]], [[0.5772080421447754, 0.42222458124160767, 0.0005673681735061109], [0.0007828797097317874, 0.9992160797119141, 1.0820835996128153e-06]], [[0.528414249420166, 0.47109898924827576, 0.00048680609324947], [0.0008729275432415307, 0.9991256594657898, 1.471155201215879e-06]], [[0.3583682179450989, 0.6414080858230591, 0.00022370830993168056], [0.0021385429427027702, 0.9978552460670471, 6.148764896352077e-06]], [[0.3215080499649048, 0.6782784461975098, 0.00021354509226512164], [0.00262709753587842, 0.9973630309104919, 9.901087651087437e-06]], [[0.4639669954776764, 0.5352645516395569, 0.0007684809388592839], [0.001167748006992042, 0.9988278746604919, 4.396690655994462e-06]], [[0.4681761860847473, 0.530760645866394, 0.0010632070479914546], [0.0015319252852350473, 0.9984602928161621, 7.749981705273967e-06]], [[0.47834792733192444, 0.5200724601745605, 0.001579662086442113], [0.002040238119661808, 0.9979454874992371, 1.4282908523455262e-05]]]; // action probs
        var action =  [[0, 2], [2, 1], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 1], [2, 1], [0, 1], [0, 1], [0, 1], [0, 1], [1, 1], [1, 1], [1, 1], [0, 1], [0, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1]];
        var action_names = [['no-op', 'left', 'right'], ['no-op', 'up', 'down']];
        var x_values = [...Array(y_values.length).keys()];

        var y_entropy_plot = [];
        var y_values_plot = [];

        // Set marker for plots
        var entropy_marker = false;
        var value_marker = false;

        // Set the to be shown statistic
        var statistic_type = 'general'
        // Only used for the transformer plot to show the correct statistic with tab switching
        var statistic_plot_id = 0;
        // Hide statistic type button if there is no attention weights
        if(y_attention_weights.length == 0) stats_button.style.display = 'none';

        // Set the to be shown action_space(s) for the entropy plot
        var entr_selected_action_space = null;

        var is_multi_discrete = action[0].length != 1;
        var is_discrete = action[0].length == 1;

        // Reformat the data for the plots
        // Each function y - value should be stored in a separate array
        for(var j = 0; j < y_values[0].length; j++)
            for(var i = 0; i < y_values.length; i++)
                y_values_plot.push(y_values[i][j]);

        if(is_discrete) { // If action_space is discrete
          for(var j = 0; j < y_entropy[0].length; j++)
              for(var i = 0; i < y_values.length; i++)
                  y_entropy_plot.push(y_entropy[i][j]);
        }
        else { // If action_space is multi discrete
          for(var j = 0; j < y_entropy[0].length; j++) {
            var y_entropy_vals = [];
            for(var i = 0; i < y_entropy.length; i++) {
                y_entropy_vals.push(y_entropy[i][j]);
            }
            y_entropy_plot.push(y_entropy_vals);
          }
        }

        // Set action_names for distr. plot if it does not exist
        if(action_names == null){
          action_names = [];
          for(var i = 0; i < y_action[0].length; i++){
            for(var j = 0; j < y_action[0][0].length; j++)
              if(is_discrete){ // if action space is discrete
                action_names.push("action_" + String(j));
            }
            else { // if action space is multi_discrete
              var action_branch_names = []; // Names of the branches of the action space
              for(var j = 0; j < y_action[0][i].length; j++){
                action_branch_names.push("action_" + String(j));
              }
              action_names.push(action_branch_names);
            }     
          }
        }
        else{
          if(action[0].length == 1 && Array.isArray(action_names[0])){ // If action space is discrete and action_names is multi_discrete
            action_names = action_names[0]; // Set action_names to the first branch of the action space
          }
        }

        // Modify dropdown menu
        if(is_discrete){ // if action space is discrete
          document.getElementById("all").outerHTML=""; // remove dropdown option 'all'
        }
        else { // If action space is multi_discrete
          // Create dropdown menu for the entropy function
          var dropdown_content = document.getElementById("dropdown_content"); 
          for(var i = 0; i < action[0].length; i++){
            var entropy_dropdown_option = document.createElement("a");
            entropy_dropdown_option.innerHTML = "action_space_" + String(i);
            entropy_dropdown_option.setAttribute("href", "#");
            entropy_dropdown_option.setAttribute("onclick", "set_action_space(" + String(i) + ")");
            dropdown_content.appendChild(entropy_dropdown_option);
          }
        }

        window.addEventListener('load', () => {
          // Set video length to length - 0.9999 because the last frame is two seconds long
          video_length = video_player.duration - 0.9999;
          time_selector.setAttribute('max', video_length); // Set max value of time selector to video length

          video_player.addEventListener('timeupdate', timeListener); // Update time selector and plots when video is playing
          video_player.addEventListener('dblclick', function(e) {open_fullscreen(video_player);}); // Open video in fullscreen when video is double clicked
          video_player.playbackRate = 6; // Set video playback rate to frame rate
          reset(); // Reset video to start
        }, false);
      
      // Update video time if time selector is changed
      time_selector.addEventListener('input', () => {
          video_player.currentTime = time_selector.value
          pause();
          update();
      })

      // Add event manager for tab
      window.addEventListener('keydown', function(event) {
          if (event.key === 'Tab') {
              if (statistic_type == "transformer") {
                statistic_plot_id = (statistic_plot_id + 1) % 3;
                // Set action plot if statistic_plot_id is 0
                if(statistic_plot_id == 0){
                  // Update action plot
                  if(is_discrete) { // If action_space is discrete
                    set_bar_action_plot(y_action[step][0], action[step][0], action_names);
                  }
                  else { // If action_space is multi discrete
                      set_stacked_bar_action_plot(y_action[step], action[step], action_names);
                  }
                }
                // Set value plot if statistic_plot_id is 1
                if (statistic_plot_id == 1) {
                  set_scatter_line_plot('action_distr', "Value Function", y_values_plot, step, value_marker);
                }

              // Set entropy plot if statistic_plot_id is 2
              if (statistic_plot_id == 2) {
                  if(is_discrete) { // If action_space is discrete
                      set_scatter_line_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
                  else { // If action_space is multi discrete
                      set_scatter_lines_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
              }
          }
      }
    });

    // Show ground truth if checkbox is checked
    function show_ground_truth() {
        // Get the checkbox element by its ID
        var checkbox = document.getElementById("show_ground_truth");
        
        // Check if the checkbox is checked
        if (checkbox.checked) { // Show the ground truth
          if (video_id == render_id) video_id = render_gt_id;
          if (video_id == render_decoder_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else {
          if (video_id == render_gt_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_agent_id;
          set_video(video_path[video_id]);
        }
      }

    // Show decoder video if checkbox is checked
    function show_decoder_video() {
      var checkbox = document.getElementById("show_decoder_video");
      document.getElementById("show_agent_video").checked = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_decoder_id;
          if (video_id == render_gt_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_decoder_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide decoder video
          if (video_id == render_decoder_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Show agent video if checkbox is checked
    function show_agent_video() {
      var checkbox = document.getElementById("show_agent_video");
      document.getElementById("show_decoder_video").checked  = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_agent_id;
          if (video_id == render_gt_id) video_id = render_agent_gt_id;
          if (video_id == render_decoder_id) video_id = render_agent_id;
          if (video_id == render_decoder_gt_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide agent video
          if (video_id == render_agent_id) video_id = render_id;
          if (video_id == render_agent_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Set the video to the given path
    function set_video(path) {
        // Get video data to make the switch seamless
        var current_time = video_player.currentTime;
        var play_back_rate = video_player.playbackRate;
        var is_paused = video_player.paused;
        video_player.querySelector("source").src = path;
        // Reload video
        video_player.load();
        video_player.currentTime = current_time;
        video_player.playbackRate = play_back_rate;
        if(is_paused) pause();
        else play();
    }


      /**
      * Update time selector and plots when video is playing
      */
      function timeListener() {
        if(!video_player.paused) {
          update();
        } 
      }

      /**
      * Toggles button and video between playing and paused
      */
      function play_pause() {
        if(video_player.paused)
          play();
        else 
          pause();
      }

      /**
       * Returns to the previous frame step
       */
       function return_to_step() {
        video_player.currentTime = past_steps.pop();
        pause();
        update();
        gotostep_text.value = step;
        return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Updates the plots and time selector
       */
       function go_to_step(event) {
        if (event.keyCode === 13) {
          past_steps.push(step);
          video_player.currentTime = Number(gotostep_text.value);
          pause();
          update();
          gotostep_text.value = step;
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
        }
      }

      function set_video_speed(event) {
        if (event.keyCode === 13) {
          video_player.playbackRate = Number(video_speed.value);
        }
      }

      /**
       * Updates the plots and time selector
       */
       function top_scores() {
        if (event.keyCode === 13) update()
      }

      /**
      * Pauses video
      */
      function pause() {
          play_pause_button.innerHTML = "Play";
          video_player.pause();
      }

      /**
      * Plays the video
      */
      function play() {
          play_pause_button.innerHTML = "Pause";
          video_player.play();
      }

      /**
      * Resets the video and plots to the start
      */
      function reset() {
          video_player.currentTime = 0;
          past_steps.push(step);
          pause();
          update();
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the previous frame
      */
      function back() {
          video_player.currentTime = video_player.currentTime - tS_step_size
          pause();
          update();
          past_steps.push(step + 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the next frame
      */
      function next() {
          video_player.currentTime = video_player.currentTime + tS_step_size;
          pause();
          update();
          past_steps.push(step - 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Switches between general and transformer statistics
       */
       function statistic() {
        if (stats_button.innerHTML == "General") {
          statistic_type = "general";
          stats_button.innerHTML = "Transformer";
        }
        else if (stats_button.innerHTML == "Attention Scores") {
          statistic_type = "transformer";
          stats_button.innerHTML = "General";
        }
        update();
      }
      /**
      * Opens the video in fullscreen
      */
      function open_fullscreen(vid_elem) {
          if (vid_elem.requestFullscreen) {
              vid_elem.requestFullscreen();
          } else if (vid_elem.webkitRequestFullscreen) { /* Safari */
              vid_elem.webkitRequestFullscreen();
          } else if (vid_elem.msRequestFullscreen) { /* IE11 */
              vid_elem.msRequestFullscreen();
          }
          vid_elem.pause();
      }

      // Selects the action space for the entropy plot
      function set_action_space(spaces){
        if (spaces == 'all')
          entr_selected_action_space = null;
        else
          entr_selected_action_space = Number(spaces);
        update();
      }

      function marker(marker_id){
        if(marker_id == "entropy")
          entropy_marker = !entropy_marker;
        else if(marker_id == "value")
          value_marker = !value_marker;
        update();
      }

      /**
      * Updates the plots and time selector
      */
      function update()  {
        if(video_player.currentTime == Math.round(video_player.currentTime)) // If time t of video is a natural number then step is t - 1
              video_player.currentTime += 0.0001 // Add a small number to make sure that the step and the current time are the same
        if(video_player.currentTime > video_length) {
           video_player.currentTime = video_length;
           pause();
        } // Video can't go past the end
        time_selector.value = video_player.currentTime; // Update time selector
        step = Math.floor(video_player.currentTime); // Get step of video for plots

        // Update plots
        if (statistic_type == "general")
          render_general_statistics();
        else if (statistic_type == "transformer")
          render_transformer_statistics();

        if(statistic_type == "general") {
          // Reset plot id
          statistic_plot_id = 0;
          // Update action plot
          if(is_discrete) { // If action_space is discrete
            set_bar_action_plot(y_action[step][0], action[step][0], action_names);
          }
          else { // If action_space is multi discrete
              set_stacked_bar_action_plot(y_action[step], action[step], action_names);
          }
        }
      }

      /**
      * Renders the general statistics
      */
      function render_general_statistics() {
        // Disables the transformer statistics and enables the general statistics
          document.getElementById('transformer').style.display = 'none';
          document.getElementById('top_n_scores').style.display = 'none';
          document.querySelector('label[for="top_n_scores"]').style.display = 'none';
          document.getElementById('value_func').style.display = 'block';
          document.getElementById('entropy_func').style.display = 'block';
          document.getElementById('options').style.display = 'block';
        // Updates the plots
          set_scatter_line_plot('value_func', "Value Function", y_values_plot, step, value_marker);
          if(is_discrete) { // If action_space is discrete
              set_scatter_line_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
          else { // If action_space is multi discrete
              set_scatter_lines_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
        }
      
      /*
      * Renders the transformer statistics
      */
      function render_transformer_statistics() {
        // Disables the general statistics and enables the transformer statistics
        document.getElementById('transformer').style.display = 'block';
        document.getElementById('top_n_scores').style.display = 'block';
        document.querySelector('label[for="top_n_scores"]').style.display = 'block';
        document.getElementById('value_func').style.display = 'none';
        document.getElementById('entropy_func').style.display = 'none';
        document.getElementById('options').style.display = 'none';
        // Updates the plots
        var top_n = Number(top_n_scores.value);
        if (top_n == -1) top_n = step;
        visualizeAttentionScores(y_attention_weights[step], top_n);
        }


      /**
       * Renders attention scores
      */
      async function visualizeAttentionScores(attentionScores, n_values) {
        const numHeads = attentionScores.length;
        
        let data = [];
        let layout = {
          grid: {
              rows: numHeads, 
              columns: 1, 
              pattern: 'independent',
              subplots: [...Array(numHeads).keys()].map(i => `xy${i + 1}`),
              ygap: 0.4 // adjust this value according to your preference
          },
          plot_bgcolor: '#000',
          paper_bgcolor: '#000',
          font: {
              family: 'Montserrat',
              size: 12,
              color: '#fff'
          },
          margin: {
              t: 0,  // reduce top margin
          },
      }

        // Flatten the array to find the max value across all arrays
        let flatScores = attentionScores.flat();
        let maxScore = Math.max(...flatScores);

        // Iterate through each attention head
        for (let headIdx = 0; headIdx < numHeads; headIdx++) {
            // Get attention scores for the current head
            let headScores = attentionScores[headIdx];
            
            // This array will keep up to the 10 highest scores
            let topScores = [];

            for (let i = 0; i < headScores.length; i++) {
                // Insert current score into the top scores array
                topScores.push({score: headScores[i], index: i});
                
                // Sort the top scores array
                topScores.sort((a, b) => b.score - a.score);

                // If there are more than 10 scores, remove the smallest
                if (topScores.length > n_values) {
                    topScores.pop();
                }
            }

            // Sort the topScores array by index
            topScores.sort((a, b) => a.index - b.index);

            // Now topScores contains the top 10 scores sorted by their indices.
            // You can extract the scores and their indices into separate arrays:
            let filteredHeadScores = topScores.map(x => x.score);
            let filteredTicks = topScores.map(x => x.index);


            const sequenceLength = filteredHeadScores.length;

            layout.height = 400;
            layout.width = window.innerWidth;

            const headScoresPlot = {
                z: [filteredHeadScores],
                type: 'heatmap',
                showscale: true,  
                colorscale: 'Hot',
                zmin: 0,
                zmax: maxScore,
                xaxis: `x${headIdx + 1}`,
                yaxis: `y${headIdx + 1}`,
            };

            data.push(headScoresPlot);

            layout[`xaxis${headIdx + 1}`] = {
                tickmode: 'array',
                tickvals: Array.from({length: sequenceLength}, (_, i) => i),
                ticktext: filteredTicks
            };

            layout[`yaxis${headIdx + 1}`] = {
                title: `Block ${headIdx + 1}`,
                ticks: 'outside',
                tick0: 0,
                dtick: 1,
                ticklen: 8,
                tickwidth: 4,
                tickcolor: '#000'
            };
        }

        const config = {responsive: true};

        Plotly.newPlot('transformer', data, layout, config).then(function() {
          var myPlot = document.getElementById('transformer');
          myPlot.on('plotly_click', function(data){
            // Jump to the step that was clicked
              past_steps.push(step);
              video_player.currentTime = Number(data.points[0].xaxis.ticktext[data.points[0].x]);
              pause();
              update();
              return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      });
    }

      /** 
      * Sets a stacked bar plot for the multi discrete action distribution
      * @param {array} y_values - The action distribution
      * @param {array} action - The action
      * @param {array} action_names - The names of the actions
      */
      function set_stacked_bar_action_plot(y_values, action, action_names) {
        var bar_plot_data_action = [];
        // Set data for each action
        for(var j = 0; j < action_names[0].length; j++) {
            var color = ""
            for(var i = 0; i < action_names.length; i++) {
                if(action[i] == j) // If action sampled in the current frame
                    color = '#FF0000'; // Color it red
                else
                    color = '#FAEBD7'; // Color it white
                var trace = {
                    x: [["action_space_", String(i)].join("")],
                    y: [y_values[i][j]],
                    text: [y_values[i][j], action_names[i][j]].map(String).join("<br>"), // Add action name and prob to the bar
                    marker: {
                        color: color,
                        line: {
                            color: '#000000',
                            width: 1
                          }
                    },
                    type: 'bar'
                };
                bar_plot_data_action.push(trace);
            }
        }

        // Set layout for the plot
        var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            barmode: 'stack',
            showlegend: false
      };

      // Plot the data
      Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }

      /**
      * Sets a bar plot for the discrete action distribution
      */
      function set_bar_action_plot(y_values, action, action_names) {

          var color_value = new Array(y_values.length).fill('#FAEBD7'); // Set color for all actions to white
          color_value[action] = '#FF0000'; // Except the selected action should be red
          // Set data for the plot
          var bar_plot_data_action = [
              {
                  x: action_names,
                  y: y_values,
                  type: 'bar',
                  marker: {
                      color: color_value
                  },
                  textposition: 'auto',
                  text: y_values.map(String), // Add prob to the bar plot
                  textfont: {
                      family: 'Montserrat',
                      size: 12,
                  },
                  textangle: 0,
                  textposition: 'bottom center',
              }
          ];

          // Set layout for the plot
          var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            yaxis: {
              automargin: true,
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            }
      };
          
          // Plot the action distribution
          Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }


      /**
      * Sets a scatter plot for the emtropy function if multi discrete actions are used
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The entropy function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_lines_plot(id, title, y_values, step, marker) {
        line_scatter_plot_data_value = [];

        // Set colors and data for the plot
        var colors = ['#FAEBD780', '#7CFC0080', '#FFBF0080', '#FF7F5080', '#DE316380', '#9FE2BF80', '#40E0D080', '#6495ED80', '#CCCCFF80']
        for(var i = 0; i < y_values.length; i++) {
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values[i].slice(0, step + 1);
            var trace = [
            {
                x: x_values_marker,
                y: y_values_marker,
                mode: 'line',
                line: {
                    color: colors[i]
                },
                name: 'action_space_' + String(i),
                showlegend: true,
            },
            {
                x: x_values,
                y: y_values[i],
                mode: 'markers',
                name: 'action_space_' + String(i) + "_marker",
                marker: {
                    color: colors[i]
                },
                showlegend: true,
            }
        ];
            // Add data to the plot
            line_scatter_plot_data_value.push(trace[0]);
            if(marker)
              line_scatter_plot_data_value.push(trace[1]); 
        }

        // Select the selected action_space for the entropy plot
        if(entr_selected_action_space != null && marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space * 2], line_scatter_plot_data_value[entr_selected_action_space * 2 + 1]];
        else if(entr_selected_action_space != null && !marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space]];

        // Set layout for the plot
        var line__scatter_plot_layout_value = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 50,
                r: 0,
                b: 30,
                t: 25,
                pad: 4
                },
            yaxis: {
                automargin: true
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: title,
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            showlegend: true,
        };

        // Plot the data
        Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);
        // Add event handler for clicking on a marker
        document.getElementById(id).on('plotly_click', function(data){
            past_steps.push(step);
            video_player.currentTime = Number(data.points[0].x);
            pause();
            update();
            return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      }


      /**
      * Sets a scatter plot for the value function
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The value function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_line_plot(id, title, y_values, step, marker) {
          // Set data for layout for the plot
          var line__scatter_plot_layout_value = {
              autosize: true,
              width: 600,
              height: 360,
              margin: {
                  l: 50,
                  r: 0,
                  b: 30,
                  t: 25,
                  pad: 4
                  },
              yaxis: {
                  automargin: true
              },
              plot_bgcolor: '#000',
              paper_bgcolor: '#000',
              font: {
                  family: 'Montserrat',
                  size: 12,
                  color: '#fff'
              },
              title: {
                  text: title,
                  font: {
                      family: 'Montserrat',
                      size: 15,
                      color: '#fff'
                  }
              },
              showlegend: false,
          };

          // Set data for the plot
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values.slice(0, step + 1);

          var line_scatter_plot_data_value = [
              {
                  x: x_values_marker,
                  y: y_values_marker,
                  mode: 'line',
                  line: {
                      color: '#FAEBD7'
                  },
                  name: 'function',
              },
              {
                  x: x_values,
                  y: y_values,
                  mode: 'markers',
                  marker: {
                      color: '#7CFC0080'
                  },
                  name: 'marker',
              }
          ];

          if(!marker)
            line_scatter_plot_data_value = [line_scatter_plot_data_value[0]];

          // Plot the value function
          Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);

          // Add event handler for clicking on a marker
          document.getElementById(id).on('plotly_click', function(data){
            past_steps.push(step);
            video_player.currentTime = Number(data.points[0].x);
            pause();
            update();
            return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      }
    
    /**
    * Opens the specific tab based on the probided id
    * @param {string} id - The id of the tab
    */
    function openTab(evt, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        mediatabcontent = document.getElementsByClassName("mediatabcontent");
        // Hide all elements with class="tabcontent" and "mediacontent" by default
        for (i = 0; i < mediatabcontent.length; i++) {
            mediatabcontent[i].style.display = "none";
        }
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        // Show the specific tab content
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(id).style.display = "block";
        evt.currentTarget.className += " active";
      }
    </script>
  </body>
</html>