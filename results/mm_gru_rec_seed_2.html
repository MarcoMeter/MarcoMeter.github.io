<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;500&display=swap" rel="stylesheet"/>
    <script src="template/cdn.plot.ly_plotly-2.6.3.min.js"></script>
    <style>
     /* Style the body */
      html, body {
        height: 100%;
        margin: 0;
        background-color: #000;
        color: white;
        font-family: "Montserrat", sans-serif;
      }

      /* Set the width and hight of the video*/
      video {
        width: 600px;
        height: 400px;
      }

      /* Style the timeline text*/
      #selector_header {
        font-weight: 200;
      }

      /* Buttons should be displayed in a row */
      buttonrow {
        display: inline;
      }

      /* Style the figures */
      #figures {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        flex-flow: row wrap;
      }

      /* Style the tab */
      .tab {
        overflow: hidden;
        background-color: #54595f;
      }

      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
        color: white;
      }

      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #909090;
      }

      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #838383;
      }

      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border-top: none;
        background-color: #000;
      }

      .mediatabcontent {
        display: none;
        padding: 0 px 0 px;
        border-top: none;
        background-color: #000;
        width: 100%;
        height: 100%;
      }

      /* Style the close button */
      .topright {
        float: right;
        cursor: pointer;
        font-size: 28px;
      }

      .topright:hover {
        color: red;
      }

      /* Style of the dropdown button */
      .dropbtn {
        background-color: #17202A;
        color: white;
        padding: 16px;
        font-size: 16px;
        border: none;
      }
      
      .dropdown {
        position: relative;
        display: inline-block;
      }
      
      /* Style of the dropdown content */
      .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        background-color: #A6ACAF;
        z-index: 1;
      }
      
      .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
      }

      .gotostepcontainer {
          margin-bottom: 10px;
      }
      
      #score-container label, #score-container input {
        display: inline-block;
      }

      /* Style of the dropdown at hover */
      .dropdown-content a:hover {background-color: #ddd;}
      
      .dropdown:hover .dropdown-content {display: block;}
      
      .dropdown:hover .dropbtn {background-color: #161515;}
    </style>
  </head>
  <body>
    <!--- Define tabs -->
    <div class="tab">
      <button class="tablinks" onclick="openTab(event, 'Environment')">Environment</button>
      <button class="tablinks" onclick="openTab(event, 'Sampler')">Sampler</button>
      <button class="tablinks" onclick="openTab(event, 'Hyperparameters')">Hyperparameters</button>
      <button class="tablinks" onclick="openTab(event, 'Model')">Model</button>
      <button class="tablinks" onclick="openTab(event, 'Media')" id="defaultOpen">Media</button>
    </div>

    <!--- Define tab content -->
    <div id="Environment" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>type</b>: MemoryGym<br><b>name</b>: MortarMayhem-v0<br><b>frame_skip</b>: 1<br><b>last_action_to_obs</b>: False<br><b>last_reward_to_obs</b>: False<br><b>obs_stacks</b>: 1<br><b>grayscale</b>: False<br><b>resize_vis_obs</b>: [84, 84]<br><b>positional_encoding</b>: False<br><b>reset_params</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>start-seed</b>: 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num-seeds</b>: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_scale</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>arena_size</b>: 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>allowed_commands</b>: 9<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>command_count</b>: [10]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>explosion_duration</b>: [6]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>explosion_delay</b>: [18]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_command_failure</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_command_success</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_episode_success</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>seed</b>: 2<br><b>reward_normalization</b>: 0<br><b>positional_endocing</b>: False<br>
    </div>

    <div id="Model" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>load_model</b>: False<br><b>model_path</b>: <br><b>checkpoint_interval</b>: 500<br><b>activation</b>: relu<br><b>vis_encoder</b>: cnn<br><b>vec_encoder</b>: linear<br><b>num_vec_encoder_units</b>: 128<br><b>hidden_layer</b>: default<br><b>num_hidden_layers</b>: 1<br><b>num_hidden_units</b>: 512<br><b>recurrence</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>layer_type</b>: gru<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>sequence_length</b>: -1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hidden_state_size</b>: 512<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hidden_state_init</b>: zero<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reset_hidden_state</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>residual</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_layers</b>: 1<br><b>obs_decoder</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>attach_to</b>: memory<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>detach_gradient</b>: False<br>
    </div>

    <div id="Sampler" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>n_workers</b>: 32<br><b>worker_steps</b>: 512<br>
    </div>

    <div id="Hyperparameters" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>algorithm</b>: PPO<br><b>resume_at</b>: 0<br><b>gamma</b>: 0.995<br><b>lamda</b>: 0.95<br><b>updates</b>: 30000<br><b>epochs</b>: 3<br><b>refresh_buffer_epoch</b>: -1<br><b>n_mini_batches</b>: 8<br><b>advantage_normalization</b>: no<br><b>value_coefficient</b>: 0.5<br><b>max_grad_norm</b>: 0.25<br><b>share_parameters</b>: True<br><b>learning_rate_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.000275<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-05<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>beta_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.0001<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-06<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>clip_range_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>obs_reconstruction_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 1000<br>
    </div>

    <div id="Media" class="mediatabcontent">
      <br>
      <center>
        <div id="figures" style="display: flex; flex-direction: column;">
          <div style="display: flex; flex-direction: row;">
            <div style="display: flex; flex-direction: column;">
              <div style="display: flex; flex-direction: row;">
                <label for="video_speed">Frame Rate: </label>
                <input type="text" id="video_speed" size="3" value="6" onkeydown="set_video_speed(event)">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_ground_truth">Show Ground Truth Estimation</label>
                <input type="checkbox" id="show_ground_truth" onclick="show_ground_truth()">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_decoder_video">Show Decoder Video</label>
                <input type="checkbox" id="show_decoder_video" onclick="show_decoder_video()">
              </div>

            <div style="display: flex; flex-direction: row;">
              <label for="show_agent_video">Show Agent Video</label>
              <input type="checkbox" id="show_agent_video" onclick="show_agent_video()">
            </div>
          </div>
          
            <div>
              <video id="video_player">
                <source src="" type="video/webm" />
              </video>
            </div>
            <div id="action_distr"></div>
          </div>
        </div>

        <br>
        <!-- Set buttons to control the figures -->
        <div class="gotostepcontainer">
          <label for="gotostep_text">Step:</label>
          <input type="text" id="gotostep_text" size="3" value="0" onkeydown="go_to_step(event)">
          <button id="return_button" type="return_button" onclick="return_to_step()">Return to step 0</button>
        </div>
        <buttonrow>
          <button id="play_pause_button" onclick="play_pause()" style="width:53px">Play</button>
          <button id="reset_button" onclick="reset()">Reset</button>
          <button id="back_button" onclick="back()">Back</button>
          <button id="next_button" onclick="next()">Next</button>
          <button id="stats_button" onclick="statistic()">Transformer</button>
        </buttonrow>
        <br>
        <!-- Set slider to control the figures -->
        <input id="time_selector" type="range" min="0" max="100" step="1" value="0" style="width: 300px;"/>

        <!-- Set transformer plot -->
        <div id="score-container">
          <label for="top_n_scores">Top Scores:</label>
          <input type="text" id="top_n_scores" size="3" value="-1" onkeydown="top_scores()">
        </div>
        <div id="transformer"></div>

        <!-- Set value plot and entropy plot -->
        <div id="figures">
          <div id="value_func"></div>
          <div id="entropy_func"></div>
          <!-- Dropdown button with some options-->
          <div class="dropdown" id="options">
            <button class="dropbtn">Options</button>
            <div class="dropdown-content" id="dropdown_content">
              <a href ="#" onclick="marker('value')">value_marker_toggle</a>
              <a href ="#" onclick="marker('entropy')">entropy_marker_toggle</a>
              <a href="#" id="all" onclick="set_action_space('all')">All</a>
            </div>
          </div>
        </div>
      </center>
    </div>

    <script>
        // Set active tab
        document.getElementById("defaultOpen").click();

        // Set video player
        const video_player = document.getElementById("video_player");
        const video_speed = document.getElementById("video_speed");
        const video_path = ['videos/video_seed_2_33.webm', '', '', '', '', ''];
        var render_id = 0; var render_gt_id = 1; var render_decoder_id = 2; var render_decoder_gt_id = 3; var  render_agent_id = 4; var render_agent_gt_id = 5;
        var video_id = 0;
        // Hide video player if there is no ground truth video
        if (video_path[render_gt_id].length == 0 && video_path[render_decoder_gt_id].length == 0 && video_path[render_agent_gt_id].length == 0){
          document.querySelector('label[for="show_ground_truth"]').style.display = 'none';
          document.getElementById("show_ground_truth").style.display = 'none';
        } 
        if (video_path[render_decoder_id].length == 0){
          document.querySelector('label[for="show_decoder_video"]').style.display = 'none';
          document.getElementById("show_decoder_video").style.display = 'none';
        }
        if (video_path[render_agent_id].length == 0){
          document.querySelector('label[for="show_agent_video"]').style.display = 'none';
          document.getElementById("show_agent_video").style.display = 'none';
        }

        video_player.querySelector("source").src = video_path[0];
        video_player.load();
        var video_length = 0;

        // Play and pause button
        const play_pause_button = document.getElementById("play_pause_button");

        // Set step input
        const gotostep_text = document.getElementById('gotostep_text');
        var past_steps = [0];
        var step = 0;

        // Set number of scores input
        const top_n_scores = document.getElementById('top_n_scores');

        // Const stats button
        const stats_button = document.getElementById("stats_button");

        // Set time selector
        const time_selector = document.getElementById('time_selector');
        var tS_step_size = 1.0;

        // Set values for the plots
        var y_values = [[0.3381807506084442], [0.3408503532409668], [0.34212055802345276], [0.34357497096061707], [0.3459148406982422], [0.34744083881378174], [0.3494667112827301], [0.3514297902584076], [0.35137757658958435], [0.3536270260810852], [0.35528549551963806], [0.3573184609413147], [0.3610260486602783], [0.36313876509666443], [0.36489954590797424], [0.3677111864089966], [0.359830766916275], [0.36198970675468445], [0.3632701337337494], [0.3662697672843933], [0.3712453544139862], [0.37281325459480286], [0.37438663840293884], [0.3754889965057373], [0.37697166204452515], [0.3796047270298004], [0.3814399242401123], [0.3846876919269562], [0.3884236514568329], [0.39035406708717346], [0.3922576904296875], [0.3928520977497101], [0.39531224966049194], [0.397242933511734], [0.3987780511379242], [0.4006944000720978], [0.40276041626930237], [0.40440937876701355], [0.4051080048084259], [0.4074135422706604], [0.41158539056777954], [0.41248270869255066], [0.4175220727920532], [0.41624829173088074], [0.42043083906173706], [0.4245075583457947], [0.425022691488266], [0.42739859223365784], [0.43053150177001953], [0.430937260389328], [0.4349776804447174], [0.43713733553886414], [0.4390062093734741], [0.44065141677856445], [0.4430547058582306], [0.4440489709377289], [0.44645074009895325], [0.44735655188560486], [0.35298505425453186], [0.3539743721485138], [0.355114609003067], [0.35750213265419006], [0.3604627251625061], [0.36014729738235474], [0.36466190218925476], [0.3662604093551636], [0.36708828806877136], [0.36533674597740173], [0.3682604730129242], [0.36992910504341125], [0.3723945915699005], [0.3748818337917328], [0.3769263029098511], [0.3791254460811615], [0.38119742274284363], [0.38311854004859924], [0.3848905861377716], [0.3865449130535126], [0.3877761960029602], [0.3900720775127411], [0.390998899936676], [0.3929586112499237], [0.29814082384109497], [0.30106255412101746], [0.29984208941459656], [0.30276355147361755], [0.30533522367477417], [0.3016964793205261], [0.2995423972606659], [0.3042730391025543], [0.3090119957923889], [0.3097153902053833], [0.31198304891586304], [0.3145906925201416], [0.31582558155059814], [0.3166262209415436], [0.31778639554977417], [0.3172248303890228], [0.3172447085380554], [0.32075750827789307], [0.3224002718925476], [0.32419759035110474], [0.32502907514572144], [0.32841306924819946], [0.3271030783653259], [0.33060306310653687], [0.2285669595003128], [0.23124219477176666], [0.2339865267276764], [0.23263412714004517], [0.23406127095222473], [0.23579993844032288], [0.2425565868616104], [0.24906057119369507], [0.25067707896232605], [0.24750997126102448], [0.248006671667099], [0.24961979687213898], [0.25134211778640747], [0.2528572678565979], [0.2526293396949768], [0.2562815248966217], [0.25466588139533997], [0.2583487629890442], [0.26037928462028503], [0.2607637047767639], [0.2622804045677185], [0.26205354928970337], [0.2656020224094391], [0.26537057757377625], [0.1623971313238144], [0.1639869064092636], [0.16882583498954773], [0.16958561539649963], [0.16736096143722534], [0.16915705800056458], [0.16772615909576416], [0.17618104815483093], [0.1788915991783142], [0.18233808875083923], [0.1794944405555725], [0.17886114120483398], [0.1795164942741394], [0.18051737546920776], [0.181274875998497], [0.18179060518741608], [0.18239396810531616], [0.18674695491790771], [0.18403670191764832], [0.18327930569648743], [0.18739503622055054], [0.1846160888671875], [0.1873358190059662], [0.18256525695323944], [0.08639243990182877], [0.08692169934511185], [0.08558501303195953], [0.08531808108091354], [0.08662986010313034], [0.08837326616048813], [0.08486619591712952], [0.08950383961200714], [0.08970676362514496], [0.09394521266222], [0.09540773183107376], [0.09466706961393356], [0.10300961881875992], [0.09333036094903946], [0.09910951554775238], [0.09894799441099167], [0.10193052142858505], [0.1001550555229187], [0.10635688900947571], [0.10161082446575165], [0.10181577503681183], [0.10108529776334763], [0.10780611634254456], [0.10152687877416611], [0.010961160063743591], [0.012410178780555725], [0.012154698371887207], [0.01208353042602539], [0.012524664402008057], [0.01134808361530304], [0.013623245060443878], [0.012407638132572174], [0.013606131076812744], [0.01387806236743927], [0.014267824590206146], [0.01420542597770691], [0.014587871730327606], [0.01555362343788147], [0.01473456621170044], [0.015148252248764038], [0.015140250325202942], [0.015332229435443878], [0.015769220888614655], [0.015284895896911621], [0.015339359641075134], [0.015260450541973114], [0.014026843011379242], [0.0151253342628479], [0.012995876371860504]];
        var y_entropy = [[0.8388679027557373, 1.0454906225204468], [0.588881254196167, 0.799222469329834], [0.7146312594413757, 0.6666354537010193], [0.525097131729126, 0.2792116701602936], [0.4740360975265503, 0.2327215075492859], [0.3730371594429016, 0.11317270994186401], [0.40059855580329895, 0.08437323570251465], [0.07533843070268631, 0.07877200841903687], [0.16657781600952148, 0.28573906421661377], [0.256686806678772, 0.3251763582229614], [0.26703378558158875, 0.30601951479911804], [0.31719669699668884, 0.7467178106307983], [0.5807417035102844, 0.9628517031669617], [0.6247609257698059, 0.9629743099212646], [0.6428923010826111, 0.9697844982147217], [0.32889634370803833, 1.0746521949768066], [0.9230574369430542, 1.0220978260040283], [0.9686814546585083, 1.028680443763733], [0.9544004797935486, 1.0357353687286377], [0.12800666689872742, 1.0683704614639282], [0.7351019978523254, 0.8837395310401917], [0.794933557510376, 0.8414500951766968], [0.8092938661575317, 0.8418998718261719], [0.05412791296839714, 0.9456831216812134], [0.9337120056152344, 0.9521854519844055], [0.9460927248001099, 0.9395022392272949], [0.946467399597168, 0.942973256111145], [0.028717609122395515, 0.6964605450630188], [0.8374988436698914, 0.9305054545402527], [0.9523524641990662, 0.8805105686187744], [0.956129789352417, 0.881142258644104], [0.027183016762137413, 0.5502902865409851], [0.7176843881607056, 0.9652999639511108], [0.8273984789848328, 0.9304094314575195], [0.8352996110916138, 0.9298157095909119], [0.02053411863744259, 0.46239370107650757], [0.7523044943809509, 1.0240830183029175], [0.8285828232765198, 0.9838213920593262], [0.843396782875061, 0.9799994230270386], [0.015925485640764236, 0.5294227004051208], [0.0003740849788300693, 0.024736540392041206], [5.52179517399054e-05, 0.06877738237380981], [4.80686139781028e-05, 0.1303231418132782], [0.0012071545934304595, 0.7778542041778564], [0.14830394089221954, 0.7723642587661743], [0.8597043752670288, 0.687277615070343], [0.8347839117050171, 0.6556473970413208], [0.816187858581543, 0.6659064888954163], [0.7800135612487793, 0.695845365524292], [0.6959901452064514, 0.6664548516273499], [0.7520840167999268, 0.6958205699920654], [0.7529096603393555, 0.6947624087333679], [0.7450605630874634, 0.6965384483337402], [0.3461839556694031, 0.4603988826274872], [0.5890936255455017, 0.685016393661499], [0.6443337798118591, 0.6616145968437195], [0.6954437494277954, 0.6954477429389954], [0.7083663940429688, 0.7018290162086487], [0.6793984174728394, 0.30259519815444946], [0.4717232286930084, 0.31083300709724426], [0.1818748265504837, 0.5902725458145142], [0.04727091267704964, 0.6855660080909729], [0.3018546402454376, 0.613779604434967], [0.2462843805551529, 0.2971375584602356], [0.00328943133354187, 0.07005634903907776], [0.0001087027631001547, 0.06625358760356903], [0.00062134163454175, 0.08124484121799469], [0.11893828958272934, 0.5961481332778931], [0.9003781080245972, 0.5195088982582092], [0.4556564688682556, 0.6381550431251526], [0.5157806873321533, 0.628008246421814], [0.741511344909668, 0.668588399887085], [0.863036036491394, 0.6463624238967896], [0.9433437585830688, 0.6244622468948364], [0.9996825456619263, 0.5944684743881226], [1.0363245010375977, 0.5698864459991455], [1.0604972839355469, 0.5484507083892822], [1.0765666961669922, 0.5294327735900879], [0.7274366617202759, 0.46485036611557007], [1.0640172958374023, 0.5073114633560181], [0.7101613283157349, 0.4862156808376312], [1.0248756408691406, 0.4923991560935974], [0.6928496956825256, 0.6480109095573425], [0.09850532561540604, 0.6878296732902527], [0.03372592851519585, 0.6811845898628235], [0.5276719331741333, 0.3089887499809265], [0.004952860530465841, 0.35135728120803833], [0.0058747450821101665, 0.5849654078483582], [2.8247495720279403e-06, 0.03506898507475853], [2.1578195230631536e-08, 0.06486452370882034], [0.0017583331791684031, 0.4731973707675934], [0.9983068704605103, 0.27170664072036743], [0.9227145314216614, 0.4948025941848755], [0.8218642473220825, 0.31103619933128357], [1.0364258289337158, 0.5211442112922668], [0.9309993982315063, 0.5717940926551819], [0.038165383040905, 0.6976488828659058], [1.0098228454589844, 0.5422982573509216], [0.264705628156662, 0.6979118585586548], [0.9409372806549072, 0.6238073706626892], [0.012268015183508396, 0.14871743321418762], [0.5846596360206604, 0.5768706202507019], [0.7429540157318115, 0.6897907257080078], [0.7566572427749634, 0.669605016708374], [0.7007244825363159, 0.6929424405097961], [0.26421529054641724, 0.6497388482093811], [0.6730409860610962, 0.1687225103378296], [0.5059413313865662, 0.5081724524497986], [0.47559669613838196, 0.31618553400039673], [0.5436365604400635, 0.6855471730232239], [0.002182240830734372, 0.3680756092071533], [0.0014133926015347242, 0.12448909878730774], [2.5215811092493823e-06, 0.0002036501537077129], [0.005927526392042637, 0.007454574108123779], [0.3238412141799927, 0.6072281002998352], [0.3291134238243103, 0.6946867108345032], [0.6163371205329895, 0.6945526599884033], [0.7958928346633911, 0.6905904412269592], [0.9095739722251892, 0.6879075765609741], [0.9925417900085449, 0.6767787337303162], [0.14104866981506348, 0.5905606746673584], [0.6345528364181519, 0.6896122694015503], [0.6747961044311523, 0.5681055188179016], [0.9959616661071777, 0.6956562399864197], [0.6244852542877197, 0.5834637880325317], [0.4959820806980133, 0.570870041847229], [0.7733227610588074, 0.7058743834495544], [0.21311797201633453, 0.7164835333824158], [0.8641072511672974, 0.6682761907577515], [0.14207185804843903, 0.6938460469245911], [0.7660578489303589, 0.38948071002960205], [0.7058382034301758, 0.3181062340736389], [0.21750082075595856, 0.45147818326950073], [0.012422476895153522, 1.040019833453698e-05], [0.0004845646908506751, 8.856520253175404e-06], [0.0014310189289972186, 0.000774140004068613], [2.253179900435498e-07, 0.5161445140838623], [4.679970152210444e-05, 0.0016091009601950645], [0.10159604251384735, 0.6225337982177734], [0.6998417973518372, 0.03960900008678436], [0.3436264395713806, 0.04353124275803566], [0.4807835817337036, 0.15649142861366272], [0.7156370878219604, 0.17644180357456207], [0.7555816173553467, 0.24367713928222656], [0.7224686145782471, 0.3629967272281647], [0.662975013256073, 0.4456949234008789], [0.626658022403717, 0.5209914445877075], [0.05289705842733383, 0.5320512056350708], [0.6584048867225647, 0.6776909232139587], [0.7189196348190308, 0.6875076293945312], [0.09542050957679749, 0.6056200861930847], [0.9166107773780823, 0.8706055879592896], [0.8067201375961304, 0.36348628997802734], [0.40783122181892395, 0.9586080312728882], [0.49596846103668213, 0.012104004621505737], [0.1663317084312439, 0.6145901083946228], [0.16993586719036102, 0.15228605270385742], [0.5819522738456726, 0.19283120334148407], [0.0031501182820647955, 0.0025430629029870033], [0.16357575356960297, 0.02781178243458271], [0.0038105526473373175, 0.2760463058948517], [0.01100844144821167, 0.5354745388031006], [0.6883244514465332, 0.5715745687484741], [0.5121102333068848, 0.5607051253318787], [0.7400282025337219, 0.8066320419311523], [0.6795175075531006, 0.6026215553283691], [0.7822149991989136, 0.7522165179252625], [0.7311301827430725, 0.6757520437240601], [0.7370505332946777, 0.888343334197998], [0.6886833906173706, 0.6915847063064575], [0.9508850574493408, 0.6507685780525208], [0.6666997671127319, 0.7859540581703186], [0.8108738660812378, 0.8986097574234009], [0.6035582423210144, 0.8293817043304443], [0.7939862012863159, 0.676035463809967], [0.8594460487365723, 0.6950041055679321], [0.4742005467414856, 0.9662830829620361], [0.5714256167411804, 0.7051701545715332], [0.0002290905686095357, 0.194578617811203], [0.0015485240146517754, 0.0020848882850259542], [0.0002010639145737514, 0.10457802563905716], [0.01439970638602972, 0.011543831788003445], [0.35051509737968445, 0.024885788559913635], [0.02649356797337532, 0.15756841003894806], [0.2514508068561554, 0.00015253051242325455], [0.00015649035049136728, 0.0005484659341163933], [5.390548452055555e-09, 0.5114089846611023], [2.3410575522575527e-07, 5.990679710521363e-06], [0.07123655825853348, 0.021019162610173225], [6.595049626412219e-07, 0.5957325100898743], [4.709923450718634e-05, 0.04793588072061539], [3.495088662930357e-08, 5.478376260725781e-05], [2.7985162631694038e-08, 0.00015258693019859493], [7.63702168171676e-09, 0.0003479384467937052], [9.534510070352553e-08, 0.00022760574938729405], [4.502937045458566e-08, 0.001858366304077208], [3.853062935377238e-08, 0.00010778483556350693], [2.1020811402649997e-07, 0.0035735899582505226], [1.1969907731668172e-08, 0.001920533599331975], [2.7012464443032513e-07, 0.0017879469087347388], [4.2540293065940205e-08, 0.019830839708447456], [1.0213580026174895e-06, 0.00502301100641489], [2.2978539643975227e-12, 0.008776558563113213]];
        var y_attention_weights = [];
        var y_action = [[[0.11477544158697128, 0.20787262916564941, 0.6773519515991211], [0.43164896965026855, 0.37896841764450073, 0.1893826276063919]], [[0.08415722101926804, 0.09265661239624023, 0.8231861591339111], [0.281370609998703, 0.6592221260070801, 0.059407271444797516]], [[0.11349393427371979, 0.1251438409090042, 0.7613621950149536], [0.19713056087493896, 0.7589786648750305, 0.04389083757996559]], [[0.844916582107544, 0.10978711396455765, 0.04529636725783348], [0.025027234107255936, 0.9364560842514038, 0.03851659223437309]], [[0.011877914890646935, 0.1435895711183548, 0.8445324897766113], [0.04861249774694443, 0.9450028538703918, 0.0063846237026154995]], [[0.016588181257247925, 0.08468787372112274, 0.8987240195274353], [0.02045086771249771, 0.9777098894119263, 0.0018392991041764617]], [[0.018706999719142914, 0.09302442520856857, 0.8882685899734497], [0.01423016656190157, 0.9844979643821716, 0.001271866145543754]], [[0.9866986274719238, 0.011810952797532082, 0.001490365481004119], [0.009929535910487175, 0.9865982532501221, 0.0034722245763987303]], [[0.02716575562953949, 0.007064060773700476, 0.9657701253890991], [0.07338855415582657, 0.9230390191078186, 0.003572362707927823]], [[0.062034282833337784, 0.0036971988156437874, 0.9342684745788574], [0.08604147285223007, 0.9087914824485779, 0.005166957154870033]], [[0.060992877930402756, 0.006207574158906937, 0.9327995777130127], [0.07905092090368271, 0.9162338376045227, 0.004715265240520239]], [[0.9097093343734741, 0.0870431512594223, 0.0032475001644343138], [0.10440535843372345, 0.7409501671791077, 0.15464447438716888]], [[0.11087913066148758, 0.06492064148187637, 0.8242002725601196], [0.4973803460597992, 0.3881143629550934, 0.11450531333684921]], [[0.15213899314403534, 0.053041741251945496, 0.7948192358016968], [0.5418304800987244, 0.3281087875366211, 0.13006064295768738]], [[0.15393008291721344, 0.05877325311303139, 0.7872966527938843], [0.5383042097091675, 0.32603931427001953, 0.135656476020813]], [[0.08493418246507645, 0.9086456894874573, 0.006420116405934095], [0.26907026767730713, 0.29335546493530273, 0.4375742971897125]], [[0.15115748345851898, 0.6163538694381714, 0.23248861730098724], [0.5071479678153992, 0.30183592438697815, 0.19101618230342865]], [[0.18833737075328827, 0.5805371403694153, 0.23112554848194122], [0.4805293083190918, 0.3377171754837036, 0.18175356090068817]], [[0.1855393350124359, 0.59488844871521, 0.21957217156887054], [0.4687882661819458, 0.34430134296417236, 0.18691037595272064]], [[0.023839635774493217, 0.9739977121353149, 0.002162659540772438], [0.23205719888210297, 0.3373403549194336, 0.43060243129730225]], [[0.08285363018512726, 0.740474283695221, 0.1766720712184906], [0.65155428647995, 0.14702333509922028, 0.20142234861850739]], [[0.0976950004696846, 0.7041820883750916, 0.19812287390232086], [0.6844359040260315, 0.14681681990623474, 0.1687472015619278]], [[0.10147567093372345, 0.694797694683075, 0.20372657477855682], [0.6839858293533325, 0.1456145942211151, 0.17039960622787476]], [[0.00870281271636486, 0.9908129572868347, 0.00048424332635477185], [0.13313624262809753, 0.2912929356098175, 0.575570821762085]], [[0.09773465245962143, 0.5238345265388489, 0.3784307837486267], [0.5655747652053833, 0.30134832859039307, 0.13307693600654602]], [[0.10174637287855148, 0.4984721839427948, 0.3997814655303955], [0.5799567103385925, 0.2908879816532135, 0.12915532290935516]], [[0.10196202248334885, 0.4981100261211395, 0.39992791414260864], [0.5780298709869385, 0.29013821482658386, 0.13183192908763885]], [[0.004094913601875305, 0.9956796765327454, 0.00022539084602613002], [0.07833810895681381, 0.1576916128396988, 0.7639702558517456]], [[0.12805059552192688, 0.6837224364280701, 0.18822695314884186], [0.6103759407997131, 0.2344965934753418, 0.1551274061203003]], [[0.16148599982261658, 0.589292049407959, 0.24922190606594086], [0.6487811803817749, 0.2195916324853897, 0.13162723183631897]], [[0.16423355042934418, 0.5862518548965454, 0.2495146095752716], [0.6483852863311768, 0.2195897400379181, 0.13202497363090515]], [[0.0039040192496031523, 0.9959270358085632, 0.00016897560271900147], [0.05758369714021683, 0.10532878339290619, 0.8370875120162964]], [[0.08974111080169678, 0.7550277709960938, 0.15523114800453186], [0.5843278765678406, 0.18917010724544525, 0.22650204598903656]], [[0.11904143542051315, 0.6885617971420288, 0.19239674508571625], [0.6174160242080688, 0.18708428740501404, 0.19549976289272308]], [[0.12143951654434204, 0.6832150816917419, 0.19534535706043243], [0.6178637146949768, 0.18551816046237946, 0.19661815464496613]], [[0.0028405385091900826, 0.997057318687439, 0.0001022178475977853], [0.043196190148591995, 0.0839436873793602, 0.8728600740432739]], [[0.07605937868356705, 0.7234709858894348, 0.20046967267990112], [0.5207903981208801, 0.24891825020313263, 0.23029133677482605]], [[0.09821724891662598, 0.6760358214378357, 0.22574691474437714], [0.5547015070915222, 0.274076908826828, 0.17122164368629456]], [[0.1014220267534256, 0.6646950244903564, 0.23388296365737915], [0.5569359064102173, 0.2764534652233124, 0.16661062836647034]], [[0.0021324828267097473, 0.9978037476539612, 6.374880467774346e-05], [0.05415719747543335, 0.09982986748218536, 0.8460130095481873]], [[3.296836439403705e-05, 0.9999669790267944, 2.7284762893486914e-08], [0.00249452400021255, 0.9965934157371521, 0.000912079238332808]], [[4.142341822443996e-06, 0.9999958276748657, 3.1710085668379406e-09], [0.0015235210303217173, 0.98817378282547, 0.010302728042006493]], [[3.5185469187126728e-06, 0.9999964237213135, 3.5955427524214656e-09], [0.013294327072799206, 0.9758657217025757, 0.01083991676568985]], [[0.0001204380314447917, 0.9998795986175537, 6.806552210747441e-09], [0.28081753849983215, 0.6681737899780273, 0.0510086826980114]], [[0.03342730179429054, 0.9663790464401245, 0.0001936714688781649], [0.4839891791343689, 0.49751368165016174, 0.018497223034501076]], [[0.5999206900596619, 0.0707477480173111, 0.32933151721954346], [0.5837380886077881, 0.4150613248348236, 0.001200649538077414]], [[0.5566105246543884, 0.04614206776022911, 0.39724743366241455], [0.6514917612075806, 0.34710678458213806, 0.0014014256885275245]], [[0.5149476528167725, 0.03413146734237671, 0.45092087984085083], [0.6319515705108643, 0.36686083674430847, 0.0011875410564243793]], [[0.42999985814094543, 0.023106036707758904, 0.5468940734863281], [0.5023466944694519, 0.49732810258865356, 0.00032510614255443215]], [[0.41857293248176575, 0.5789187550544739, 0.0025083490181714296], [0.6665719747543335, 0.32747212052345276, 0.0059558856301009655]], [[0.6582574248313904, 0.03363243490457535, 0.30811014771461487], [0.5374811291694641, 0.4617815613746643, 0.0007372611435130239]], [[0.6882882714271545, 0.04715152457356453, 0.2645602226257324], [0.545680820941925, 0.4535314738750458, 0.0007876833551563323]], [[0.6776350140571594, 0.03775539994239807, 0.2846095561981201], [0.4772922098636627, 0.5221429467201233, 0.0005648928927257657]], [[0.10982022434473038, 0.8901764750480652, 3.302155391793349e-06], [0.854075014591217, 0.13249798119068146, 0.013427031226456165]], [[0.8075217008590698, 0.04070165380835533, 0.1517767310142517], [0.5996946692466736, 0.39843887090682983, 0.0018663906957954168]], [[0.7809868454933167, 0.05084638670086861, 0.16816674172878265], [0.6523869633674622, 0.34494343400001526, 0.0026696037966758013]], [[0.7364611029624939, 0.04390905797481537, 0.21962980926036835], [0.4609763026237488, 0.5383241176605225, 0.0006995911826379597]], [[0.5059683322906494, 0.49161073565483093, 0.002420915989205241], [0.5820323824882507, 0.414048433303833, 0.00391921354457736]], [[0.582963228225708, 0.41703009605407715, 6.723985734424787e-06], [0.09000999480485916, 0.9099875092506409, 2.46270155912498e-06]], [[0.8198245763778687, 0.18016988039016724, 5.60491980650113e-06], [0.09361813962459564, 0.9063816070556641, 1.9506376247591106e-07]], [[0.9555443525314331, 0.044453829526901245, 1.821189584916283e-06], [0.277178019285202, 0.7228217720985413, 2.7330054308549734e-07]], [[0.9921379685401917, 0.0075404164381325245, 0.00032158452086150646], [0.5654163956642151, 0.43447592854499817, 0.0001077135166269727]], [[0.912367045879364, 0.000858978892210871, 0.08677400648593903], [0.2999200224876404, 0.699733555316925, 0.00034642076934687793]], [[0.06713314354419708, 1.0053410733235069e-05, 0.9328568577766418], [0.08765425533056259, 0.9123412370681763, 4.6020850277272984e-06]], [[0.00036911279312334955, 1.5297715094675368e-07, 0.9996306896209717], [0.9885836839675903, 0.006944234017282724, 0.00447211554273963]], [[8.011394129425753e-06, 4.157649868830049e-07, 0.9999915361404419], [0.9892753958702087, 0.0037616074550896883, 0.006962950807064772]], [[2.6266681743436493e-05, 2.7672169380821288e-05, 0.999946117401123], [0.9858710169792175, 0.0027993652038276196, 0.01132960431277752]], [[0.025384055450558662, 5.852735921507701e-05, 0.9745573997497559], [0.2832741439342499, 0.7167150974273682, 1.0657285201887134e-05]], [[0.4048093557357788, 0.07502447068691254, 0.5201662182807922], [0.20489966869354248, 0.7933613657951355, 0.0017389924032613635]], [[0.11700759828090668, 0.01979123242199421, 0.8632012009620667], [0.7495951056480408, 0.02237187698483467, 0.22803302109241486]], [[0.12797850370407104, 0.030809620395302773, 0.8412119150161743], [0.7625824213027954, 0.025006916373968124, 0.2124105989933014]], [[0.19330453872680664, 0.07542753964662552, 0.7312678694725037], [0.6845062375068665, 0.010236858390271664, 0.30525699257850647]], [[0.22070607542991638, 0.1202831119298935, 0.6590108275413513], [0.7153896689414978, 0.01179863978177309, 0.2728116810321808]], [[0.2381526082754135, 0.16215002536773682, 0.5996972918510437], [0.7448340058326721, 0.014807297848165035, 0.24035871028900146]], [[0.2482198178768158, 0.20381657779216766, 0.5479636788368225], [0.7766527533531189, 0.018318340182304382, 0.20502884685993195]], [[0.25719669461250305, 0.2384682297706604, 0.5043351054191589], [0.7992846369743347, 0.02157619781792164, 0.17913924157619476]], [[0.264999657869339, 0.2681637406349182, 0.4668366312980652], [0.8172789216041565, 0.0250125490128994, 0.15770845115184784]], [[0.27223271131515503, 0.29439929127693176, 0.43336793780326843], [0.8318674564361572, 0.02850116230547428, 0.13963131606578827]], [[0.5654666423797607, 0.008763883262872696, 0.42576950788497925], [0.8627671003341675, 0.11236481368541718, 0.02486809715628624]], [[0.2903052568435669, 0.45784470438957214, 0.25185003876686096], [0.8452985882759094, 0.03031146712601185, 0.12439000606536865]], [[0.6227603554725647, 0.010361334308981895, 0.36687833070755005], [0.8491045832633972, 0.12929889559745789, 0.02159658633172512]], [[0.2892865538597107, 0.5096394419670105, 0.20107406377792358], [0.8570440411567688, 0.03734491020441055, 0.10561101883649826]], [[0.5420642495155334, 0.00040403136517852545, 0.4575316905975342], [0.35064858198165894, 0.6493374705314636, 1.3929358829045668e-05]], [[0.020119495689868927, 9.033146142201076e-08, 0.9798803925514221], [0.551555335521698, 0.448444128036499, 5.322380047800834e-07]], [[0.005411127116531134, 6.759648840670707e-06, 0.9945821166038513], [0.5772033929824829, 0.42279621958732605, 4.0586195382275037e-07]], [[0.061822310090065, 0.0896480605006218, 0.8485296368598938], [0.0928083211183548, 0.9071915745735168, 6.837115051894216e-08]], [[0.0005782428197562695, 0.9994170665740967, 4.8128363232535776e-06], [0.11232660710811615, 0.8876730799674988, 3.163565054364881e-07]], [[0.0007121414528228343, 0.9992877840995789, 1.1264877031180731e-07], [0.2711080312728882, 0.7288337349891663, 5.82370012125466e-05]], [[1.8192442041709e-07, 0.9999997615814209, 5.687764842443599e-11], [0.9943830966949463, 0.0055503686890006065, 6.654130993410945e-05]], [[8.28178192691098e-10, 1.0, 1.9030611808634745e-10], [0.9880692362785339, 0.011907392181456089, 2.3286640498554334e-05]], [[0.00018280897347722203, 0.9998170733451843, 1.1328096150009515e-07], [0.17861513793468475, 0.8209240436553955, 0.00046083820052444935]], [[0.37099406123161316, 0.4846518933773041, 0.14435407519340515], [0.0766061469912529, 0.923261284828186, 0.00013254878285806626]], [[0.3377387225627899, 0.5610383749008179, 0.1012229323387146], [0.19478288292884827, 0.8050341606140137, 0.00018300965894013643]], [[0.39876168966293335, 0.040880236774683, 0.5603580474853516], [0.09324672818183899, 0.9066489338874817, 0.00010428241512272507]], [[0.4843439757823944, 0.19875289499759674, 0.31690317392349243], [0.21494534611701965, 0.7849861979484558, 6.846789619885385e-05]], [[0.4303126633167267, 0.08942633122205734, 0.480260968208313], [0.2579757869243622, 0.7419382929801941, 8.598593558417633e-05]], [[0.00625289510935545, 1.669965058681555e-05, 0.9937304258346558], [0.45105066895484924, 0.5476255416870117, 0.0013237892417237163]], [[0.44139644503593445, 0.41002005338668823, 0.14858347177505493], [0.2314385622739792, 0.7684279084205627, 0.00013353534450288862]], [[0.07175636291503906, 0.0008145170868374407, 0.9274290800094604], [0.5292186737060547, 0.4698907732963562, 0.0008904643473215401]], [[0.40330684185028076, 0.4986283481121063, 0.09806476533412933], [0.3146963119506836, 0.6852017045021057, 0.00010196124640060589]], [[0.0016573263565078378, 0.9983426332473755, 4.325870506249885e-08], [0.9665828347206116, 0.032989125698804855, 0.0004280454304534942]], [[0.8167970776557922, 0.1321033239364624, 0.05109959840774536], [0.2633570730686188, 0.7366130352020264, 2.9814947993145324e-05]], [[0.6959071159362793, 0.25841042399406433, 0.045682474970817566], [0.45539095997810364, 0.5445466041564941, 6.242494418984279e-05]], [[0.43804457783699036, 0.015575413592159748, 0.5463799834251404], [0.6103147864341736, 0.3895765542984009, 0.00010865519288927317]], [[0.7205581068992615, 0.24294248223304749, 0.03649940341711044], [0.48218196630477905, 0.5177768468856812, 4.1221792344003916e-05]], [[0.07394015789031982, 4.596625149133615e-05, 0.9260138869285583], [0.6491300463676453, 0.35066166520118713, 0.0002082468126900494]], [[0.647267758846283, 0.348273366689682, 0.004458846524357796], [0.04024510458111763, 0.9597548842430115, 2.1577394093696967e-08]], [[0.8092262148857117, 0.003788518952205777, 0.18698522448539734], [0.20567649602890015, 0.7943235039710999, 3.2202230215716554e-08]], [[0.18278811872005463, 0.8172118067741394, 9.112051913007235e-08], [0.9040089249610901, 0.09599094092845917, 1.0977282016710888e-07]], [[0.20427028834819794, 0.7893027663230896, 0.00642695976421237], [0.5615675449371338, 0.438432514667511, 7.144190572461184e-09]], [[0.00020009071158710867, 0.9997760653495789, 2.3871167286415584e-05], [0.8794217705726624, 0.12057828903198242, 1.5755743376644205e-08]], [[7.717144399066456e-06, 0.9998598098754883, 0.0001324107579421252], [0.9729064702987671, 0.027093539014458656, 4.352591620460089e-09]], [[3.39544259375657e-09, 0.9999998807907104, 1.567030949445325e-07], [0.9999833106994629, 1.5987756341928616e-05, 7.362683618339361e-07]], [[0.0006421252619475126, 0.9993058443069458, 5.2079423767281696e-05], [0.9990922212600708, 0.0008596653351560235, 4.8150657676160336e-05]], [[0.9064329266548157, 0.0029577615205198526, 0.09060925990343094], [0.7046694755554199, 0.2952932119369507, 3.732960612978786e-05]], [[0.9215909242630005, 0.03720567002892494, 0.04120334982872009], [0.4890558421611786, 0.5107428431510925, 0.00020126755407545716]], [[0.8006136417388916, 0.145053431391716, 0.05433287471532822], [0.5208396315574646, 0.4788925051689148, 0.000267900904873386]], [[0.7066934704780579, 0.18915750086307526, 0.1041489765048027], [0.555444598197937, 0.4440978765487671, 0.00045748025877401233]], [[0.6274988651275635, 0.22679631412029266, 0.14570489525794983], [0.5710986256599426, 0.4282459616661072, 0.0006554796709679067]], [[0.5503634810447693, 0.26491066813468933, 0.18472591042518616], [0.6063688397407532, 0.3927208483219147, 0.0009102833573706448]], [[0.03181266039609909, 4.602389708452392e-06, 0.9681826829910278], [0.7321677207946777, 0.2662942707538605, 0.0015380475670099258]], [[0.17324143648147583, 0.7821699976921082, 0.04458853229880333], [0.5971999764442444, 0.4002439081668854, 0.0025561016518622637]], [[0.3274773359298706, 0.0077774738892912865, 0.6647451519966125], [0.7643600106239319, 0.23118188977241516, 0.004458104260265827]], [[0.49771061539649963, 0.14607875049114227, 0.3562105596065521], [0.5120463371276855, 0.48761534690856934, 0.00033835205249488354]], [[0.14240455627441406, 0.7984651923179626, 0.059130311012268066], [0.2644982635974884, 0.734775185585022, 0.0007265812018886209]], [[0.16751794517040253, 0.007770369295030832, 0.8247117400169373], [0.7512935996055603, 0.2470482736825943, 0.001658103079535067]], [[0.20194000005722046, 0.7132577896118164, 0.08480210602283478], [0.459457665681839, 0.538026750087738, 0.0025155218318104744]], [[0.054620884358882904, 0.9452570676803589, 0.0001220725680468604], [0.4133623242378235, 0.579531729221344, 0.0071059223264455795]], [[0.19587741792201996, 0.6655930280685425, 0.13852952420711517], [0.63200443983078, 0.36637741327285767, 0.001618153415620327]], [[0.03210100531578064, 7.9113851825241e-06, 0.9678911566734314], [0.5712153911590576, 0.4271245300769806, 0.0016600169474259019]], [[0.7325677275657654, 0.13388685882091522, 0.1335453987121582], [0.13162599503993988, 0.8683729767799377, 1.013086489365378e-06]], [[0.7636760473251343, 0.09449022263288498, 0.14183367788791656], [0.9033469557762146, 0.0966014489531517, 5.156735278433189e-05]], [[0.9531775712966919, 0.013869213871657848, 0.03295322135090828], [0.16003163158893585, 0.0016217408701777458, 0.8383466601371765]], [[0.00023450861044693738, 0.0013437775196507573, 0.9984216690063477], [6.333157784865762e-07, 2.3189025810665953e-08, 0.9999992847442627]], [[1.9556455299607478e-05, 2.1546471543842927e-05, 0.999958872795105], [5.467579171636316e-07, 9.129436651100775e-10, 0.9999994039535522]], [[7.857374293962494e-05, 5.659259841195308e-05, 0.9998648166656494], [7.35929497750476e-05, 1.8611087782005598e-08, 0.9999263286590576]], [[6.876978986269933e-10, 1.1533484389758542e-08, 1.0], [0.21164663136005402, 9.82236088020727e-07, 0.7883523106575012]], [[3.40369729201484e-06, 6.933619012272629e-09, 0.999996542930603], [0.0001657499378779903, 1.858312437263976e-08, 0.9998341798782349]], [[0.020911801606416702, 2.0705258521047654e-06, 0.9790861010551453], [0.6872264742851257, 0.00014160209684632719, 0.31263190507888794]], [[0.40301477909088135, 0.592659056186676, 0.0043262275867164135], [0.9934606552124023, 3.131725679850206e-05, 0.00650807935744524]], [[0.913622260093689, 0.06387068331241608, 0.022507019340991974], [0.9927145838737488, 7.428808021359146e-05, 0.007211112417280674]], [[0.8548271059989929, 0.12026722729206085, 0.024905633181333542], [0.9636514186859131, 4.270434510544874e-05, 0.03630577772855759]], [[0.6323227286338806, 0.3541560173034668, 0.013521208427846432], [0.9574276804924011, 5.292966670822352e-05, 0.042519401758909225]], [[0.4850393235683441, 0.5013493895530701, 0.013611281290650368], [0.9342123866081238, 0.0001518148637842387, 0.06563577800989151]], [[0.3815854489803314, 0.6068094968795776, 0.011605014093220234], [0.8827427625656128, 0.00021541042951866984, 0.11704187095165253]], [[0.29848915338516235, 0.6912832260131836, 0.01022757776081562], [0.8374823927879333, 0.0002507113094907254, 0.16226695477962494]], [[0.2583458721637726, 0.7311047315597534, 0.010549329221248627], [0.7863624095916748, 0.00029765322688035667, 0.21334001421928406]], [[0.00932869128882885, 2.1598916077891772e-07, 0.9906711578369141], [0.77989661693573, 0.0007504334789700806, 0.21935290098190308]], [[0.32653865218162537, 0.6690247654914856, 0.004436556249856949], [0.40720313787460327, 0.00020849780412390828, 0.5925883650779724]], [[0.3586113750934601, 0.6276732683181763, 0.013715299777686596], [0.5646957755088806, 0.00033756025368347764, 0.43496668338775635]], [[0.019327322021126747, 7.176684562182345e-07, 0.9806719422340393], [0.7148808240890503, 0.0012246391270309687, 0.2838945686817169]], [[0.3402254581451416, 0.09698115289211273, 0.5627933144569397], [0.2909724712371826, 0.08885734528303146, 0.6201701164245605]], [[0.6275418400764465, 0.04977569356560707, 0.3226824104785919], [0.11502477526664734, 0.8841485977172852, 0.0008266299846582115]], [[0.10748538374900818, 0.8798167705535889, 0.012697761878371239], [0.5051947236061096, 0.11271675676107407, 0.3820885121822357]], [[0.19659985601902008, 2.804047653626185e-05, 0.8033720850944519], [0.0016318883281201124, 0.9983680844306946, 7.042246785715633e-10]], [[0.038458019495010376, 0.00037511668051593006, 0.9611668586730957], [0.303722083568573, 0.6962196230888367, 5.823398896609433e-05]], [[0.9657490253448486, 0.010033861733973026, 0.024217119440436363], [0.9698933959007263, 0.007752326782792807, 0.022354312241077423]], [[0.780307412147522, 0.20442567765712738, 0.015266920439898968], [0.045655470341444016, 0.9534239172935486, 0.0009205971146002412]], [[0.0002735975431278348, 0.9996675252914429, 5.886029975954443e-05], [0.9997312426567078, 1.7205762560479343e-05, 0.00025163698592223227]], [[0.03392850607633591, 0.9638965129852295, 0.0021750968880951405], [0.9957497119903564, 7.097446359694004e-05, 0.004179283045232296]], [[0.00043049477972090244, 3.1784784368937835e-06, 0.999566376209259], [0.07845627516508102, 0.00010557732457527891, 0.9214381575584412]], [[0.0014412093441933393, 1.1266703040746506e-05, 0.9985474944114685], [0.7928758859634399, 0.005491616670042276, 0.20163246989250183]], [[0.652238130569458, 0.009138950146734715, 0.33862292766571045], [0.8281703591346741, 0.10904408991336823, 0.0627855658531189]], [[0.8552401065826416, 0.06117860600352287, 0.08358129858970642], [0.8300960063934326, 0.11750306189060211, 0.052400898188352585]], [[0.7283552885055542, 0.20151911675930023, 0.07012556493282318], [0.6822578310966492, 0.2357080727815628, 0.08203412592411041]], [[0.6173840761184692, 0.38029009103775024, 0.0023258114233613014], [0.7094778418540955, 2.0236915077020967e-07, 0.2905219495296478]], [[0.5488773584365845, 0.4270896315574646, 0.02403305470943451], [0.5512816905975342, 0.4341277778148651, 0.014590545557439327]], [[0.5483062863349915, 0.44307515025138855, 0.008618514984846115], [0.7070715427398682, 0.2736823856830597, 0.01924600824713707]], [[0.46301424503326416, 0.009226364083588123, 0.5277594327926636], [0.4867554306983948, 0.44796714186668396, 0.0652773529291153]], [[0.393593966960907, 0.6035121083259583, 0.002893917029723525], [0.6561712622642517, 0.010811430402100086, 0.33301734924316406]], [[0.4755902886390686, 0.10239417850971222, 0.422015517950058], [0.7942913770675659, 0.1010126918554306, 0.10469601303339005]], [[0.36589792370796204, 0.632701575756073, 0.0014004792319610715], [0.66462242603302, 0.2813684940338135, 0.054009128361940384]], [[0.5055169463157654, 0.031714897602796555, 0.4627681076526642], [0.5335352420806885, 0.3902362883090973, 0.07622838765382767]], [[0.27732032537460327, 0.7207850217819214, 0.001894598943181336], [0.6904129385948181, 0.17955292761325836, 0.13003402948379517]], [[0.6638485193252563, 0.27754753828048706, 0.05860386788845062], [0.5999964475631714, 0.3996238112449646, 0.00037973467260599136]], [[0.6258887648582458, 0.08327120542526245, 0.2908400595188141], [0.4662206470966339, 0.5332571268081665, 0.0005222215550020337]], [[0.17548340559005737, 0.001305928803049028, 0.8232106566429138], [0.421560138463974, 0.46557730436325073, 0.11286257207393646]], [[0.2450965940952301, 0.7527886033058167, 0.00211480725556612], [0.5816024541854858, 0.00461742514744401, 0.41378018260002136]], [[1.9345967302797362e-05, 2.8006854613238374e-09, 0.9999806880950928], [0.0485793836414814, 2.301600579812657e-05, 0.9513976573944092]], [[0.00010245701560052112, 4.596402868628502e-05, 0.9998515844345093], [0.00022095027088653296, 2.5135449277513544e-07, 0.9997788071632385]], [[1.7650262407187256e-06, 1.4492115951725282e-05, 0.9999837875366211], [0.0021528901997953653, 0.9800729155540466, 0.017774172127246857]], [[0.0007905549718998373, 0.0010081531945616007, 0.9982012510299683], [0.0012432086514309049, 0.00020953983766958117, 0.9985472559928894]], [[0.11085932701826096, 0.8889012932777405, 0.0002393653558101505], [1.3978395145386457e-05, 0.003754508448764682, 0.9962314963340759]], [[1.3651023436977994e-05, 0.004045204725116491, 0.995941162109375], [3.004044083354529e-05, 0.036674268543720245, 0.9632956981658936]], [[1.532256464997772e-05, 0.9308992624282837, 0.06908536702394485], [2.3682581229422794e-08, 1.2363509085844271e-05, 0.9999876022338867]], [[6.675379609077936e-07, 0.9999873638153076, 1.1867777175211813e-05], [1.4687917655464844e-06, 4.8203870392171666e-05, 0.9999502897262573]], [[1.6394871571456804e-10, 1.0, 7.267247220665851e-11], [1.3720501556235831e-05, 0.2079627960920334, 0.7920235395431519]], [[1.1934737642604887e-08, 1.0, 7.806353896633311e-10], [5.9345719449765966e-09, 0.9999996423721313, 3.989473498222651e-07]], [[4.68298022582303e-09, 0.01343232300132513, 0.9865676164627075], [2.1471984723575588e-07, 0.003102358430624008, 0.9968974590301514]], [[3.711483387291992e-08, 1.0, 1.1922696163679802e-09], [0.0007881895289756358, 0.27644839882850647, 0.7227634787559509]], [[2.9888626296159515e-11, 3.4407332805130864e-06, 0.999996542930603], [9.008334522775385e-09, 0.9917206764221191, 0.00827928725630045]], [[1.7310995970021281e-09, 1.0, 9.688724432119211e-13], [2.1692412701668218e-06, 1.7077683196475846e-06, 0.9999960660934448]], [[5.0248003674591146e-11, 1.3099915596725964e-09, 1.0], [5.208829634284484e-08, 0.9999877214431763, 1.232455724675674e-05]], [[3.4771621693074906e-10, 1.0, 2.3874309647287095e-12], [2.7685480745276436e-05, 2.1308965187927242e-06, 0.9999701976776123]], [[2.2255279563676567e-10, 4.715014156886355e-09, 1.0], [1.6441775585462892e-07, 0.9999809265136719, 1.894063643703703e-05]], [[2.2514279329755027e-09, 1.0, 7.804469744077114e-12], [0.00013215855869930238, 5.007841900805943e-05, 0.9998177886009216]], [[7.583196848237606e-10, 1.0956814344709187e-09, 1.0], [8.232996151491534e-07, 0.9999916553497314, 7.466651368304156e-06]], [[1.1453229475932858e-08, 1.0, 3.254344710379442e-11], [0.0003960107860621065, 5.751866865466582e-06, 0.9995982050895691]], [[2.017704059387171e-10, 3.4254352132556676e-10, 1.0], [6.968681191210635e-06, 0.9998015761375427, 0.00019151359447278082]], [[1.493517665096533e-08, 1.0, 4.182568180688406e-11], [0.0001853996654972434, 6.210732408362674e-07, 0.999813973903656]], [[1.1204203120840361e-09, 9.354965690988593e-10, 1.0], [4.907976108370349e-05, 0.9971440434455872, 0.002806804608553648]], [[6.129480567551582e-08, 0.9999998807907104, 1.503275975922591e-10], [0.000594438926782459, 8.874733339325758e-07, 0.9994046688079834]], [[5.974571288007088e-14, 1.5039412179810793e-14, 1.0], [3.808148903772235e-06, 0.0011194198159500957, 0.9988767504692078]]]; // action probs
        var action =  [[1, 2], [2, 0], [2, 1], [0, 1], [2, 1], [0, 1], [2, 1], [0, 1], [2, 1], [0, 1], [0, 1], [0, 1], [2, 1], [2, 1], [2, 0], [1, 1], [1, 1], [2, 1], [0, 1], [1, 1], [1, 0], [1, 2], [1, 0], [1, 2], [2, 2], [1, 0], [1, 2], [1, 1], [1, 2], [1, 0], [2, 0], [1, 2], [1, 0], [1, 1], [2, 0], [1, 2], [1, 0], [0, 0], [1, 0], [1, 0], [1, 1], [1, 1], [1, 1], [1, 0], [1, 0], [0, 0], [0, 0], [0, 1], [2, 0], [1, 1], [0, 1], [0, 0], [2, 0], [1, 0], [0, 0], [0, 1], [2, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 0], [0, 1], [2, 1], [2, 0], [2, 2], [2, 0], [2, 0], [0, 1], [0, 0], [2, 0], [2, 0], [2, 0], [2, 0], [2, 0], [0, 0], [0, 0], [1, 0], [2, 0], [1, 0], [2, 0], [1, 0], [0, 1], [2, 0], [2, 0], [2, 1], [1, 1], [1, 1], [1, 0], [1, 0], [1, 0], [0, 1], [1, 1], [0, 1], [0, 1], [1, 0], [2, 0], [1, 1], [2, 0], [2, 0], [1, 0], [0, 0], [1, 1], [2, 1], [1, 0], [2, 0], [0, 1], [2, 1], [1, 0], [1, 1], [1, 0], [1, 0], [1, 0], [1, 0], [0, 1], [0, 1], [0, 1], [0, 1], [0, 0], [1, 1], [2, 0], [1, 1], [0, 1], [2, 1], [1, 0], [2, 0], [2, 1], [1, 0], [1, 1], [2, 0], [0, 1], [0, 0], [0, 2], [2, 2], [2, 2], [2, 2], [2, 0], [2, 2], [2, 0], [1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 0], [2, 0], [0, 0], [1, 0], [2, 2], [0, 2], [2, 1], [1, 2], [2, 1], [2, 1], [0, 0], [0, 1], [1, 0], [1, 0], [2, 2], [2, 2], [0, 0], [0, 0], [0, 1], [0, 2], [0, 0], [1, 0], [2, 1], [1, 2], [2, 0], [1, 0], [2, 0], [0, 2], [1, 0], [0, 1], [2, 1], [1, 0], [2, 0], [2, 2], [2, 1], [2, 2], [1, 2], [2, 2], [1, 2], [1, 2], [1, 2], [1, 1], [2, 2], [1, 2], [2, 1], [1, 2], [2, 1], [1, 2], [2, 1], [1, 2], [2, 1], [1, 2], [2, 1], [1, 2], [2, 1], [1, 2], [2, 2]];
        var action_names = [['no-op', 'left', 'right'], ['no-op', 'up', 'down']];
        var x_values = [...Array(y_values.length).keys()];

        var y_entropy_plot = [];
        var y_values_plot = [];

        // Set marker for plots
        var entropy_marker = false;
        var value_marker = false;

        // Set the to be shown statistic
        var statistic_type = 'general'
        // Only used for the transformer plot to show the correct statistic with tab switching
        var statistic_plot_id = 0;
        // Hide statistic type button if there is no attention weights
        if(y_attention_weights.length == 0) stats_button.style.display = 'none';

        // Set the to be shown action_space(s) for the entropy plot
        var entr_selected_action_space = null;

        var is_multi_discrete = action[0].length != 1;
        var is_discrete = action[0].length == 1;

        // Reformat the data for the plots
        // Each function y - value should be stored in a separate array
        for(var j = 0; j < y_values[0].length; j++)
            for(var i = 0; i < y_values.length; i++)
                y_values_plot.push(y_values[i][j]);

        if(is_discrete) { // If action_space is discrete
          for(var j = 0; j < y_entropy[0].length; j++)
              for(var i = 0; i < y_values.length; i++)
                  y_entropy_plot.push(y_entropy[i][j]);
        }
        else { // If action_space is multi discrete
          for(var j = 0; j < y_entropy[0].length; j++) {
            var y_entropy_vals = [];
            for(var i = 0; i < y_entropy.length; i++) {
                y_entropy_vals.push(y_entropy[i][j]);
            }
            y_entropy_plot.push(y_entropy_vals);
          }
        }

        // Set action_names for distr. plot if it does not exist
        if(action_names == null){
          action_names = [];
          for(var i = 0; i < y_action[0].length; i++){
            for(var j = 0; j < y_action[0][0].length; j++)
              if(is_discrete){ // if action space is discrete
                action_names.push("action_" + String(j));
            }
            else { // if action space is multi_discrete
              var action_branch_names = []; // Names of the branches of the action space
              for(var j = 0; j < y_action[0][i].length; j++){
                action_branch_names.push("action_" + String(j));
              }
              action_names.push(action_branch_names);
            }     
          }
        }
        else{
          if(action[0].length == 1 && Array.isArray(action_names[0])){ // If action space is discrete and action_names is multi_discrete
            action_names = action_names[0]; // Set action_names to the first branch of the action space
          }
        }

        // Modify dropdown menu
        if(is_discrete){ // if action space is discrete
          document.getElementById("all").outerHTML=""; // remove dropdown option 'all'
        }
        else { // If action space is multi_discrete
          // Create dropdown menu for the entropy function
          var dropdown_content = document.getElementById("dropdown_content"); 
          for(var i = 0; i < action[0].length; i++){
            var entropy_dropdown_option = document.createElement("a");
            entropy_dropdown_option.innerHTML = "action_space_" + String(i);
            entropy_dropdown_option.setAttribute("href", "#");
            entropy_dropdown_option.setAttribute("onclick", "set_action_space(" + String(i) + ")");
            dropdown_content.appendChild(entropy_dropdown_option);
          }
        }

        window.addEventListener('load', () => {
          // Set video length to length - 0.9999 because the last frame is two seconds long
          video_length = video_player.duration - 0.9999;
          time_selector.setAttribute('max', video_length); // Set max value of time selector to video length

          video_player.addEventListener('timeupdate', timeListener); // Update time selector and plots when video is playing
          video_player.addEventListener('dblclick', function(e) {open_fullscreen(video_player);}); // Open video in fullscreen when video is double clicked
          video_player.playbackRate = 6; // Set video playback rate to frame rate
          reset(); // Reset video to start
        }, false);
      
      // Update video time if time selector is changed
      time_selector.addEventListener('input', () => {
          video_player.currentTime = time_selector.value
          pause();
          update();
      })

      // Add event manager for tab
      window.addEventListener('keydown', function(event) {
          if (event.key === 'Tab') {
              if (statistic_type == "transformer") {
                statistic_plot_id = (statistic_plot_id + 1) % 3;
                // Set action plot if statistic_plot_id is 0
                if(statistic_plot_id == 0){
                  // Update action plot
                  if(is_discrete) { // If action_space is discrete
                    set_bar_action_plot(y_action[step][0], action[step][0], action_names);
                  }
                  else { // If action_space is multi discrete
                      set_stacked_bar_action_plot(y_action[step], action[step], action_names);
                  }
                }
                // Set value plot if statistic_plot_id is 1
                if (statistic_plot_id == 1) {
                  set_scatter_line_plot('action_distr', "Value Function", y_values_plot, step, value_marker);
                }

              // Set entropy plot if statistic_plot_id is 2
              if (statistic_plot_id == 2) {
                  if(is_discrete) { // If action_space is discrete
                      set_scatter_line_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
                  else { // If action_space is multi discrete
                      set_scatter_lines_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
              }
          }
      }
    });

    // Show ground truth if checkbox is checked
    function show_ground_truth() {
        // Get the checkbox element by its ID
        var checkbox = document.getElementById("show_ground_truth");
        
        // Check if the checkbox is checked
        if (checkbox.checked) { // Show the ground truth
          if (video_id == render_id) video_id = render_gt_id;
          if (video_id == render_decoder_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else {
          if (video_id == render_gt_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_agent_id;
          set_video(video_path[video_id]);
        }
      }

    // Show decoder video if checkbox is checked
    function show_decoder_video() {
      var checkbox = document.getElementById("show_decoder_video");
      document.getElementById("show_agent_video").checked = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_decoder_id;
          if (video_id == render_gt_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_decoder_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide decoder video
          if (video_id == render_decoder_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Show agent video if checkbox is checked
    function show_agent_video() {
      var checkbox = document.getElementById("show_agent_video");
      document.getElementById("show_decoder_video").checked  = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_agent_id;
          if (video_id == render_gt_id) video_id = render_agent_gt_id;
          if (video_id == render_decoder_id) video_id = render_agent_id;
          if (video_id == render_decoder_gt_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide agent video
          if (video_id == render_agent_id) video_id = render_id;
          if (video_id == render_agent_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Set the video to the given path
    function set_video(path) {
        // Get video data to make the switch seamless
        var current_time = video_player.currentTime;
        var play_back_rate = video_player.playbackRate;
        var is_paused = video_player.paused;
        video_player.querySelector("source").src = path;
        // Reload video
        video_player.load();
        video_player.currentTime = current_time;
        video_player.playbackRate = play_back_rate;
        if(is_paused) pause();
        else play();
    }


      /**
      * Update time selector and plots when video is playing
      */
      function timeListener() {
        if(!video_player.paused) {
          update();
        } 
      }

      /**
      * Toggles button and video between playing and paused
      */
      function play_pause() {
        if(video_player.paused)
          play();
        else 
          pause();
      }

      /**
       * Returns to the previous frame step
       */
       function return_to_step() {
        video_player.currentTime = past_steps.pop();
        pause();
        update();
        gotostep_text.value = step;
        return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Updates the plots and time selector
       */
       function go_to_step(event) {
        if (event.keyCode === 13) {
          past_steps.push(step);
          video_player.currentTime = Number(gotostep_text.value);
          pause();
          update();
          gotostep_text.value = step;
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
        }
      }

      function set_video_speed(event) {
        if (event.keyCode === 13) {
          video_player.playbackRate = Number(video_speed.value);
        }
      }

      /**
       * Updates the plots and time selector
       */
       function top_scores() {
        if (event.keyCode === 13) update()
      }

      /**
      * Pauses video
      */
      function pause() {
          play_pause_button.innerHTML = "Play";
          video_player.pause();
      }

      /**
      * Plays the video
      */
      function play() {
          play_pause_button.innerHTML = "Pause";
          video_player.play();
      }

      /**
      * Resets the video and plots to the start
      */
      function reset() {
          video_player.currentTime = 0;
          past_steps.push(step);
          pause();
          update();
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the previous frame
      */
      function back() {
          video_player.currentTime = video_player.currentTime - tS_step_size
          pause();
          update();
          past_steps.push(step + 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the next frame
      */
      function next() {
          video_player.currentTime = video_player.currentTime + tS_step_size;
          pause();
          update();
          past_steps.push(step - 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Switches between general and transformer statistics
       */
       function statistic() {
        if (stats_button.innerHTML == "General") {
          statistic_type = "general";
          stats_button.innerHTML = "Transformer";
        }
        else if (stats_button.innerHTML == "Transformer") {
          statistic_type = "transformer";
          stats_button.innerHTML = "General";
        }
        update();
      }
      /**
      * Opens the video in fullscreen
      */
      function open_fullscreen(vid_elem) {
          if (vid_elem.requestFullscreen) {
              vid_elem.requestFullscreen();
          } else if (vid_elem.webkitRequestFullscreen) { /* Safari */
              vid_elem.webkitRequestFullscreen();
          } else if (vid_elem.msRequestFullscreen) { /* IE11 */
              vid_elem.msRequestFullscreen();
          }
          vid_elem.pause();
      }

      // Selects the action space for the entropy plot
      function set_action_space(spaces){
        if (spaces == 'all')
          entr_selected_action_space = null;
        else
          entr_selected_action_space = Number(spaces);
        update();
      }

      function marker(marker_id){
        if(marker_id == "entropy")
          entropy_marker = !entropy_marker;
        else if(marker_id == "value")
          value_marker = !value_marker;
        update();
      }

      /**
      * Updates the plots and time selector
      */
      function update()  {
        if(video_player.currentTime == Math.round(video_player.currentTime)) // If time t of video is a natural number then step is t - 1
              video_player.currentTime += 0.0001 // Add a small number to make sure that the step and the current time are the same
        if(video_player.currentTime > video_length) {
           video_player.currentTime = video_length;
           pause();
        } // Video can't go past the end
        time_selector.value = video_player.currentTime; // Update time selector
        step = Math.floor(video_player.currentTime); // Get step of video for plots

        // Update plots
        if (statistic_type == "general")
          render_general_statistics();
        else if (statistic_type == "transformer")
          render_transformer_statistics();

        if(statistic_type == "general") {
          // Reset plot id
          statistic_plot_id = 0;
          // Update action plot
          if(is_discrete) { // If action_space is discrete
            set_bar_action_plot(y_action[step][0], action[step][0], action_names);
          }
          else { // If action_space is multi discrete
              set_stacked_bar_action_plot(y_action[step], action[step], action_names);
          }
        }
      }

      /**
      * Renders the general statistics
      */
      function render_general_statistics() {
        // Disables the transformer statistics and enables the general statistics
          document.getElementById('transformer').style.display = 'none';
          document.getElementById('top_n_scores').style.display = 'none';
          document.querySelector('label[for="top_n_scores"]').style.display = 'none';
          document.getElementById('value_func').style.display = 'block';
          document.getElementById('entropy_func').style.display = 'block';
          document.getElementById('options').style.display = 'block';
        // Updates the plots
          set_scatter_line_plot('value_func', "Value Function", y_values_plot, step, value_marker);
          if(is_discrete) { // If action_space is discrete
              set_scatter_line_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
          else { // If action_space is multi discrete
              set_scatter_lines_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
        }
      
      /*
      * Renders the transformer statistics
      */
      function render_transformer_statistics() {
        // Disables the general statistics and enables the transformer statistics
        document.getElementById('transformer').style.display = 'block';
        document.getElementById('top_n_scores').style.display = 'block';
        document.querySelector('label[for="top_n_scores"]').style.display = 'block';
        document.getElementById('value_func').style.display = 'none';
        document.getElementById('entropy_func').style.display = 'none';
        document.getElementById('options').style.display = 'none';
        // Updates the plots
        var top_n = Number(top_n_scores.value);
        if (top_n == -1) top_n = step;
        visualizeAttentionScores(y_attention_weights[step], top_n);
        }


      /**
       * Renders attention scores
      */
      async function visualizeAttentionScores(attentionScores, n_values) {
        const numHeads = attentionScores.length;
        
        let data = [];
        let layout = {
          grid: {
              rows: numHeads, 
              columns: 1, 
              pattern: 'independent',
              subplots: [...Array(numHeads).keys()].map(i => `xy${i + 1}`),
              ygap: 0.4 // adjust this value according to your preference
          },
          plot_bgcolor: '#000',
          paper_bgcolor: '#000',
          font: {
              family: 'Montserrat',
              size: 12,
              color: '#fff'
          },
          margin: {
              t: 0,  // reduce top margin
          },
      }

        // Flatten the array to find the max value across all arrays
        let flatScores = attentionScores.flat();
        let maxScore = Math.max(...flatScores);

        // Iterate through each attention head
        for (let headIdx = 0; headIdx < numHeads; headIdx++) {
            // Get attention scores for the current head
            let headScores = attentionScores[headIdx];
            
            // This array will keep up to the 10 highest scores
            let topScores = [];

            for (let i = 0; i < headScores.length; i++) {
                // Insert current score into the top scores array
                topScores.push({score: headScores[i], index: i});
                
                // Sort the top scores array
                topScores.sort((a, b) => b.score - a.score);

                // If there are more than 10 scores, remove the smallest
                if (topScores.length > n_values) {
                    topScores.pop();
                }
            }

            // Sort the topScores array by index
            topScores.sort((a, b) => a.index - b.index);

            // Now topScores contains the top 10 scores sorted by their indices.
            // You can extract the scores and their indices into separate arrays:
            let filteredHeadScores = topScores.map(x => x.score);
            let filteredTicks = topScores.map(x => x.index);


            const sequenceLength = filteredHeadScores.length;

            layout.height = 400;
            layout.width = window.innerWidth;

            const headScoresPlot = {
                z: [filteredHeadScores],
                type: 'heatmap',
                showscale: true,  
                colorscale: 'Hot',
                zmin: 0,
                zmax: maxScore,
                xaxis: `x${headIdx + 1}`,
                yaxis: `y${headIdx + 1}`,
            };

            data.push(headScoresPlot);

            layout[`xaxis${headIdx + 1}`] = {
                tickmode: 'array',
                tickvals: Array.from({length: sequenceLength}, (_, i) => i),
                ticktext: filteredTicks
            };

            layout[`yaxis${headIdx + 1}`] = {
                title: `Block ${headIdx + 1}`,
                ticks: 'outside',
                tick0: 0,
                dtick: 1,
                ticklen: 8,
                tickwidth: 4,
                tickcolor: '#000'
            };
        }

        const config = {responsive: true};

        Plotly.newPlot('transformer', data, layout, config).then(function() {
          var myPlot = document.getElementById('transformer');
          myPlot.on('plotly_click', function(data){
            // Jump to the step that was clicked
              past_steps.push(step);
              video_player.currentTime = Number(data.points[0].xaxis.ticktext[data.points[0].x]);
              pause();
              update();
              return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      });
    }

      /** 
      * Sets a stacked bar plot for the multi discrete action distribution
      * @param {array} y_values - The action distribution
      * @param {array} action - The action
      * @param {array} action_names - The names of the actions
      */
      function set_stacked_bar_action_plot(y_values, action, action_names) {
        var bar_plot_data_action = [];
        // Set data for each action
        for(var j = 0; j < action_names[0].length; j++) {
            var color = ""
            for(var i = 0; i < action_names.length; i++) {
                if(action[i] == j) // If action sampled in the current frame
                    color = '#FF0000'; // Color it red
                else
                    color = '#FAEBD7'; // Color it white
                var trace = {
                    x: [["action_space_", String(i)].join("")],
                    y: [y_values[i][j]],
                    text: [y_values[i][j], action_names[i][j]].map(String).join("<br>"), // Add action name and prob to the bar
                    marker: {
                        color: color,
                        line: {
                            color: '#000000',
                            width: 1
                          }
                    },
                    type: 'bar'
                };
                bar_plot_data_action.push(trace);
            }
        }

        // Set layout for the plot
        var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            barmode: 'stack',
            showlegend: false
      };

      // Plot the data
      Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }

      /**
      * Sets a bar plot for the discrete action distribution
      */
      function set_bar_action_plot(y_values, action, action_names) {

          var color_value = new Array(y_values.length).fill('#FAEBD7'); // Set color for all actions to white
          color_value[action] = '#FF0000'; // Except the selected action should be red
          // Set data for the plot
          var bar_plot_data_action = [
              {
                  x: action_names,
                  y: y_values,
                  type: 'bar',
                  marker: {
                      color: color_value
                  },
                  textposition: 'auto',
                  text: y_values.map(String), // Add prob to the bar plot
                  textfont: {
                      family: 'Montserrat',
                      size: 12,
                  },
                  textangle: 0,
                  textposition: 'bottom center',
              }
          ];

          // Set layout for the plot
          var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            yaxis: {
              automargin: true,
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            }
      };
          
          // Plot the action distribution
          Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }


      /**
      * Sets a scatter plot for the emtropy function if multi discrete actions are used
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The entropy function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_lines_plot(id, title, y_values, step, marker) {
        line_scatter_plot_data_value = [];

        // Set colors and data for the plot
        var colors = ['#FAEBD780', '#7CFC0080', '#FFBF0080', '#FF7F5080', '#DE316380', '#9FE2BF80', '#40E0D080', '#6495ED80', '#CCCCFF80']
        for(var i = 0; i < y_values.length; i++) {
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values[i].slice(0, step + 1);
            var trace = [
            {
                x: x_values_marker,
                y: y_values_marker,
                mode: 'line',
                line: {
                    color: colors[i]
                },
                name: 'action_space_' + String(i),
                showlegend: true,
            },
            {
                x: x_values,
                y: y_values[i],
                mode: 'markers',
                name: 'action_space_' + String(i) + "_marker",
                marker: {
                    color: colors[i]
                },
                showlegend: true,
            }
        ];
            // Add data to the plot
            line_scatter_plot_data_value.push(trace[0]);
            if(marker)
              line_scatter_plot_data_value.push(trace[1]); 
        }

        // Select the selected action_space for the entropy plot
        if(entr_selected_action_space != null && marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space * 2], line_scatter_plot_data_value[entr_selected_action_space * 2 + 1]];
        else if(entr_selected_action_space != null && !marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space]];

        // Set layout for the plot
        var line__scatter_plot_layout_value = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 50,
                r: 0,
                b: 30,
                t: 25,
                pad: 4
                },
            yaxis: {
                automargin: true
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: title,
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            showlegend: true,
        };

        // Plot the data
        Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);
      }


      /**
      * Sets a scatter plot for the value function
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The value function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_line_plot(id, title, y_values, step, marker) {
          // Set data for layout for the plot
          var line__scatter_plot_layout_value = {
              autosize: true,
              width: 600,
              height: 360,
              margin: {
                  l: 50,
                  r: 0,
                  b: 30,
                  t: 25,
                  pad: 4
                  },
              yaxis: {
                  automargin: true
              },
              plot_bgcolor: '#000',
              paper_bgcolor: '#000',
              font: {
                  family: 'Montserrat',
                  size: 12,
                  color: '#fff'
              },
              title: {
                  text: title,
                  font: {
                      family: 'Montserrat',
                      size: 15,
                      color: '#fff'
                  }
              },
              showlegend: false,
          };

          // Set data for the plot
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values.slice(0, step + 1);

          var line_scatter_plot_data_value = [
              {
                  x: x_values_marker,
                  y: y_values_marker,
                  mode: 'line',
                  line: {
                      color: '#FAEBD7'
                  },
                  name: 'function',
              },
              {
                  x: x_values,
                  y: y_values,
                  mode: 'markers',
                  marker: {
                      color: '#7CFC0080'
                  },
                  name: 'marker',
              }
          ];

          if(!marker)
            line_scatter_plot_data_value = [line_scatter_plot_data_value[0]];

          // Plot the value function
          Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);
      }
    
    /**
    * Opens the specific tab based on the probided id
    * @param {string} id - The id of the tab
    */
    function openTab(evt, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        mediatabcontent = document.getElementsByClassName("mediatabcontent");
        // Hide all elements with class="tabcontent" and "mediacontent" by default
        for (i = 0; i < mediatabcontent.length; i++) {
            mediatabcontent[i].style.display = "none";
        }
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        // Show the specific tab content
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(id).style.display = "block";
        evt.currentTarget.className += " active";
      }
    </script>
  </body>
</html>