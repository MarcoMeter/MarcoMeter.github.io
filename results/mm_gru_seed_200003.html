<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;500&display=swap" rel="stylesheet"/>
    <script src="template/cdn.plot.ly_plotly-2.6.3.min.js"></script>
    <style>
     /* Style the body */
      html, body {
        height: 100%;
        margin: 0;
        background-color: #000;
        color: white;
        font-family: "Montserrat", sans-serif;
        min-width: 1737px;
      }

      /* Set the width and hight of the video*/
      video {
        width: 600px;
        height: 400px;
      }

      /* Style the timeline text*/
      #selector_header {
        font-weight: 200;
      }

      /* Buttons should be displayed in a row */
      buttonrow {
        display: inline;
      }

      /* Style the figures */
      #figures {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        flex-flow: row nowrap;
      }

      /* Style the tab */
      .tab {
        overflow: hidden;
        background-color: #54595f;
      }

      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
        color: white;
      }

      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #909090;
      }

      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #838383;
      }

      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border-top: none;
        background-color: #000;
      }

      .mediatabcontent {
        display: none;
        padding: 0 px 0 px;
        border-top: none;
        background-color: #000;
        width: 100%;
        height: 100%;
      }

      /* Style the close button */
      .topright {
        float: right;
        cursor: pointer;
        font-size: 28px;
      }

      .topright:hover {
        color: red;
      }

      /* Style of the dropdown button */
      .dropbtn {
        background-color: #17202A;
        color: white;
        padding: 16px;
        font-size: 16px;
        border: none;
      }
      
      .dropdown {
        position: relative;
        display: inline-block;
      }
      
      /* Style of the dropdown content */
      .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        background-color: #A6ACAF;
        z-index: 1;
      }
      
      .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
      }

      .gotostepcontainer {
          margin-bottom: 10px;
      }
      
      #score-container label, #score-container input {
        display: inline-block;
      }

      /* Style of the dropdown at hover */
      .dropdown-content a:hover {background-color: #ddd;}
      
      .dropdown:hover .dropdown-content {display: block;}
      
      .dropdown:hover .dropbtn {background-color: #161515;}
    </style>
  </head>
  <body>
    <!--- Define tabs -->
    <div class="tab">
      <button class="tablinks" onclick="location.href='../index.html'">Back</button>
      <button class="tablinks" onclick="openTab(event, 'Environment')">Environment</button>
      <button class="tablinks" onclick="openTab(event, 'Sampler')">Sampler</button>
      <button class="tablinks" onclick="openTab(event, 'Hyperparameters')">Hyperparameters</button>
      <button class="tablinks" onclick="openTab(event, 'Model')">Model</button>
      <button class="tablinks" onclick="openTab(event, 'Media')" id="defaultOpen">Media</button>
    </div>

    <!--- Define tab content -->
    <div id="Environment" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>type</b>: MemoryGym<br><b>name</b>: MortarMayhem-v0<br><b>frame_skip</b>: 1<br><b>last_action_to_obs</b>: False<br><b>last_reward_to_obs</b>: False<br><b>obs_stacks</b>: 1<br><b>grayscale</b>: False<br><b>resize_vis_obs</b>: [84, 84]<br><b>positional_encoding</b>: False<br><b>reset_params</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>start-seed</b>: 200003<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num-seeds</b>: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>agent_scale</b>: 0.25<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>arena_size</b>: 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>allowed_commands</b>: 9<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>command_count</b>: [10]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>explosion_duration</b>: [6]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>explosion_delay</b>: [18]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_command_failure</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_command_success</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reward_episode_success</b>: 0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>seed</b>: 200003<br><b>reward_normalization</b>: 0<br><b>positional_endocing</b>: False<br>
    </div>

    <div id="Model" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>load_model</b>: False<br><b>model_path</b>: <br><b>checkpoint_interval</b>: 500<br><b>activation</b>: relu<br><b>vis_encoder</b>: cnn<br><b>vec_encoder</b>: linear<br><b>num_vec_encoder_units</b>: 128<br><b>hidden_layer</b>: default<br><b>num_hidden_layers</b>: 1<br><b>num_hidden_units</b>: 512<br><b>recurrence</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>layer_type</b>: gru<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>sequence_length</b>: -1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hidden_state_size</b>: 512<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>hidden_state_init</b>: zero<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>reset_hidden_state</b>: True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>residual</b>: False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>num_layers</b>: 1<br>
    </div>

    <div id="Sampler" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>n_workers</b>: 32<br><b>worker_steps</b>: 512<br>
    </div>

    <div id="Hyperparameters" class="tabcontent">
      <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
      <b>algorithm</b>: PPO<br><b>resume_at</b>: 0<br><b>gamma</b>: 0.995<br><b>lamda</b>: 0.95<br><b>updates</b>: 30000<br><b>epochs</b>: 3<br><b>refresh_buffer_epoch</b>: -1<br><b>n_mini_batches</b>: 8<br><b>advantage_normalization</b>: no<br><b>value_coefficient</b>: 0.5<br><b>max_grad_norm</b>: 0.25<br><b>share_parameters</b>: True<br><b>learning_rate_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.000275<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-05<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>beta_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.0001<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 1e-06<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>clip_range_schedule</b>: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initial</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>final</b>: 0.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>power</b>: 1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>max_decay_steps</b>: 10000<br><b>obs_reconstruction_schedule</b>: {'initial': 0.0}<br>
    </div>

    <div id="Media" class="mediatabcontent">
      <br>
      <center>
        <div id="figures" style="display: flex; flex-direction: column;">
          <div style="display: flex; flex-direction: row;">
            <div style="display: flex; flex-direction: column;">
              <div style="display: flex; flex-direction: row;">
                <label for="video_speed">Frame Rate: </label>
                <input type="text" id="video_speed" size="3" value="6" onkeydown="set_video_speed(event)">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_ground_truth">Show Ground Truth Estimation</label>
                <input type="checkbox" id="show_ground_truth" onclick="show_ground_truth()">
              </div>

              <div style="display: flex; flex-direction: row;">
                <label for="show_decoder_video">Show Decoder Video</label>
                <input type="checkbox" id="show_decoder_video" onclick="show_decoder_video()">
              </div>

            <div style="display: flex; flex-direction: row;">
              <label for="show_agent_video">Show Agent Video</label>
              <input type="checkbox" id="show_agent_video" onclick="show_agent_video()">
            </div>
          </div>
          
            <div>
              <video id="video_player">
                <source src="" type="video/webm" />
              </video>
            </div>
            <div id="action_distr"></div>
          </div>
        </div>

        <br>
        <!-- Set buttons to control the figures -->
        <div class="gotostepcontainer">
          <label for="gotostep_text">Step:</label>
          <input type="text" id="gotostep_text" size="3" value="0" onkeydown="go_to_step(event)">
          <button id="return_button" type="return_button" onclick="return_to_step()">Return to step 0</button>
        </div>
        <buttonrow>
          <button id="play_pause_button" onclick="play_pause()" style="width:53px">Play</button>
          <button id="reset_button" onclick="reset()">Reset</button>
          <button id="back_button" onclick="back()">Back</button>
          <button id="next_button" onclick="next()">Next</button>
          <button id="stats_button" onclick="statistic()">Attention Scores</button>
        </buttonrow>
        <br>
        <!-- Set slider to control the figures -->
        <input id="time_selector" type="range" min="0" max="100" step="1" value="0" style="width: 300px;"/>

        <!-- Set transformer plot -->
        <div id="score-container">
          <label for="top_n_scores">Number of Top Attention Scores:</label>
          <input type="text" id="top_n_scores" size="3" value="-1" onkeydown="top_scores()">
        </div>
        <div id="transformer"></div>

        <!-- Set value plot and entropy plot -->
        <div id="figures">
          <div id="value_func"></div>
          <div id="entropy_func"></div>
          <!-- Dropdown button with some options-->
          <div class="dropdown" id="options">
            <button class="dropbtn">Options</button>
            <div class="dropdown-content" id="dropdown_content">
              <a href ="#" onclick="marker('value')">value_marker_toggle</a>
              <a href ="#" onclick="marker('entropy')">entropy_marker_toggle</a>
              <a href="#" id="all" onclick="set_action_space('all')">All</a>
            </div>
          </div>
        </div>
      </center>
    </div>

    <script>
        // Set active tab
        document.getElementById("defaultOpen").click();

        // Set video player
        const video_player = document.getElementById("video_player");
        const video_speed = document.getElementById("video_speed");
        const video_path = ['videos/video_seed_200003_65.webm', '', '', '', 'videos/video_seed_200003_66.webm', ''];
        var render_id = 0; var render_gt_id = 1; var render_decoder_id = 2; var render_decoder_gt_id = 3; var  render_agent_id = 4; var render_agent_gt_id = 5;
        var video_id = 0;
        // Hide video player if there is no ground truth video
        if (video_path[render_gt_id].length == 0 && video_path[render_decoder_gt_id].length == 0 && video_path[render_agent_gt_id].length == 0){
          document.querySelector('label[for="show_ground_truth"]').style.display = 'none';
          document.getElementById("show_ground_truth").style.display = 'none';
        } 
        if (video_path[render_decoder_id].length == 0){
          document.querySelector('label[for="show_decoder_video"]').style.display = 'none';
          document.getElementById("show_decoder_video").style.display = 'none';
        }
        if (video_path[render_agent_id].length == 0){
          document.querySelector('label[for="show_agent_video"]').style.display = 'none';
          document.getElementById("show_agent_video").style.display = 'none';
        }

        video_player.querySelector("source").src = video_path[0];
        video_player.load();
        var video_length = 0;

        // Play and pause button
        const play_pause_button = document.getElementById("play_pause_button");

        // Set step input
        const gotostep_text = document.getElementById('gotostep_text');
        var past_steps = [0];
        var step = 0;

        // Set number of scores input
        const top_n_scores = document.getElementById('top_n_scores');

        // Const stats button
        const stats_button = document.getElementById("stats_button");

        // Set time selector
        const time_selector = document.getElementById('time_selector');
        var tS_step_size = 1.0;

        // Set values for the plots
        var y_values = [[0.3419262766838074], [0.3450371026992798], [0.3448048532009125], [0.34692078828811646], [0.35208752751350403], [0.35334572196006775], [0.3546934425830841], [0.3550286889076233], [0.3579307198524475], [0.36070895195007324], [0.36447352170944214], [0.3631296157836914], [0.36450737714767456], [0.36489853262901306], [0.36654186248779297], [0.369699627161026], [0.3694661855697632], [0.37102919816970825], [0.3726564943790436], [0.3758659064769745], [0.37732502818107605], [0.3848791718482971], [0.38687169551849365], [0.3855319619178772], [0.391706645488739], [0.3925321698188782], [0.39392489194869995], [0.3978733420372009], [0.3978016972541809], [0.39957350492477417], [0.40206390619277954], [0.40360623598098755], [0.40671008825302124], [0.40642762184143066], [0.40802693367004395], [0.4105833172798157], [0.41326844692230225], [0.415737509727478], [0.41780152916908264], [0.4177711009979248], [0.41983020305633545], [0.4185539782047272], [0.4242703914642334], [0.4289005994796753], [0.43546390533447266], [0.4324355125427246], [0.43059056997299194], [0.43669965863227844], [0.44058191776275635], [0.4442381262779236], [0.4454513192176819], [0.44541966915130615], [0.4500594735145569], [0.45440131425857544], [0.4535997807979584], [0.45330193638801575], [0.460987389087677], [0.4610881209373474], [0.36759692430496216], [0.36369433999061584], [0.36695343255996704], [0.36809101700782776], [0.37412214279174805], [0.3748994767665863], [0.3776978850364685], [0.3759267032146454], [0.37420353293418884], [0.3830503225326538], [0.37991777062416077], [0.3874734044075012], [0.39105379581451416], [0.3912086486816406], [0.3937588930130005], [0.39586153626441956], [0.39777490496635437], [0.4003487229347229], [0.40342140197753906], [0.40564584732055664], [0.40744903683662415], [0.40573641657829285], [0.41030243039131165], [0.41130802035331726], [0.314385324716568], [0.3141792416572571], [0.316639244556427], [0.31591925024986267], [0.31592443585395813], [0.3183388113975525], [0.3195413649082184], [0.31822267174720764], [0.31931570172309875], [0.319204717874527], [0.3296525776386261], [0.3280463218688965], [0.3274521827697754], [0.3280845582485199], [0.32898736000061035], [0.33012574911117554], [0.3312290608882904], [0.3328969180583954], [0.3351109027862549], [0.33714595437049866], [0.33883389830589294], [0.3403625190258026], [0.3417004942893982], [0.3427778482437134], [0.24924656748771667], [0.25042271614074707], [0.25088071823120117], [0.2478569746017456], [0.2510559856891632], [0.2535330057144165], [0.25256600975990295], [0.24908646941184998], [0.2506646513938904], [0.24902331829071045], [0.2501849830150604], [0.25265300273895264], [0.2554701864719391], [0.25743597745895386], [0.26023414731025696], [0.2625730037689209], [0.2644435465335846], [0.26772868633270264], [0.26755648851394653], [0.26591312885284424], [0.2665855586528778], [0.2677939534187317], [0.2684122920036316], [0.26784446835517883], [0.1712147295475006], [0.17272141575813293], [0.17616233229637146], [0.17642149329185486], [0.1828279197216034], [0.17954212427139282], [0.17643563449382782], [0.18103063106536865], [0.18374818563461304], [0.18442927300930023], [0.18539057672023773], [0.18614482879638672], [0.18689346313476562], [0.18778705596923828], [0.18854022026062012], [0.18916335701942444], [0.18972273170948029], [0.19039243459701538], [0.19096621870994568], [0.19161993265151978], [0.1926422417163849], [0.19245408475399017], [0.19382743537425995], [0.19523759186267853], [0.09880153834819794], [0.10119964182376862], [0.09997677057981491], [0.09884360432624817], [0.10042645037174225], [0.10004457831382751], [0.10077796131372452], [0.10066625475883484], [0.10159876942634583], [0.10407167673110962], [0.10422574728727341], [0.10421501845121384], [0.10297713428735733], [0.10424280166625977], [0.10307809710502625], [0.10385757684707642], [0.10232231765985489], [0.10172095894813538], [0.10278473049402237], [0.10800503194332123], [0.10545693337917328], [0.10502014309167862], [0.10396129637956619], [0.10226227343082428], [0.009804293513298035], [0.01043565571308136], [0.009138435125350952], [0.009750179946422577], [0.008232168853282928], [0.008343786001205444], [0.006680421531200409], [0.0072435662150382996], [0.007787145674228668], [0.00833265483379364], [0.00840606540441513], [0.009457260370254517], [0.010259173810482025], [0.009551845490932465], [0.010964341461658478], [0.00926777720451355], [0.009297914803028107], [0.00754740834236145], [0.007967047393321991], [0.008580058813095093], [0.007844999432563782], [0.009495057165622711], [0.009436435997486115], [0.010072045028209686], [0.010714299976825714], [0.01094508171081543], [0.009698234498500824], [0.009360440075397491], [0.010072119534015656], [0.00921691209077835], [0.01002582162618637], [0.010604895651340485], [0.010418273508548737], [0.00981535017490387], [0.009302414953708649], [0.008641384541988373], [0.008675999939441681], [0.010997027158737183], [0.008427105844020844], [0.009684108197689056], [0.009398281574249268], [0.010228388011455536], [0.010425321757793427], [0.010013066232204437], [0.010647647082805634], [0.009672269225120544], [0.010830789804458618], [0.012060433626174927], [0.01159050315618515]];
        var y_entropy = [[0.5119140148162842, 0.6858187913894653], [0.8542444705963135, 0.6707245111465454], [0.931313693523407, 0.45786023139953613], [1.0069855451583862, 0.9709697365760803], [0.24553422629833221, 0.7040750980377197], [0.30862104892730713, 0.8454958200454712], [0.31175118684768677, 0.8140906095504761], [0.7374375462532043, 0.7783290147781372], [0.14306887984275818, 0.6970293521881104], [0.24197418987751007, 0.7911252379417419], [0.3117845058441162, 0.7873166799545288], [0.729299008846283, 0.6630584597587585], [0.5522770285606384, 0.5863617658615112], [0.9520009160041809, 0.6068456172943115], [0.9908560514450073, 0.5283412337303162], [0.9186173677444458, 0.8213247060775757], [1.0157450437545776, 0.42475271224975586], [1.0982801914215088, 0.6105618476867676], [1.0975608825683594, 0.5645469427108765], [0.9269565343856812, 0.813562273979187], [1.0952835083007812, 0.5537662506103516], [1.0943132638931274, 0.6451517343521118], [1.0766733884811401, 0.6213924288749695], [0.3400156497955322, 0.14116251468658447], [1.0661070346832275, 0.7312583327293396], [1.02077054977417, 0.6770997047424316], [1.019963264465332, 0.6773266196250916], [0.1286647766828537, 0.03082466870546341], [1.0208098888397217, 0.6293683052062988], [0.955036997795105, 0.7105034589767456], [0.9584461450576782, 0.7447719573974609], [0.06148674339056015, 0.009725570678710938], [0.8059748411178589, 0.7419668436050415], [0.6283127069473267, 0.6474056243896484], [0.6215497255325317, 0.7010738253593445], [0.028941048309206963, 0.010053404606878757], [0.9928001165390015, 0.7317408323287964], [0.938173770904541, 0.7658083438873291], [0.9269649386405945, 0.8119359016418457], [0.020433440804481506, 0.013533021323382854], [0.003553834743797779, 0.00969642587006092], [0.00017879271763376892, 0.0005382918752729893], [2.985854553116951e-05, 0.00011234742851229385], [3.666814109237748e-06, 0.0004402805061545223], [0.0004450417764019221, 0.017857903614640236], [0.006221250630915165, 0.3957768380641937], [0.07593946158885956, 0.11832291632890701], [1.0705560445785522, 0.6921059489250183], [0.6574918031692505, 0.11036786437034607], [0.9942446947097778, 0.6905191540718079], [0.8401131629943848, 0.6583259701728821], [0.4068395793437958, 0.9046739339828491], [0.7623775005340576, 0.7589548826217651], [0.992638349533081, 0.8953190445899963], [0.2500133216381073, 0.782334566116333], [0.8268024325370789, 0.590928852558136], [0.7033755779266357, 0.42120206356048584], [0.8863065838813782, 0.5669979453086853], [0.6433043479919434, 0.006595828104764223], [0.6823091506958008, 0.005839054472744465], [0.06794676184654236, 0.04046759009361267], [0.06980311870574951, 0.46113818883895874], [0.6525236964225769, 0.6860183477401733], [3.189909693901427e-05, 0.1675058901309967], [0.00036445361911319196, 0.012079130858182907], [7.475026905012783e-06, 0.34434062242507935], [4.6335776882067137e-10, 0.0013302620500326157], [0.08044259995222092, 0.35833626985549927], [0.1845100224018097, 0.48569875955581665], [1.0340546369552612, 0.19359417259693146], [0.7065093517303467, 0.44733497500419617], [0.6708559393882751, 1.0439834594726562], [0.8021615743637085, 0.6007498502731323], [0.6944474577903748, 1.064926028251648], [0.5061929225921631, 0.5336205363273621], [0.7055633664131165, 0.8436605930328369], [0.5283587574958801, 0.6784180402755737], [0.5168797373771667, 0.6620930433273315], [0.4630036950111389, 0.6332758665084839], [0.3602927327156067, 0.9961716532707214], [0.5717284679412842, 0.5967104434967041], [0.711314857006073, 0.6715179681777954], [0.5201161503791809, 0.02948092669248581], [0.003180162748321891, 0.3968604505062103], [7.929325511213392e-05, 0.017316516488790512], [1.7487323930254206e-05, 0.014418534003198147], [0.01678640954196453, 0.001826874096877873], [3.097226226600469e-07, 0.005951813422143459], [0.00010258745169267058, 0.0004722355806734413], [0.0005047650192864239, 1.6951224097283557e-05], [0.005861306097358465, 2.353869149374077e-06], [0.0013403050834313035, 0.00015762094699312001], [0.028991462662816048, 0.031314291059970856], [0.7008504867553711, 0.6106553077697754], [0.6675056219100952, 0.34666743874549866], [0.45082613825798035, 0.3794105648994446], [0.324094295501709, 0.3998560309410095], [0.27962952852249146, 0.3986170291900635], [0.2225264459848404, 0.414788156747818], [0.18332144618034363, 0.36693355441093445], [0.1556793600320816, 0.3828723430633545], [0.1441727578639984, 0.35842567682266235], [0.13159359991550446, 0.3503499925136566], [0.1224859356880188, 0.33689084649086], [0.11551522463560104, 0.32212451100349426], [0.10939504206180573, 0.30875852704048157], [0.4106544852256775, 0.31150978803634644], [0.1588856279850006, 0.16849875450134277], [0.0004232693463563919, 0.010594669729471207], [0.48095032572746277, 0.5044636130332947], [0.6718956232070923, 0.0012988225789740682], [0.00930788554251194, 0.01008734479546547], [7.527172556365258e-07, 0.39226335287094116], [0.00033160782186314464, 0.027190063148736954], [0.6897335052490234, 0.22403006255626678], [0.2850457429885864, 0.6724568605422974], [0.28304606676101685, 0.7993887662887573], [0.2615785300731659, 0.8467239737510681], [0.3763889670372009, 0.8481824994087219], [0.48095032572746277, 0.7435058355331421], [0.5948926210403442, 0.6670670509338379], [0.6698548197746277, 0.6512521505355835], [0.7045663595199585, 0.6536657214164734], [0.4888525903224945, 0.8501746654510498], [0.471848726272583, 0.8751081824302673], [0.5301349759101868, 0.9676446914672852], [0.6142184734344482, 0.8869121074676514], [0.7151519060134888, 0.5861279964447021], [0.3863455653190613, 0.7923709750175476], [0.6094129085540771, 0.7238458395004272], [0.3056696057319641, 0.6931556463241577], [0.010578506626188755, 0.49304479360580444], [0.009670313447713852, 0.02212979830801487], [0.17583152651786804, 0.23664593696594238], [0.01247415505349636, 0.027588170021772385], [0.0008410594891756773, 0.5437219142913818], [0.44508594274520874, 0.029204849153757095], [0.02348058670759201, 0.02584349364042282], [0.6617549657821655, 0.0953483134508133], [0.5853067636489868, 0.10114458203315735], [0.613906741142273, 0.09349612146615982], [0.4197048544883728, 0.09809090197086334], [0.2808349132537842, 0.09731405228376389], [0.24017521739006042, 0.1474386602640152], [0.22300224006175995, 0.21928799152374268], [0.24057793617248535, 0.32372963428497314], [0.272241473197937, 0.45589232444763184], [0.3233518600463867, 0.6024695634841919], [0.40031856298446655, 0.689369797706604], [0.533079981803894, 0.7027192115783691], [0.6770513653755188, 0.7092437744140625], [0.7474172711372375, 0.7175178527832031], [0.8568965196609497, 0.5721666216850281], [0.8308422565460205, 0.6612555980682373], [0.12370864301919937, 0.047472935169935226], [0.004064524546265602, 0.2734500765800476], [0.00013839686289429665, 0.002792081795632839], [0.45818638801574707, 7.926896046228649e-07], [0.0022096813190728426, 3.260625760503899e-07], [0.0011596084805205464, 5.339302902029885e-07], [1.810991875572654e-06, 4.663424624595791e-05], [3.5114414913550718e-06, 0.2077474296092987], [0.0031764244195073843, 0.16114896535873413], [0.09670037031173706, 0.010529711842536926], [0.22887983918190002, 0.03410090506076813], [0.32112917304039, 0.10650242865085602], [0.33522602915763855, 0.6286696791648865], [0.6004629731178284, 0.6236143112182617], [0.938172459602356, 0.5662546157836914], [0.584610641002655, 0.5601633787155151], [0.48454198241233826, 0.7571557760238647], [0.7131443023681641, 0.5735970735549927], [0.012943457812070847, 0.9579908847808838], [0.023683257400989532, 0.0740061029791832], [0.30940479040145874, 0.13067026436328888], [0.6582526564598083, 0.6968740820884705], [0.8018183708190918, 0.627582311630249], [0.6841449737548828, 0.9802725315093994], [0.0001560170785523951, 1.8893540982389823e-05], [0.1787794828414917, 1.578406960689449e-09], [2.0327363472461e-06, 3.2204236504185246e-06], [3.6803390912609757e-07, 6.803356455975518e-08], [0.00670736376196146, 1.6004059943952598e-06], [0.0027773273177444935, 8.825604309870005e-12], [4.8886221293287235e-08, 0.10932749509811401], [1.3880528128805414e-13, 3.3351193451380823e-07], [3.6981175899342134e-09, 4.447095136583812e-08], [5.9369928936483e-18, 0.6830130815505981], [0.0001509196008555591, 5.82718855807185e-12], [5.762412547483109e-05, 1.296781615423015e-08], [2.7064253060871124e-09, 0.0542585663497448], [0.08154715597629547, 3.264270520553225e-10], [3.732888131935397e-08, 0.08403971046209335], [3.412984369788319e-06, 4.9956642989013034e-11], [7.337515125982463e-05, 3.6312881093181204e-06], [1.9635109510529603e-11, 6.177742761792615e-10], [1.4221481251745077e-13, 1.8908749566115546e-10], [0.16324523091316223, 9.890890214592218e-05], [3.2274188876968424e-10, 5.930457513958487e-11], [1.0324573850084562e-05, 8.093024007393979e-06], [1.602040982512376e-12, 0.0009197560139000416], [0.0014826591359451413, 1.1399747563700657e-05], [4.927243821839511e-07, 0.0001446681417291984], [0.0007127776043489575, 7.278864143367425e-12], [0.0004642241110559553, 6.96608604133786e-11], [9.607156971469522e-05, 0.0036100554279983044], [8.862631765624296e-13, 1.5929301298456267e-05], [8.909791654465593e-11, 3.5232801565143745e-08], [8.098104409270945e-09, 2.8300515264589876e-09], [2.3031715220439043e-15, 0.000298508966807276], [9.216751846322438e-14, 6.4156235879409e-11], [0.002922400599345565, 1.9333768527113326e-12], [1.5658229921000633e-11, 0.0017146847676485777], [1.5186891687335446e-05, 1.3201000015339304e-10], [9.656573318750361e-09, 8.65725633542036e-12], [2.9405970991547292e-09, 4.025298316889803e-09], [0.006462686695158482, 9.08528988929902e-07], [0.0004043492372147739, 7.106490063080173e-09], [6.227291599048002e-11, 3.3422413281414265e-08], [4.1934174882518604e-11, 0.12378567457199097], [0.0004203594580758363, 1.5955452514759827e-09], [0.0003380772250238806, 2.4116075110214297e-06], [6.0499938121360425e-15, 0.6846040487289429], [2.7007959943148308e-05, 0.00028630520682781935], [0.0003667630080599338, 5.716792728094333e-08], [8.03341293769029e-16, 9.662656091924404e-11], [8.172863203981251e-07, 0.00602723890915513]];
        var y_attention_weights = [];
        var y_action = [[[0.8090519309043884, 0.005327232647687197, 0.18562088906764984], [0.2435074895620346, 0.031425200402736664, 0.7250673770904541]], [[0.24625812470912933, 0.10054296255111694, 0.6531989574432373], [0.14256808161735535, 0.07791443169116974, 0.7795174717903137]], [[0.25314250588417053, 0.14357547461986542, 0.6032819747924805], [0.12861672043800354, 0.014583839103579521, 0.8567994236946106]], [[0.15675051510334015, 0.4918535649776459, 0.35139596462249756], [0.5730135440826416, 0.17375028133392334, 0.2532361149787903]], [[0.9465317130088806, 0.024865230545401573, 0.028603138402104378], [0.7031689286231995, 0.02942202426493168, 0.2674090266227722]], [[0.9278842210769653, 0.04005342349410057, 0.032062362879514694], [0.6147328019142151, 0.0675852969288826, 0.3176819086074829]], [[0.9269874691963196, 0.03933900594711304, 0.03367361053824425], [0.6283169388771057, 0.05411523953080177, 0.3175678253173828]], [[0.3224041759967804, 0.6520593166351318, 0.025536544620990753], [0.7133183479309082, 0.09103158116340637, 0.19565007090568542]], [[0.9725358486175537, 0.008840475231409073, 0.018623655661940575], [0.7106454968452454, 0.029572688043117523, 0.2597818374633789]], [[0.9467644691467285, 0.017971791326999664, 0.035263776779174805], [0.5641752481460571, 0.028862446546554565, 0.40696224570274353]], [[0.9254949688911438, 0.023762788623571396, 0.05074220523238182], [0.5952141880989075, 0.03220713511109352, 0.3725787401199341]], [[0.3232562243938446, 0.6538591980934143, 0.022884609177708626], [0.7882408499717712, 0.105873242020607, 0.10588591545820236]], [[0.8353873491287231, 0.05524652823805809, 0.10936612635850906], [0.8125184774398804, 0.04542642831802368, 0.14205504953861237]], [[0.5172166228294373, 0.1102922335267067, 0.37249118089675903], [0.802667498588562, 0.04860811308026314, 0.14872445166110992]], [[0.47105735540390015, 0.1340179741382599, 0.39492473006248474], [0.8427623510360718, 0.04407525062561035, 0.11316239833831787]], [[0.23034685850143433, 0.6201472878456116, 0.14950589835643768], [0.6697155833244324, 0.2465990036725998, 0.08368547260761261]], [[0.5202450752258301, 0.28650882840156555, 0.19324615597724915], [0.8879499435424805, 0.07033257186412811, 0.041717514395713806]], [[0.3384629786014557, 0.3402702510356903, 0.32126668095588684], [0.8072345852851868, 0.1317177265882492, 0.061047762632369995]], [[0.34921029210090637, 0.31278857588768005, 0.3380011022090912], [0.8315699100494385, 0.10578760504722595, 0.06264251470565796]], [[0.15372250974178314, 0.6134579181671143, 0.23281951248645782], [0.33298438787460327, 0.6171455383300781, 0.04987010359764099]], [[0.3571435809135437, 0.34719306230545044, 0.2956632971763611], [0.8289340734481812, 0.12830151617527008, 0.04276435822248459]], [[0.29817429184913635, 0.37357744574546814, 0.3282483220100403], [0.7802355289459229, 0.1691952645778656, 0.05056924372911453]], [[0.23990531265735626, 0.40099284052848816, 0.35910189151763916], [0.79449862241745, 0.1559986174106598, 0.04950270801782608]], [[0.054521042853593826, 0.9168259501457214, 0.028653010725975037], [0.030930357053875923, 0.9687098860740662, 0.0003597378090489656]], [[0.25697851181030273, 0.28831636905670166, 0.45470505952835083], [0.7407428622245789, 0.18075573444366455, 0.07850141823291779]], [[0.15971337258815765, 0.43921399116516113, 0.40107262134552], [0.7727712988853455, 0.1561369001865387, 0.07109170407056808]], [[0.15922635793685913, 0.44285404682159424, 0.39791953563690186], [0.7726761698722839, 0.15613742172718048, 0.07118646800518036]], [[0.021852858364582062, 0.974595308303833, 0.0035517069045454264], [0.004827067255973816, 0.9951503872871399, 2.258797212562058e-05]], [[0.1589818298816681, 0.4275302290916443, 0.41348797082901], [0.8045267462730408, 0.09347423166036606, 0.10199898481369019]], [[0.11695080250501633, 0.530003547668457, 0.35304561257362366], [0.7628791332244873, 0.13229505717754364, 0.10482587665319443]], [[0.1219104751944542, 0.5344848036766052, 0.34360471367836], [0.7419292330741882, 0.15469908714294434, 0.10337167233228683]], [[0.009195588529109955, 0.9896109104156494, 0.0011935180518776178], [0.0012581243645399809, 0.9987369179725647, 5.010537279304117e-06]], [[0.09781669080257416, 0.6953505873680115, 0.20683270692825317], [0.7421005368232727, 0.1601889282464981, 0.09771052747964859]], [[0.056282881647348404, 0.7946588397026062, 0.1490582525730133], [0.7918235063552856, 0.1334947943687439, 0.07468172907829285]], [[0.06269773840904236, 0.8018220067024231, 0.13548025488853455], [0.7630596160888672, 0.1537841260433197, 0.08315625786781311]], [[0.003862942336127162, 0.9957250356674194, 0.00041201806743629277], [0.0013092567678540945, 0.9986867308616638, 4.001433808298316e-06]], [[0.13629107177257538, 0.47364526987075806, 0.390063613653183], [0.7520557045936584, 0.11916457861661911, 0.12877975404262543]], [[0.09735032916069031, 0.5063161849975586, 0.3963334262371063], [0.7298933863639832, 0.1603860855102539, 0.10972051322460175]], [[0.1112433448433876, 0.5736938118934631, 0.31506285071372986], [0.698200523853302, 0.1888291835784912, 0.1129702776670456]], [[0.0026614635717123747, 0.9971275925636292, 0.00021094860858283937], [0.0018468140624463558, 0.9981484413146973, 4.7833777898631524e-06]], [[0.00040285696741193533, 0.9995970129966736, 1.2355509682038246e-07], [0.0012569898972287774, 0.9987397789955139, 3.269888338763849e-06]], [[1.4789657143410295e-05, 0.9999852180480957, 1.5171752743015077e-10], [4.8543253797106445e-05, 0.9999510049819946, 4.80996106944076e-07]], [[2.141163349733688e-06, 0.9999978542327881, 4.130550502329244e-12], [8.807900485408027e-06, 0.9999910593032837, 7.573105875735564e-08]], [[2.406014516509458e-07, 0.9999997615814209, 6.49664079043627e-13], [3.9512688090326265e-05, 0.9999605417251587, 4.6831183375672936e-09]], [[3.998682223027572e-05, 0.9999600648880005, 2.2112993658396363e-09], [0.002563158283010125, 0.9974364638328552, 3.0288055086202803e-07]], [[0.000743358745239675, 0.9992469549179077, 9.798771316127386e-06], [0.10882638394832611, 0.8818649649620056, 0.009308679029345512]], [[0.008122354745864868, 0.9873801469802856, 0.004497528076171875], [0.013839051127433777, 0.007764158770442009, 0.9783968329429626]], [[0.256626695394516, 0.2992444932460785, 0.4441288113594055], [0.13943928480148315, 0.08992615342140198, 0.7706345915794373]], [[0.3542037606239319, 0.0010018441826105118, 0.6447944641113281], [0.02323293499648571, 0.9767670035362244, 1.6874119879162208e-08]], [[0.5177571773529053, 0.1535586416721344, 0.32868412137031555], [0.44436073303222656, 0.5551999807357788, 0.0004392020055092871]], [[0.540060818195343, 0.04629509896039963, 0.41364410519599915], [0.36761489510536194, 0.6323211789131165, 6.392252544173971e-05]], [[0.08994335681200027, 0.8878382444381714, 0.022218436002731323], [0.20935161411762238, 0.6354265213012695, 0.1552218198776245]], [[0.3591614067554474, 0.026207784190773964, 0.6146307587623596], [0.4047154188156128, 0.576303243637085, 0.018981387838721275]], [[0.5266979932785034, 0.15726983547210693, 0.31603220105171204], [0.4288526475429535, 0.5012152791023254, 0.0699319988489151]], [[0.05478784069418907, 0.9389545917510986, 0.006257541943341494], [0.19258573651313782, 0.7124590873718262, 0.09495513886213303]], [[0.29130932688713074, 0.6409273743629456, 0.06776326894760132], [0.7585188746452332, 0.008911394514143467, 0.23256970942020416]], [[0.4843185544013977, 0.0015795804793015122, 0.5141018629074097], [0.8595184683799744, 0.003226649481803179, 0.13725486397743225]], [[0.4459529519081116, 0.48969027400016785, 0.06435678154230118], [0.7527346611022949, 0.001218086457811296, 0.2460472732782364]], [[0.34321239590644836, 1.3671870874532033e-05, 0.6567739248275757], [0.0008127855253405869, 2.3630573192656712e-11, 0.999187171459198]], [[0.4262579381465912, 6.2460640037897974e-06, 0.5737358331680298], [0.000707455852534622, 8.642431659211525e-09, 0.9992924928665161]], [[0.9873391389846802, 0.01265534944832325, 5.491065621754387e-06], [0.9932559728622437, 0.006740073673427105, 3.866166935040383e-06]], [[0.986900269985199, 0.013099676929414272, 5.370330402598711e-09], [0.17333699762821198, 0.826663076877594, 1.6721141832265474e-11]], [[0.35844168066978455, 4.872649128628836e-07, 0.6415578126907349], [0.39803117513656616, 0.002070751739665866, 0.5998980402946472]], [[2.310993295395747e-06, 2.6035701372606468e-12, 0.9999977350234985], [0.03985574096441269, 1.4157196801534155e-06, 0.9601428508758545]], [[3.207961708540097e-05, 4.839061595873773e-09, 0.9999679327011108], [0.9983963370323181, 3.1879240850685164e-05, 0.0015717631904408336]], [[2.4935964404448896e-08, 4.840400720240723e-07, 0.9999995231628418], [0.8910385966300964, 1.7066349755623378e-07, 0.10896115005016327]], [[1.8740885579515698e-11, 1.4175512265477818e-14, 1.0], [0.9998660087585449, 1.40042871521473e-07, 0.00013388771913014352]], [[0.015345276333391666, 0.00011091840860899538, 0.9845438599586487], [0.9064649343490601, 0.01935902237892151, 0.07417607307434082]], [[0.043151017278432846, 0.9560194611549377, 0.0008295610314235091], [0.13914333283901215, 0.01667868159711361, 0.8441779613494873]], [[0.4696877896785736, 0.18464209139347076, 0.34567010402679443], [0.04813627898693085, 0.9518074989318848, 5.621123636956327e-05]], [[0.2095133662223816, 0.05254165828227997, 0.7379449605941772], [0.11229483783245087, 0.8675944209098816, 0.020110778510570526]], [[0.18553267419338226, 0.763282060623169, 0.051185205578804016], [0.2717318534851074, 0.23638321459293365, 0.4918849468231201]], [[0.5815547704696655, 0.035857271403074265, 0.38258790969848633], [0.2247769832611084, 0.7617728114128113, 0.01345017272979021]], [[0.2751188278198242, 0.7006512880325317, 0.02422982081770897], [0.45104601979255676, 0.30726689100265503, 0.2416871190071106]], [[0.20405609905719757, 1.8768711015582085e-05, 0.7959251999855042], [0.8065879940986633, 0.011096498928964138, 0.18231548368930817]], [[0.6981534361839294, 0.27388715744018555, 0.027959385886788368], [0.6601423025131226, 0.09644322097301483, 0.24341443181037903]], [[0.8473571538925171, 0.09518539160490036, 0.05745739862322807], [0.7707976698875427, 0.06887388974428177, 0.1603284329175949]], [[0.8481302857398987, 0.10838857293128967, 0.04348110780119896], [0.7820166945457458, 0.07124798744916916, 0.14673537015914917]], [[0.8721539974212646, 0.08613843470811844, 0.041707657277584076], [0.7976728081703186, 0.06873893737792969, 0.13358823955059052]], [[0.11652597039937973, 0.8834431171417236, 3.081994509557262e-05], [0.5264392495155334, 0.3112506568431854, 0.16231007874011993]], [[0.8162398338317871, 0.14499196410179138, 0.0387682169675827], [0.8096975684165955, 0.05044225975871086, 0.13986007869243622]], [[0.607079029083252, 0.3843459486961365, 0.00857501570135355], [0.7763692736625671, 0.07138415426015854, 0.15224656462669373]], [[0.7853052020072937, 3.5679738630278734e-07, 0.21469448506832123], [0.004625245928764343, 1.0496378877178358e-08, 0.9953747391700745]], [[0.9996469020843506, 3.602699507609941e-06, 0.0003495176206342876], [0.8646953105926514, 5.863321348442696e-05, 0.13524606823921204]], [[0.9999939203262329, 4.03728357412092e-08, 6.024002686899621e-06], [0.9975357055664062, 8.131471076922026e-06, 0.0024562508333474398]], [[0.999998927116394, 2.773095957309124e-07, 8.859235549607547e-07], [0.9980031847953796, 1.334910166406189e-06, 0.0019954657182097435]], [[0.002385426312685013, 3.921088106983994e-11, 0.9976146221160889], [0.00019107900152448565, 2.7850438223523712e-14, 0.9998089671134949]], [[1.7331256429997666e-08, 2.4150338694318594e-16, 1.0], [0.0007231030613183975, 2.603926189254091e-13, 0.9992769360542297]], [[8.099658771243412e-06, 9.56578913302586e-12, 0.9999918937683105], [4.266731775715016e-05, 7.569138024687838e-12, 0.9999573230743408]], [[4.595348218572326e-05, 6.08226080611729e-10, 0.9999539852142334], [1.1697012496370007e-06, 1.007979477662957e-09, 0.9999988079071045]], [[0.0007105836411938071, 8.827269470934596e-11, 0.9992893934249878], [1.4977717910369392e-07, 9.986981727716504e-12, 0.9999998807907104]], [[0.00013525535177905113, 4.581235130834971e-12, 0.9998646974563599], [1.2899164175905753e-05, 2.919597072784108e-12, 0.9999871253967285]], [[0.004534195642918348, 1.8308993432469833e-08, 0.9954657554626465], [0.004968542139977217, 1.0772861003260914e-07, 0.9950313568115234]], [[0.4749127924442291, 0.0012771282345056534, 0.5238101482391357], [0.7615059018135071, 0.017015179619193077, 0.22147896885871887]], [[0.6258319020271301, 0.0009070952655747533, 0.3732609748840332], [0.9123954772949219, 0.022309886291623116, 0.06529466807842255]], [[0.8402290940284729, 0.0021822135895490646, 0.15758861601352692], [0.8947330117225647, 0.014890728518366814, 0.09037618339061737]], [[0.9060619473457336, 0.002784061711281538, 0.09115398675203323], [0.8904402852058411, 0.02151007391512394, 0.08804959803819656]], [[0.9238706827163696, 0.0023298338055610657, 0.07379947602748871], [0.8913861513137817, 0.022203024476766586, 0.0864107683300972]], [[0.9448695778846741, 0.0021784144919365644, 0.05295204371213913], [0.8772186636924744, 0.01341637596487999, 0.10936492681503296]], [[0.9568828344345093, 0.001232018112204969, 0.041885100305080414], [0.8880324959754944, 0.003720610635355115, 0.10824692994356155]], [[0.9655013680458069, 0.0013291509822010994, 0.033169493079185486], [0.8805136680603027, 0.00383810605853796, 0.11564821004867554]], [[0.968771755695343, 0.0012308723526075482, 0.02999742142856121], [0.8924569487571716, 0.0039960159920156, 0.103547103703022]], [[0.9723528623580933, 0.001261772820726037, 0.026385415345430374], [0.8961269855499268, 0.0039658802561461926, 0.09990713745355606]], [[0.9748426675796509, 0.0012609800323843956, 0.023896364495158195], [0.9022918939590454, 0.004055141471326351, 0.09365285187959671]], [[0.9767052531242371, 0.0012655854225158691, 0.022029133513569832], [0.9090454578399658, 0.004321481566876173, 0.08663313090801239]], [[0.9783073663711548, 0.0012712618336081505, 0.020421313121914864], [0.9148984551429749, 0.004532970953732729, 0.08056862652301788]], [[0.8568922877311707, 8.332841389346868e-06, 0.14309930801391602], [0.9073032140731812, 0.0004369278030935675, 0.09225980192422867]], [[0.9628171324729919, 1.664312598848028e-08, 0.037182796746492386], [0.9598270058631897, 4.1720838339642796e-07, 0.04017255827784538]], [[0.9999637603759766, 3.080626265727915e-05, 5.537160632229643e-06], [0.9986012578010559, 0.0013983020326122642, 4.6465001446449605e-07]], [[0.1863929182291031, 0.8136070966720581, 1.660140136472421e-09], [0.797050952911377, 0.20294906198978424, 1.4532512693232746e-10]], [[0.602822482585907, 0.39717403054237366, 3.5518271488399478e-06], [0.9998693466186523, 3.7439278344209015e-09, 0.00013061377103440464]], [[0.001205640030093491, 0.9987943172454834, 7.64958141274974e-09], [0.9986779093742371, 2.8636944193749514e-07, 0.0013218243839219213]], [[4.446412660286114e-08, 1.0, 8.769070539149659e-14], [0.8688672184944153, 0.13055160641670227, 0.0005811356822960079]], [[2.8999938876950182e-05, 0.9999710321426392, 3.1463342348159173e-11], [0.9961138963699341, 0.0032436500769108534, 0.0006424323073588312]], [[0.5421676635742188, 0.45781949162483215, 1.277891806239495e-05], [0.946143627166748, 0.04983047768473625, 0.004025863949209452]], [[0.0825880840420723, 1.9092695424660633e-08, 0.9174119234085083], [0.6826305389404297, 0.30643096566200256, 0.010938478633761406]], [[0.9290906190872192, 0.009041877463459969, 0.06186741963028908], [0.5486815571784973, 0.030257612466812134, 0.42106083035469055]], [[0.9315999746322632, 0.0029303792398422956, 0.06546958535909653], [0.6433709263801575, 0.2721242904663086, 0.08450473845005035]], [[0.879962146282196, 0.0018101052846759558, 0.11822769045829773], [0.6674160957336426, 0.22100412845611572, 0.11157979816198349]], [[0.8217194676399231, 0.0022730696946382523, 0.17600739002227783], [0.7439088225364685, 0.10870756208896637, 0.14738363027572632]], [[0.7314175963401794, 0.0022601368837058544, 0.2663222849369049], [0.7848121523857117, 0.09015394747257233, 0.1250339150428772]], [[0.6355666518211365, 0.002297058468684554, 0.3621363043785095], [0.7931317687034607, 0.08937985450029373, 0.11748834699392319]], [[0.5410425066947937, 0.002360039157792926, 0.4565974175930023], [0.7918419241905212, 0.08923505991697311, 0.11892292648553848]], [[0.8302524089813232, 0.16137218475341797, 0.008375365287065506], [0.6433135867118835, 0.0874706357717514, 0.2692157030105591]], [[0.8656616806983948, 0.0991084948182106, 0.035229820758104324], [0.6388211250305176, 0.10880777984857559, 0.25237107276916504]], [[0.22256049513816833, 0.7774391174316406, 3.3634339047239337e-07], [0.4724648594856262, 0.11452898383140564, 0.41300615668296814]], [[0.8001090288162231, 0.14847145974636078, 0.0514194518327713], [0.4929645359516144, 0.06484266370534897, 0.4421928822994232]], [[0.6775960326194763, 0.29798418283462524, 0.024419769644737244], [0.2639864981174469, 0.0012063540052622557, 0.7348071336746216]], [[0.8983796238899231, 0.07568802684545517, 0.025932369753718376], [0.7166374921798706, 0.14616772532463074, 0.13719475269317627]], [[0.2699988782405853, 0.004259026143699884, 0.7257420420646667], [0.7505634427070618, 0.0883420780301094, 0.16109438240528107]], [[0.908668041229248, 5.692003469448537e-06, 0.09132620692253113], [0.4971047341823578, 1.8862895103666233e-06, 0.502893328666687]], [[0.9986507296562195, 8.378805068787187e-05, 0.0012654309393838048], [0.805245041847229, 9.81767200869399e-09, 0.19475500285625458]], [[0.0012597457971423864, 0.9987402558326721, 7.510034261137832e-10], [0.9967089891433716, 0.0032869428396224976, 4.042164164275164e-06]], [[0.042507052421569824, 3.9889250236235796e-10, 0.9574929475784302], [0.06355568021535873, 3.123243459413061e-07, 0.9364439845085144]], [[0.9984147548675537, 0.0002379976212978363, 0.0013471883721649647], [0.004275438841432333, 7.941938662270331e-09, 0.9957245588302612]], [[0.9999247789382935, 3.1631636375095695e-05, 4.362373147159815e-05], [0.766289234161377, 2.1316461484843785e-08, 0.23371079564094543]], [[0.8464258909225464, 0.0033761172089725733, 0.15019802749156952], [0.9954509139060974, 2.091528949677013e-05, 0.004528214689344168]], [[0.0035325537901371717, 0.9964667558670044, 6.811343382651103e-07], [0.9963639378547668, 0.0007068333798088133, 0.0029291927348822355]], [[0.6466715335845947, 0.0019863350316882133, 0.3513420522212982], [0.9830575585365295, 0.004175012931227684, 0.012767402455210686]], [[0.2719130218029022, 0.7280740737915039, 1.2937494830111973e-05], [0.9796237349510193, 0.0003195273457095027, 0.020056726410984993]], [[0.6969035863876343, 0.3030514717102051, 4.498311682255007e-05], [0.9815139174461365, 0.00026995170628651977, 0.018216103315353394]], [[0.8522128462791443, 0.1476839780807495, 0.00010323257447453216], [0.9803898930549622, 0.00030516006518155336, 0.019304919987916946]], [[0.9197032451629639, 0.08010631054639816, 0.00019045300723519176], [0.98066645860672, 0.00038268594653345644, 0.018950920552015305]], [[0.9358358383178711, 0.0638657659292221, 0.00029840689967386425], [0.9668716192245483, 0.0003597061731852591, 0.032768718898296356]], [[0.9425678849220276, 0.05687014013528824, 0.0005619999719783664], [0.9435970783233643, 0.0003912492247764021, 0.056011687964200974]], [[0.9375550746917725, 0.06098250672221184, 0.0014624262694269419], [0.9020079374313354, 0.0004892562865279615, 0.09750284999608994]], [[0.9284017086029053, 0.06792477518320084, 0.003673529950901866], [0.8327022194862366, 0.0006608741823583841, 0.16663683950901031]], [[0.9137661457061768, 0.07687512040138245, 0.009358815848827362], [0.7166334390640259, 0.0009505550260655582, 0.2824159860610962]], [[0.8910083770751953, 0.08617892116308212, 0.02281266637146473], [0.5796033143997192, 0.001324207754805684, 0.41907253861427307]], [[0.8411746025085449, 0.11307038366794586, 0.04575500264763832], [0.4614386558532715, 0.0018863162258639932, 0.536674976348877]], [[0.7682623863220215, 0.1686416119337082, 0.06309597939252853], [0.4325445294380188, 0.004288976080715656, 0.5631664991378784]], [[0.4489726424217224, 0.01244790107011795, 0.5385794043540955], [0.44892778992652893, 0.005237084813416004, 0.5458351969718933]], [[0.6734163165092468, 0.17732176184654236, 0.14926199615001678], [0.23458553850650787, 0.004462643526494503, 0.760951817035675]], [[0.6878138184547424, 0.18756096065044403, 0.12462521344423294], [0.31077226996421814, 0.007538682781159878, 0.6816890239715576]], [[0.026869485154747963, 0.9731288552284241, 1.5832039252927643e-06], [0.008182579651474953, 2.088576955827648e-08, 0.9918174147605896]], [[0.9995377063751221, 1.0899309927481227e-05, 0.000451468164101243], [0.9221664667129517, 3.129566721327137e-07, 0.07783322036266327]], [[1.113053167500766e-05, 0.9999889135360718, 2.9364904605144737e-12], [0.000307264068396762, 0.9996927976608276, 6.712712330436688e-11]], [[0.17076025903224945, 0.8291292190551758, 0.00011053119669668376], [1.577395297713835e-10, 1.0, 4.675388964869853e-08]], [[0.0002354277967242524, 0.9997641444206238, 4.748405331156391e-07], [8.258550093787065e-13, 1.0, 1.8300008619576147e-08]], [[0.00011517056555021554, 0.999884843826294, 1.1550471690213726e-08], [8.445572019510905e-11, 1.0, 3.075472676528079e-08]], [[1.1282659073685863e-07, 0.9999998807907104, 2.7520888346010963e-10], [3.1141346426011296e-06, 0.9999966621398926, 2.5071062736969907e-07]], [[2.297048382615685e-07, 0.9999997615814209, 2.437882361261412e-12], [0.05317068099975586, 0.9468293786048889, 1.5329023606014403e-09]], [[0.00035516003845259547, 0.9996448755264282, 1.6245992995322922e-08], [0.03788057714700699, 0.962119460105896, 1.920625603002435e-10]], [[0.9811213612556458, 0.018158692866563797, 0.0007199759129434824], [0.9986961483955383, 0.0010995619231835008, 0.00020429023425094783]], [[0.9397650957107544, 0.060047946870326996, 0.00018695482867769897], [0.9946095943450928, 0.00011870497110066935, 0.005271687172353268]], [[0.9051148295402527, 0.09345173090696335, 0.0014333975268527865], [0.9779656529426575, 0.00010166080755880103, 0.021932700648903847]], [[0.9173380732536316, 0.0584334135055542, 0.024228548631072044], [0.6779565215110779, 0.32201769948005676, 2.5839171939878725e-05]], [[0.8177931308746338, 0.09822126477956772, 0.08398561924695969], [0.6980459690093994, 0.001817278447560966, 0.3001367151737213]], [[0.5105100870132446, 0.09811776131391525, 0.39137211441993713], [0.7787856459617615, 0.00905778631567955, 0.21215654909610748]], [[0.08955910056829453, 0.8251621723175049, 0.08527866005897522], [0.793895959854126, 0.19200821220874786, 0.014095820486545563]], [[0.06635293364524841, 0.06676549464464188, 0.8668815493583679], [0.26946982741355896, 0.0470074899494648, 0.683522641658783]], [[0.03699330985546112, 0.709717333316803, 0.2532893717288971], [0.08718972653150558, 0.0827808752655983, 0.8300293684005737]], [[0.0017629236681386828, 0.9982367753982544, 2.2756883311103593e-07], [0.11509823054075241, 0.5164057016372681, 0.3684960603713989]], [[0.0022397651337087154, 0.9967783093452454, 0.0009819958359003067], [0.014074474573135376, 0.9859236478805542, 1.8379888615527307e-06]], [[0.011993087828159332, 0.9212123155593872, 0.06679461896419525], [0.028712118044495583, 0.9712488055229187, 3.898904105881229e-05]], [[0.02522238716483116, 0.2368752360343933, 0.7379024028778076], [0.1357428878545761, 0.7690759301185608, 0.09518120437860489]], [[0.04598657041788101, 0.3301163613796234, 0.6238970756530762], [0.06566847115755081, 0.13465692102909088, 0.7996746897697449]], [[0.019147204235196114, 0.697717010974884, 0.2831357419490814], [0.14697667956352234, 0.5360066890716553, 0.3170166313648224]], [[1.2740110832965001e-05, 0.9999872446060181, 1.414015460277085e-09], [1.3255726116767619e-06, 0.9999986886978149, 4.624039866285568e-13]], [[0.0014631361700594425, 0.039963144809007645, 0.9585736989974976], [6.739436092528805e-11, 1.0, 4.192823170172502e-19]], [[1.28081268258029e-07, 0.9999998807907104, 3.403008398076418e-13], [2.0916020559980097e-07, 0.9999997615814209, 1.5519388552043267e-10]], [[4.706897649420227e-10, 1.0, 2.0201783357265413e-08], [3.0397044881169677e-09, 1.0, 3.886008181908096e-10]], [[6.646774103336028e-11, 0.9991714954376221, 0.0008285586955025792], [5.667728005670503e-12, 0.9999998807907104, 9.923618904394971e-08]], [[1.31144173212e-12, 0.9996945858001709, 0.0003054523258469999], [8.538950152698916e-15, 1.0, 2.963540871037118e-13]], [[2.276845975212466e-13, 2.4660968822587392e-09, 1.0], [3.833246609019625e-09, 0.022955134510993958, 0.9770448207855225]], [[2.5515239644590293e-16, 3.9077911608389245e-15, 1.0], [1.4177371950030437e-11, 1.0, 1.8723586237001655e-08]], [[8.626455511823202e-17, 1.641395769302889e-10, 1.0], [2.6234119043788695e-11, 2.1986905629489684e-09, 1.0]], [[1.0085366499016545e-20, 1.2574979325320416e-19, 1.0], [1.1488072715337694e-08, 0.5710640549659729, 0.4289359152317047]], [[5.128511005626779e-13, 1.224754214490531e-05, 0.9999877214431763], [3.947193862995774e-15, 1.9462678539118594e-13, 1.0]], [[4.002813511760905e-06, 2.3476353305795783e-07, 0.9999957084655762], [8.979297166922251e-11, 1.0, 5.089370036515106e-10]], [[4.284483531846739e-11, 1.0, 7.2092082303854e-11], [1.214774414393105e-08, 0.009622231125831604, 0.9903777837753296]], [[4.720115975942463e-05, 0.015756875276565552, 0.9841959476470947], [6.4221210814563445e-12, 1.0, 6.237118894275584e-12]], [[1.839178365159455e-09, 1.0, 1.3411069130220277e-11], [1.6683204817624642e-09, 0.016488708555698395, 0.9835113286972046]], [[3.467157938530363e-08, 0.9999997615814209, 1.8151196456983598e-07], [1.827973753268375e-12, 1.0, 1.7375224116477142e-14]], [[5.5939535741345026e-06, 0.9999943971633911, 3.501151799034652e-11], [1.5720290737555875e-12, 2.3810585503269976e-07, 0.9999997615814209]], [[1.6400059191655038e-18, 1.0, 7.016176376863081e-13], [2.525674287767732e-11, 1.0, 4.7628984496629265e-14]], [[8.939423730270723e-16, 3.337134264603625e-15, 1.0], [2.19438006613644e-16, 7.376492645871924e-12, 1.0]], [[3.7876805858427787e-11, 0.03853040188550949, 0.9614695906639099], [1.1291048984674035e-08, 0.9999922513961792, 7.738147360214498e-06]], [[1.1730677193511063e-11, 9.94880068085069e-13, 1.0], [8.038939827671124e-15, 2.1996141887081766e-12, 1.0]], [[6.583684353245189e-07, 0.9999992847442627, 4.573030864575556e-13], [5.7527216767994105e-08, 0.9999995231628418, 4.910974666927359e-07]], [[4.367328981097485e-15, 1.0, 4.751447580655585e-14], [2.4451758395827028e-09, 8.911193435778841e-05, 0.999910831451416]], [[6.481266634494887e-09, 0.00015130687097553164, 0.9998486042022705], [4.016520623040254e-12, 0.9999992847442627, 7.399750643344305e-07]], [[2.835242085552636e-08, 1.0, 1.1084630595673516e-14], [1.058189647018537e-09, 1.1732645361917093e-05, 0.999988317489624]], [[4.687820687188093e-10, 0.9999327659606934, 6.718738586641848e-05], [9.356119259331871e-15, 2.400955953149597e-13, 1.0]], [[1.7149053444659446e-12, 4.1889285057550296e-05, 0.9999581575393677], [8.155918974038501e-14, 2.5161814905944047e-12, 1.0]], [[1.9735257807303175e-14, 7.494229976146016e-06, 0.9999924898147583], [4.080811616359245e-14, 0.9995896220207214, 0.0004103543469682336]], [[2.839839230743199e-14, 1.0, 1.148329680345923e-17], [2.0441567275680805e-12, 0.999998927116394, 1.0908328249570332e-06]], [[4.885180839203688e-19, 1.0, 3.3729748594862885e-12], [1.52228913068847e-12, 1.0, 1.745042776946093e-09]], [[1.6056510072874207e-16, 3.7302297362096226e-10, 1.0], [8.168739156508373e-16, 1.2406838056921998e-10, 1.0]], [[1.3310482476608426e-19, 6.154804769056783e-17, 1.0], [1.6975414129927202e-12, 2.581880471552722e-05, 0.9999741315841675]], [[4.5858297589898816e-17, 2.6959862277066383e-15, 1.0], [2.803855509315306e-13, 1.0, 2.083983376491294e-12]], [[0.0003139532927889377, 0.9996802806854248, 5.816284101456404e-06], [4.566041894083807e-14, 1.0, 1.6733223964435218e-14]], [[1.1823087048100497e-15, 1.0, 5.533688741607423e-13], [1.8320455152931459e-09, 0.00017800209752749652, 0.9998220801353455]], [[3.255913334082594e-14, 1.0326349411116098e-06, 0.999998927116394], [2.0487726098972203e-12, 1.0, 2.8932526947161863e-12]], [[1.4177271856485874e-10, 2.9347846375316067e-10, 1.0], [4.175939266157195e-17, 3.001861996823618e-13, 1.0]], [[2.3566031938371257e-12, 1.0, 1.2624615242096127e-10], [1.761676221567754e-10, 1.0, 2.5723600766830446e-12]], [[7.246844688779674e-07, 0.9992067217826843, 0.0007926485268399119], [3.371926435985495e-12, 5.430440097597966e-08, 1.0]], [[1.1276691250705281e-13, 0.9999639987945557, 3.597392060328275e-05], [2.030551421450255e-11, 1.0, 3.0135693940280817e-10]], [[1.100792834769807e-16, 2.3245500576501987e-12, 1.0], [3.981053835655675e-14, 1.6528132196214074e-09, 1.0]], [[6.375039317513091e-15, 1.5338540984219384e-12, 1.0], [3.5272601506264323e-10, 0.9731026291847229, 0.026897354051470757]], [[4.007742748779464e-11, 3.760857362067327e-05, 0.9999624490737915], [4.878193660649843e-13, 6.754196507641197e-11, 1.0]], [[0.9999712705612183, 3.051157591471565e-06, 2.5605375412851572e-05], [3.3580341285421866e-10, 0.9999998807907104, 1.532232118961474e-07]], [[1.2033985017077017e-16, 1.0, 4.34994961202528e-17], [2.524909064050007e-07, 0.43472054600715637, 0.5652792453765869]], [[1.0847573150840617e-07, 1.763320256031875e-06, 0.9999980926513672], [1.0935034822079359e-10, 2.464512908773031e-05, 0.999975323677063]], [[3.233670213376172e-05, 0.9999676942825317, 2.281565193867105e-15], [2.3986768127315372e-09, 1.0, 4.438307776855055e-10]], [[1.730930687432129e-17, 1.0, 3.362430253409413e-18], [3.657700010928355e-12, 1.0, 9.413004298003576e-15]], [[4.851094104196818e-08, 1.0, 1.1533379286332579e-11], [3.3113328745670856e-10, 0.9992665648460388, 0.0007334592519327998]]]; // action probs
        var action =  [[0, 2], [2, 2], [0, 2], [1, 2], [0, 0], [0, 2], [0, 2], [0, 2], [0, 0], [0, 2], [0, 0], [0, 0], [0, 0], [2, 0], [2, 0], [1, 0], [1, 0], [2, 0], [0, 0], [1, 1], [1, 0], [2, 0], [1, 0], [2, 1], [0, 0], [1, 0], [2, 0], [1, 1], [1, 0], [1, 0], [2, 0], [1, 1], [2, 0], [1, 0], [2, 0], [1, 1], [2, 0], [1, 0], [2, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 2], [0, 2], [2, 1], [0, 0], [0, 1], [1, 2], [0, 1], [2, 0], [1, 1], [1, 0], [2, 0], [0, 0], [0, 2], [2, 2], [0, 0], [0, 1], [0, 0], [2, 2], [2, 0], [2, 0], [2, 0], [2, 0], [1, 2], [1, 1], [2, 1], [1, 2], [2, 1], [1, 0], [2, 0], [0, 0], [0, 0], [0, 0], [2, 0], [1, 0], [0, 0], [0, 0], [2, 2], [0, 0], [0, 0], [0, 0], [2, 2], [2, 2], [2, 2], [2, 2], [2, 2], [2, 2], [2, 2], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 2], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [2, 1], [0, 2], [0, 0], [0, 0], [0, 0], [0, 2], [0, 0], [2, 0], [0, 0], [2, 0], [1, 0], [0, 1], [0, 2], [1, 2], [0, 0], [0, 2], [0, 0], [1, 0], [2, 2], [0, 2], [0, 0], [2, 0], [1, 0], [2, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 2], [1, 2], [2, 2], [0, 2], [0, 2], [1, 2], [0, 0], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1], [0, 0], [0, 0], [0, 2], [0, 1], [0, 0], [2, 2], [1, 1], [2, 0], [2, 2], [1, 2], [1, 0], [1, 1], [2, 1], [2, 2], [2, 2], [1, 1], [2, 1], [1, 1], [1, 1], [1, 1], [1, 1], [2, 2], [2, 1], [2, 2], [2, 1], [2, 2], [2, 1], [1, 2], [2, 1], [1, 2], [1, 1], [1, 2], [1, 1], [2, 2], [2, 1], [2, 2], [1, 1], [1, 2], [2, 1], [1, 2], [1, 2], [2, 2], [2, 1], [1, 1], [1, 1], [2, 2], [2, 2], [2, 1], [1, 1], [1, 2], [2, 1], [2, 2], [1, 1], [1, 2], [1, 1], [2, 2], [2, 1], [2, 2], [0, 1], [1, 2], [2, 2], [1, 1], [1, 1], [1, 1]];
        var action_names = [['no-op', 'left', 'right'], ['no-op', 'up', 'down']];
        var x_values = [...Array(y_values.length).keys()];

        var y_entropy_plot = [];
        var y_values_plot = [];

        // Set marker for plots
        var entropy_marker = false;
        var value_marker = false;

        // Set the to be shown statistic
        var statistic_type = 'general'
        // Only used for the transformer plot to show the correct statistic with tab switching
        var statistic_plot_id = 0;
        // Hide statistic type button if there is no attention weights
        if(y_attention_weights.length == 0) stats_button.style.display = 'none';

        // Set the to be shown action_space(s) for the entropy plot
        var entr_selected_action_space = null;

        var is_multi_discrete = action[0].length != 1;
        var is_discrete = action[0].length == 1;

        // Reformat the data for the plots
        // Each function y - value should be stored in a separate array
        for(var j = 0; j < y_values[0].length; j++)
            for(var i = 0; i < y_values.length; i++)
                y_values_plot.push(y_values[i][j]);

        if(is_discrete) { // If action_space is discrete
          for(var j = 0; j < y_entropy[0].length; j++)
              for(var i = 0; i < y_values.length; i++)
                  y_entropy_plot.push(y_entropy[i][j]);
        }
        else { // If action_space is multi discrete
          for(var j = 0; j < y_entropy[0].length; j++) {
            var y_entropy_vals = [];
            for(var i = 0; i < y_entropy.length; i++) {
                y_entropy_vals.push(y_entropy[i][j]);
            }
            y_entropy_plot.push(y_entropy_vals);
          }
        }

        // Set action_names for distr. plot if it does not exist
        if(action_names == null){
          action_names = [];
          for(var i = 0; i < y_action[0].length; i++){
            for(var j = 0; j < y_action[0][0].length; j++)
              if(is_discrete){ // if action space is discrete
                action_names.push("action_" + String(j));
            }
            else { // if action space is multi_discrete
              var action_branch_names = []; // Names of the branches of the action space
              for(var j = 0; j < y_action[0][i].length; j++){
                action_branch_names.push("action_" + String(j));
              }
              action_names.push(action_branch_names);
            }     
          }
        }
        else{
          if(action[0].length == 1 && Array.isArray(action_names[0])){ // If action space is discrete and action_names is multi_discrete
            action_names = action_names[0]; // Set action_names to the first branch of the action space
          }
        }

        // Modify dropdown menu
        if(is_discrete){ // if action space is discrete
          document.getElementById("all").outerHTML=""; // remove dropdown option 'all'
        }
        else { // If action space is multi_discrete
          // Create dropdown menu for the entropy function
          var dropdown_content = document.getElementById("dropdown_content"); 
          for(var i = 0; i < action[0].length; i++){
            var entropy_dropdown_option = document.createElement("a");
            entropy_dropdown_option.innerHTML = "action_space_" + String(i);
            entropy_dropdown_option.setAttribute("href", "#");
            entropy_dropdown_option.setAttribute("onclick", "set_action_space(" + String(i) + ")");
            dropdown_content.appendChild(entropy_dropdown_option);
          }
        }

        window.addEventListener('load', () => {
          // Set video length to length - 0.9999 because the last frame is two seconds long
          video_length = video_player.duration - 0.9999;
          time_selector.setAttribute('max', video_length); // Set max value of time selector to video length

          video_player.addEventListener('timeupdate', timeListener); // Update time selector and plots when video is playing
          video_player.addEventListener('dblclick', function(e) {open_fullscreen(video_player);}); // Open video in fullscreen when video is double clicked
          video_player.playbackRate = 6; // Set video playback rate to frame rate
          reset(); // Reset video to start
        }, false);
      
      // Update video time if time selector is changed
      time_selector.addEventListener('input', () => {
          video_player.currentTime = time_selector.value
          pause();
          update();
      })

      // Add event manager for tab
      window.addEventListener('keydown', function(event) {
          if (event.key === 'Tab') {
              if (statistic_type == "transformer") {
                statistic_plot_id = (statistic_plot_id + 1) % 3;
                // Set action plot if statistic_plot_id is 0
                if(statistic_plot_id == 0){
                  // Update action plot
                  if(is_discrete) { // If action_space is discrete
                    set_bar_action_plot(y_action[step][0], action[step][0], action_names);
                  }
                  else { // If action_space is multi discrete
                      set_stacked_bar_action_plot(y_action[step], action[step], action_names);
                  }
                }
                // Set value plot if statistic_plot_id is 1
                if (statistic_plot_id == 1) {
                  set_scatter_line_plot('action_distr', "Value Function", y_values_plot, step, value_marker);
                }

              // Set entropy plot if statistic_plot_id is 2
              if (statistic_plot_id == 2) {
                  if(is_discrete) { // If action_space is discrete
                      set_scatter_line_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
                  else { // If action_space is multi discrete
                      set_scatter_lines_plot('action_distr', "Entropy Function", y_entropy_plot, step, entropy_marker);
                  }
              }
          }
      }
    });

    // Show ground truth if checkbox is checked
    function show_ground_truth() {
        // Get the checkbox element by its ID
        var checkbox = document.getElementById("show_ground_truth");
        
        // Check if the checkbox is checked
        if (checkbox.checked) { // Show the ground truth
          if (video_id == render_id) video_id = render_gt_id;
          if (video_id == render_decoder_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else {
          if (video_id == render_gt_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_agent_id;
          set_video(video_path[video_id]);
        }
      }

    // Show decoder video if checkbox is checked
    function show_decoder_video() {
      var checkbox = document.getElementById("show_decoder_video");
      document.getElementById("show_agent_video").checked = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_decoder_id;
          if (video_id == render_gt_id) video_id = render_decoder_gt_id;
          if (video_id == render_agent_id) video_id = render_decoder_id;
          if (video_id == render_agent_gt_id) video_id = render_decoder_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide decoder video
          if (video_id == render_decoder_id) video_id = render_id;
          if (video_id == render_decoder_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Show agent video if checkbox is checked
    function show_agent_video() {
      var checkbox = document.getElementById("show_agent_video");
      document.getElementById("show_decoder_video").checked  = false;

      if (checkbox.checked) { 
          if (video_id == render_id) video_id = render_agent_id;
          if (video_id == render_gt_id) video_id = render_agent_gt_id;
          if (video_id == render_decoder_id) video_id = render_agent_id;
          if (video_id == render_decoder_gt_id) video_id = render_agent_gt_id;
          set_video(video_path[video_id]);
        } else { // Hide agent video
          if (video_id == render_agent_id) video_id = render_id;
          if (video_id == render_agent_gt_id) video_id = render_gt_id;
          set_video(video_path[video_id]);
        }
    }

    // Set the video to the given path
    function set_video(path) {
        // Get video data to make the switch seamless
        var current_time = video_player.currentTime;
        var play_back_rate = video_player.playbackRate;
        var is_paused = video_player.paused;
        video_player.querySelector("source").src = path;
        // Reload video
        video_player.load();
        video_player.currentTime = current_time;
        video_player.playbackRate = play_back_rate;
        if(is_paused) pause();
        else play();
    }


      /**
      * Update time selector and plots when video is playing
      */
      function timeListener() {
        if(!video_player.paused) {
          update();
        } 
      }

      /**
      * Toggles button and video between playing and paused
      */
      function play_pause() {
        if(video_player.paused)
          play();
        else 
          pause();
      }

      /**
       * Returns to the previous frame step
       */
       function return_to_step() {
        video_player.currentTime = past_steps.pop();
        pause();
        update();
        gotostep_text.value = step;
        return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Updates the plots and time selector
       */
       function go_to_step(event) {
        if (event.keyCode === 13) {
          past_steps.push(step);
          video_player.currentTime = Number(gotostep_text.value);
          pause();
          update();
          gotostep_text.value = step;
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
        }
      }

      function set_video_speed(event) {
        if (event.keyCode === 13) {
          video_player.playbackRate = Number(video_speed.value);
        }
      }

      /**
       * Updates the plots and time selector
       */
       function top_scores() {
        if (event.keyCode === 13) update()
      }

      /**
      * Pauses video
      */
      function pause() {
          play_pause_button.innerHTML = "Play";
          video_player.pause();
      }

      /**
      * Plays the video
      */
      function play() {
          play_pause_button.innerHTML = "Pause";
          video_player.play();
      }

      /**
      * Resets the video and plots to the start
      */
      function reset() {
          video_player.currentTime = 0;
          past_steps.push(step);
          pause();
          update();
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the previous frame
      */
      function back() {
          video_player.currentTime = video_player.currentTime - tS_step_size
          pause();
          update();
          past_steps.push(step + 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
      * Goes to the next frame
      */
      function next() {
          video_player.currentTime = video_player.currentTime + tS_step_size;
          pause();
          update();
          past_steps.push(step - 1);
          return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
      }

      /**
       * Switches between general and transformer statistics
       */
       function statistic() {
        if (stats_button.innerHTML == "General") {
          statistic_type = "general";
          stats_button.innerHTML = "Transformer";
        }
        else if (stats_button.innerHTML == "Attention Scores") {
          statistic_type = "transformer";
          stats_button.innerHTML = "General";
        }
        update();
      }
      /**
      * Opens the video in fullscreen
      */
      function open_fullscreen(vid_elem) {
          if (vid_elem.requestFullscreen) {
              vid_elem.requestFullscreen();
          } else if (vid_elem.webkitRequestFullscreen) { /* Safari */
              vid_elem.webkitRequestFullscreen();
          } else if (vid_elem.msRequestFullscreen) { /* IE11 */
              vid_elem.msRequestFullscreen();
          }
          vid_elem.pause();
      }

      // Selects the action space for the entropy plot
      function set_action_space(spaces){
        if (spaces == 'all')
          entr_selected_action_space = null;
        else
          entr_selected_action_space = Number(spaces);
        update();
      }

      function marker(marker_id){
        if(marker_id == "entropy")
          entropy_marker = !entropy_marker;
        else if(marker_id == "value")
          value_marker = !value_marker;
        update();
      }

      /**
      * Updates the plots and time selector
      */
      function update()  {
        if(video_player.currentTime == Math.round(video_player.currentTime)) // If time t of video is a natural number then step is t - 1
              video_player.currentTime += 0.0001 // Add a small number to make sure that the step and the current time are the same
        if(video_player.currentTime > video_length) {
           video_player.currentTime = video_length;
           pause();
        } // Video can't go past the end
        time_selector.value = video_player.currentTime; // Update time selector
        step = Math.floor(video_player.currentTime); // Get step of video for plots

        // Update plots
        if (statistic_type == "general")
          render_general_statistics();
        else if (statistic_type == "transformer")
          render_transformer_statistics();

        if(statistic_type == "general") {
          // Reset plot id
          statistic_plot_id = 0;
          // Update action plot
          if(is_discrete) { // If action_space is discrete
            set_bar_action_plot(y_action[step][0], action[step][0], action_names);
          }
          else { // If action_space is multi discrete
              set_stacked_bar_action_plot(y_action[step], action[step], action_names);
          }
        }
      }

      /**
      * Renders the general statistics
      */
      function render_general_statistics() {
        // Disables the transformer statistics and enables the general statistics
          document.getElementById('transformer').style.display = 'none';
          document.getElementById('top_n_scores').style.display = 'none';
          document.querySelector('label[for="top_n_scores"]').style.display = 'none';
          document.getElementById('value_func').style.display = 'block';
          document.getElementById('entropy_func').style.display = 'block';
          document.getElementById('options').style.display = 'block';
        // Updates the plots
          set_scatter_line_plot('value_func', "Value Function", y_values_plot, step, value_marker);
          if(is_discrete) { // If action_space is discrete
              set_scatter_line_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
          else { // If action_space is multi discrete
              set_scatter_lines_plot('entropy_func', "Entropy Function", y_entropy_plot, step, entropy_marker);
          }
        }
      
      /*
      * Renders the transformer statistics
      */
      function render_transformer_statistics() {
        // Disables the general statistics and enables the transformer statistics
        document.getElementById('transformer').style.display = 'block';
        document.getElementById('top_n_scores').style.display = 'block';
        document.querySelector('label[for="top_n_scores"]').style.display = 'block';
        document.getElementById('value_func').style.display = 'none';
        document.getElementById('entropy_func').style.display = 'none';
        document.getElementById('options').style.display = 'none';
        // Updates the plots
        var top_n = Number(top_n_scores.value);
        if (top_n == -1) top_n = step;
        visualizeAttentionScores(y_attention_weights[step], top_n);
        }


      /**
       * Renders attention scores
      */
      async function visualizeAttentionScores(attentionScores, n_values) {
        const numHeads = attentionScores.length;
        
        let data = [];
        let layout = {
          grid: {
              rows: numHeads, 
              columns: 1, 
              pattern: 'independent',
              subplots: [...Array(numHeads).keys()].map(i => `xy${i + 1}`),
              ygap: 0.4 // adjust this value according to your preference
          },
          plot_bgcolor: '#000',
          paper_bgcolor: '#000',
          font: {
              family: 'Montserrat',
              size: 12,
              color: '#fff'
          },
          margin: {
              t: 0,  // reduce top margin
          },
      }

        // Flatten the array to find the max value across all arrays
        let flatScores = attentionScores.flat();
        let maxScore = Math.max(...flatScores);

        // Iterate through each attention head
        for (let headIdx = 0; headIdx < numHeads; headIdx++) {
            // Get attention scores for the current head
            let headScores = attentionScores[headIdx];
            
            // This array will keep up to the 10 highest scores
            let topScores = [];

            for (let i = 0; i < headScores.length; i++) {
                // Insert current score into the top scores array
                topScores.push({score: headScores[i], index: i});
                
                // Sort the top scores array
                topScores.sort((a, b) => b.score - a.score);

                // If there are more than 10 scores, remove the smallest
                if (topScores.length > n_values) {
                    topScores.pop();
                }
            }

            // Sort the topScores array by index
            topScores.sort((a, b) => a.index - b.index);

            // Now topScores contains the top 10 scores sorted by their indices.
            // You can extract the scores and their indices into separate arrays:
            let filteredHeadScores = topScores.map(x => x.score);
            let filteredTicks = topScores.map(x => x.index);


            const sequenceLength = filteredHeadScores.length;

            layout.height = 400;
            layout.width = window.innerWidth;

            const headScoresPlot = {
                z: [filteredHeadScores],
                type: 'heatmap',
                showscale: true,  
                colorscale: 'Hot',
                zmin: 0,
                zmax: maxScore,
                xaxis: `x${headIdx + 1}`,
                yaxis: `y${headIdx + 1}`,
            };

            data.push(headScoresPlot);

            layout[`xaxis${headIdx + 1}`] = {
                tickmode: 'array',
                tickvals: Array.from({length: sequenceLength}, (_, i) => i),
                ticktext: filteredTicks
            };

            layout[`yaxis${headIdx + 1}`] = {
                title: `Block ${headIdx + 1}`,
                ticks: 'outside',
                tick0: 0,
                dtick: 1,
                ticklen: 8,
                tickwidth: 4,
                tickcolor: '#000'
            };
        }

        const config = {responsive: true};

        Plotly.newPlot('transformer', data, layout, config).then(function() {
          var myPlot = document.getElementById('transformer');
          myPlot.on('plotly_click', function(data){
            // Jump to the step that was clicked
              past_steps.push(step);
              video_player.currentTime = Number(data.points[0].xaxis.ticktext[data.points[0].x]);
              pause();
              update();
              return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      });
    }

      /** 
      * Sets a stacked bar plot for the multi discrete action distribution
      * @param {array} y_values - The action distribution
      * @param {array} action - The action
      * @param {array} action_names - The names of the actions
      */
      function set_stacked_bar_action_plot(y_values, action, action_names) {
        var bar_plot_data_action = [];
        // Set data for each action
        for(var j = 0; j < action_names[0].length; j++) {
            var color = ""
            for(var i = 0; i < action_names.length; i++) {
                if(action[i] == j) // If action sampled in the current frame
                    color = '#FF0000'; // Color it red
                else
                    color = '#FAEBD7'; // Color it white
                var trace = {
                    x: [["action_space_", String(i)].join("")],
                    y: [y_values[i][j]],
                    text: [y_values[i][j], action_names[i][j]].map(String).join("<br>"), // Add action name and prob to the bar
                    marker: {
                        color: color,
                        line: {
                            color: '#000000',
                            width: 1
                          }
                    },
                    type: 'bar'
                };
                bar_plot_data_action.push(trace);
            }
        }

        // Set layout for the plot
        var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            barmode: 'stack',
            showlegend: false
      };

      // Plot the data
      Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }

      /**
      * Sets a bar plot for the discrete action distribution
      */
      function set_bar_action_plot(y_values, action, action_names) {

          var color_value = new Array(y_values.length).fill('#FAEBD7'); // Set color for all actions to white
          color_value[action] = '#FF0000'; // Except the selected action should be red
          // Set data for the plot
          var bar_plot_data_action = [
              {
                  x: action_names,
                  y: y_values,
                  type: 'bar',
                  marker: {
                      color: color_value
                  },
                  textposition: 'auto',
                  text: y_values.map(String), // Add prob to the bar plot
                  textfont: {
                      family: 'Montserrat',
                      size: 12,
                  },
                  textangle: 0,
                  textposition: 'bottom center',
              }
          ];

          // Set layout for the plot
          var bar_plot_layout_action = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 28,
                r: 0,
                b: 30,
                t: 22,
                pad: 4
              },
            yaxis: {
              automargin: true,
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: 'Action Distribution',
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            }
      };
          
          // Plot the action distribution
          Plotly.newPlot('action_distr', bar_plot_data_action, bar_plot_layout_action);
      }


      /**
      * Sets a scatter plot for the emtropy function if multi discrete actions are used
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The entropy function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_lines_plot(id, title, y_values, step, marker) {
        line_scatter_plot_data_value = [];

        // Set colors and data for the plot
        var colors = ['#FAEBD780', '#7CFC0080', '#FFBF0080', '#FF7F5080', '#DE316380', '#9FE2BF80', '#40E0D080', '#6495ED80', '#CCCCFF80']
        for(var i = 0; i < y_values.length; i++) {
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values[i].slice(0, step + 1);
            var trace = [
            {
                x: x_values_marker,
                y: y_values_marker,
                mode: 'line',
                line: {
                    color: colors[i]
                },
                name: 'action_space_' + String(i),
                showlegend: true,
            },
            {
                x: x_values,
                y: y_values[i],
                mode: 'markers',
                name: 'action_space_' + String(i) + "_marker",
                marker: {
                    color: colors[i]
                },
                showlegend: true,
            }
        ];
            // Add data to the plot
            line_scatter_plot_data_value.push(trace[0]);
            if(marker)
              line_scatter_plot_data_value.push(trace[1]); 
        }

        // Select the selected action_space for the entropy plot
        if(entr_selected_action_space != null && marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space * 2], line_scatter_plot_data_value[entr_selected_action_space * 2 + 1]];
        else if(entr_selected_action_space != null && !marker)
          line_scatter_plot_data_value = [line_scatter_plot_data_value[entr_selected_action_space]];

        // Set layout for the plot
        var line__scatter_plot_layout_value = {
            autosize: true,
            width: 600,
            height: 360,
            margin: {
                l: 50,
                r: 0,
                b: 30,
                t: 25,
                pad: 4
                },
            yaxis: {
                automargin: true
            },
            plot_bgcolor: '#000',
            paper_bgcolor: '#000',
            font: {
                family: 'Montserrat',
                size: 12,
                color: '#fff'
            },
            title: {
                text: title,
                font: {
                    family: 'Montserrat',
                    size: 15,
                    color: '#fff'
                }
            },
            showlegend: true,
        };

        // Plot the data
        Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);
        // Add event handler for clicking on a marker
        document.getElementById(id).on('plotly_click', function(data){
            past_steps.push(step);
            video_player.currentTime = Number(data.points[0].x);
            pause();
            update();
            return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      }


      /**
      * Sets a scatter plot for the value function
      * @param {string} id - The id of the plot
      * @param {string} title - The title of the plot
      * @param {array} y_values - The value function y values
      * @param {int} step - The step of the video
      * @param {boolean} marker - If the marker should be shown
      */
      function set_scatter_line_plot(id, title, y_values, step, marker) {
          // Set data for layout for the plot
          var line__scatter_plot_layout_value = {
              autosize: true,
              width: 600,
              height: 360,
              margin: {
                  l: 50,
                  r: 0,
                  b: 30,
                  t: 25,
                  pad: 4
                  },
              yaxis: {
                  automargin: true
              },
              plot_bgcolor: '#000',
              paper_bgcolor: '#000',
              font: {
                  family: 'Montserrat',
                  size: 12,
                  color: '#fff'
              },
              title: {
                  text: title,
                  font: {
                      family: 'Montserrat',
                      size: 15,
                      color: '#fff'
                  }
              },
              showlegend: false,
          };

          // Set data for the plot
          var x_values_marker = x_values.slice(0, step + 1);
          var y_values_marker = y_values.slice(0, step + 1);

          var line_scatter_plot_data_value = [
              {
                  x: x_values_marker,
                  y: y_values_marker,
                  mode: 'line',
                  line: {
                      color: '#FAEBD7'
                  },
                  name: 'function',
              },
              {
                  x: x_values,
                  y: y_values,
                  mode: 'markers',
                  marker: {
                      color: '#7CFC0080'
                  },
                  name: 'marker',
              }
          ];

          if(!marker)
            line_scatter_plot_data_value = [line_scatter_plot_data_value[0]];

          // Plot the value function
          Plotly.newPlot(id, line_scatter_plot_data_value, line__scatter_plot_layout_value);

          // Add event handler for clicking on a marker
          document.getElementById(id).on('plotly_click', function(data){
            past_steps.push(step);
            video_player.currentTime = Number(data.points[0].x);
            pause();
            update();
            return_button.innerHTML = "Return to step " + past_steps[past_steps.length - 1]; 
          });
      }
    
    /**
    * Opens the specific tab based on the probided id
    * @param {string} id - The id of the tab
    */
    function openTab(evt, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        mediatabcontent = document.getElementsByClassName("mediatabcontent");
        // Hide all elements with class="tabcontent" and "mediacontent" by default
        for (i = 0; i < mediatabcontent.length; i++) {
            mediatabcontent[i].style.display = "none";
        }
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        // Show the specific tab content
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(id).style.display = "block";
        evt.currentTarget.className += " active";
      }
    </script>
  </body>
</html>